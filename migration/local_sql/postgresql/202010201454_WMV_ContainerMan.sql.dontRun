-- migration script for customization WMV_ContainerMan
--
-- create function wmv_textblock
--
CREATE OR REPLACE FUNCTION adempiere.wmv_textblock(tbname character varying, flag character DEFAULT 'Y'::bpchar, flagisinverted boolean DEFAULT false)
 RETURNS character varying
 LANGUAGE plpgsql
AS $function$
    BEGIN
        if flagIsInverted then
            case flag
            when 'Y' then
                flag := 'N';
            when 'N' then
                flag = 'Y';
            else 
                raise notice using message = 'flagisinverted should be either true or false.'; 
            end case;
        end if;
        if flag = 'N' then
            return null;
        else
            return (select textblock from adempiere.wmv_textblocks tb where tbName = tb.name);
        end if;
    END;
$function$
;
--
-- create view  wmv_inout_line_vt
--
CREATE OR REPLACE VIEW wmv_inout_line_vt AS
 SELECT iol.ad_client_id,
    iol.ad_org_id,
    iol.isactive,
    iol.created,
    iol.createdby,
    iol.updated,
    iol.updatedby,
    uomt.ad_language,
    iol.m_inout_id,
    iol.m_inoutline_id,
    iol.line,
    pt.m_product_id,
        CASE
            WHEN ((iol.movementqty <> (0)::numeric) OR (iol.m_product_id IS NOT NULL)) THEN iol.movementqty
            ELSE NULL::numeric
        END AS movementqty,
        CASE
            WHEN ((iol.qtyentered <> (0)::numeric) OR (iol.m_product_id IS NOT NULL)) THEN iol.qtyentered
            ELSE NULL::numeric
        END AS qtyentered,
        CASE
            WHEN ((iol.movementqty <> (0)::numeric) OR (iol.m_product_id IS NOT NULL)) THEN uomt.uomsymbol
            ELSE NULL::character varying
        END AS uomsymbol,
    ol.qtyordered,
    ol.qtydelivered,
        CASE
            WHEN ((iol.movementqty <> (0)::numeric) OR (iol.m_product_id IS NOT NULL)) THEN (ol.qtyordered - ol.qtydelivered)
            ELSE NULL::numeric
        END AS qtybackordered,
    COALESCE(((pt.name)::text || (productattribute(iol.m_attributesetinstance_id))::text), (ct.name)::text, (iol.description)::text) AS name,
        CASE
            WHEN (COALESCE(ct.name, pt.name) IS NOT NULL) THEN iol.description
            ELSE NULL::character varying
        END AS description,
    pt.documentnote,
    p.upc,
    p.sku,
    p.value AS productvalue,
    iol.m_locator_id,
    l.m_warehouse_id,
    l.x,
    l.y,
    l.z,
    iol.m_attributesetinstance_id,
    asi.m_attributeset_id,
    asi.serno,
    asi.lot,
    asi.m_lot_id,
    asi.guaranteedate,
    pt.description AS productdescription,
    p.imageurl,
    iol.c_campaign_id,
    iol.c_project_id,
    iol.c_activity_id,
    iol.c_projectphase_id,
    iol.c_projecttask_id,
    iol.ad_orgtrx_id,
    iol.c_charge_id,
    iol.confirmedqty,
    iol.c_orderline_id,
    iol.c_uom_id AS m_inoutline_c_uom_id,
    iol.isdescription AS m_inoutline_isdescription,
    iol.isinvoiced,
    iol.m_rmaline_id,
    iol.pickedqty,
    iol.processed AS m_inoutline_processed,
    iol.ref_inoutline_id,
    iol.reversalline_id,
    iol.scrappedqty,
    iol.targetqty,
    iol.user1_id AS m_inoutline_user1_id,
    iol.user2_id AS m_inoutline_user2_id,
    pt.ad_org_id AS m_product_ad_org_id,
    p.classification,
    p.copyfrom AS m_product_copyfrom,
    pt.created AS m_product_created,
    pt.createdby AS m_product_createdby,
    p.c_revenuerecognition_id,
    p.c_subscriptiontype_id,
    p.c_taxcategory_id AS m_product_c_taxcategory_id,
    p.c_uom_id AS m_product_c_uom_id,
    p.descriptionurl,
    p.discontinued,
    p.discontinuedat,
    p.group1,
    p.group2,
    p.guaranteedays,
    p.guaranteedaysmin,
    p.help,
    pt.isactive AS m_product_isactive,
    p.isbom,
    p.isdropship,
    p.isexcludeautodelivery,
    p.isinvoiceprintdetails,
    p.ispicklistprintdetails,
    p.ispurchased,
    p.isselfservice AS m_product_isselfservice,
    p.issold,
    p.isstocked,
    p.issummary AS m_product_issummary,
    p.isverified,
    p.iswebstorefeatured,
    p.lowlevel,
    p.m_attributeset_id AS m_product_m_attributeset_id,
    p.m_attributesetinstance_id AS m_product_m_asi_id,
    p.m_freightcategory_id,
    p.m_locator_id AS m_product_m_locator_id,
    p.m_product_category_id AS m_product_m_prod_category_id,
    p.processing AS m_product_processing,
    p.producttype,
    p.r_mailtext_id,
    p.salesrep_id AS m_product_salesrep_id,
    p.s_expensetype_id,
    p.shelfdepth,
    p.shelfheight,
    p.shelfwidth,
    p.s_resource_id AS m_product_s_resource_id,
    p.unitsperpack,
    p.unitsperpallet,
    p.updated AS m_product_updated,
    p.updatedby AS m_product_updatedby,
    p.versionno,
    p.volume,
    p.weight,
    uomt.ad_org_id AS c_uom_ad_org_id,
    uom.costingprecision,
    uomt.description AS c_uom_description,
    uomt.isactive AS c_uom_isactive,
    uom.isdefault AS c_uom_isdefault,
    uomt.name AS c_uom_name,
    uom.stdprecision,
    uom.uomtype,
    uom.x12de355,
    asi.ad_org_id AS m_asi_ad_org_id,
    asi.created AS m_asi_created,
    asi.createdby AS m_asi_createdby,
    asi.description AS m_asi_description,
    asi.isactive AS m_asi_isactive,
    asi.updated AS m_asi_updated,
    asi.updatedby AS m_asi_updatedby,
    l.ad_org_id AS m_locator_ad_org_id,
    l.isactive AS m_locator_isactive,
    l.isdefault,
    l.priorityno,
    l.value AS m_locator_value,
    ol.ad_org_id AS c_orderline_ad_org_id,
    ol.ad_orgtrx_id AS c_orderline_ad_orgtrx_id,
    ol.c_activity_id AS c_orderline_c_activity_id,
    ol.c_bpartner_id AS c_orderline_c_bpartner_id,
    ol.c_bpartner_location_id AS c_orderline_c_bp_location_id,
    ol.c_charge_id AS c_orderline_c_charge_id,
    ol.c_currency_id AS c_orderline_c_currency_id,
    ol.c_order_id,
    ol.c_project_id AS c_orderline_c_project_id,
    ol.c_projectphase_id AS c_orderline_c_projectphase_id,
    ol.c_projecttask_id AS c_orderline_c_projecttask_id,
    ol.created AS c_orderline_created,
    ol.createdby AS c_orderline_createdby,
    ol.c_tax_id AS c_orderline_c_tax_id,
    ol.c_uom_id AS c_orderline_c_uom_id,
    ol.datedelivered,
    ol.dateinvoiced,
    ol.dateordered,
    ol.datepromised AS c_orderline_datepromised,
    ol.description AS c_orderline_description,
    ol.discount,
    ol.freightamt AS c_orderline_freightamt,
    ol.isactive AS c_orderline_isactive,
    ol.isdescription AS c_orderline_isdescription,
    ol.line AS c_orderline_line,
    ol.linenetamt,
    ol.link_orderline_id,
    ol.m_attributesetinstance_id AS c_orderline_m_asi_id,
    ol.m_product_id AS c_orderline_m_product_id,
    ol.m_promotion_id,
    ol.m_shipper_id AS c_orderline_m_shipper_id,
    ol.m_warehouse_id AS c_orderline_warehouse_id,
    ol.priceactual,
    ol.pricecost,
    ol.priceentered,
    ol.pricelimit,
    ol.pricelist,
    ol.processed AS c_orderline_processed,
    ol.qtyentered AS c_orderline_qtyentered,
    ol.qtyinvoiced,
    ol.qtylostsales,
    ol.qtyreserved,
    ol.ref_orderline_id,
    ol.rramt,
    ol.rrstartdate,
    ol.s_resourceassignment_id,
    ol.updated AS c_orderline_updated,
    ol.updatedby AS c_orderline_updatedby,
    ol.user1_id AS c_orderline_user1_id,
    ol.user2_id AS c_orderline_user2_id,
    ct.ad_org_id AS c_charge_c_org_id,
    c.c_bpartner_id AS c_charge_c_bpartner_id,
    c.c_chargetype_id,
    c.chargeamt AS c_charge_chargeamt,
    c.c_taxcategory_id AS c_charge_c_taxcategory_id,
    ct.description AS c_charge_description,
    ct.isactive AS c_charge_isactive,
    c.issamecurrency,
    c.issametax,
    c.istaxincluded AS c_charge_istaxincluded
   FROM (((((((((m_inoutline iol
     JOIN c_uom uom ON ((iol.c_uom_id = uom.c_uom_id)))
     JOIN c_uom_trl uomt ON ((iol.c_uom_id = uomt.c_uom_id)))
     LEFT JOIN m_product p ON ((iol.m_product_id = p.m_product_id)))
     LEFT JOIN m_product_trl pt ON (((iol.m_product_id = pt.m_product_id) AND ((uomt.ad_language)::text = (pt.ad_language)::text))))
     LEFT JOIN m_attributesetinstance asi ON ((iol.m_attributesetinstance_id = asi.m_attributesetinstance_id)))
     LEFT JOIN m_locator l ON ((iol.m_locator_id = l.m_locator_id)))
     LEFT JOIN c_orderline ol ON ((iol.c_orderline_id = ol.c_orderline_id)))
     LEFT JOIN c_charge c ON ((iol.c_charge_id = c.c_charge_id)))
     LEFT JOIN c_charge_trl ct ON (((iol.c_charge_id = ct.c_charge_id) AND ((uomt.ad_language)::text = (ct.ad_language)::text))))
UNION
 SELECT iol.ad_client_id,
    iol.ad_org_id,
    iol.isactive,
    iol.created,
    iol.createdby,
    iol.updated,
    iol.updatedby,
    uomt.ad_language,
    iol.m_inout_id,
    iol.m_inoutline_id,
    (iol.line + (bl.line / (100)::numeric)) AS line,
    pt.m_product_id,
        CASE
            WHEN (bl.isqtypercentage = 'N'::bpchar) THEN (iol.movementqty * bl.qtybom)
            ELSE (iol.movementqty * (bl.qtybatch / (100)::numeric))
        END AS movementqty,
        CASE
            WHEN (bl.isqtypercentage = 'N'::bpchar) THEN (iol.qtyentered * bl.qtybom)
            ELSE (iol.qtyentered * (bl.qtybatch / (100)::numeric))
        END AS qtyentered,
    uomt.uomsymbol,
    NULL::numeric AS qtyordered,
    NULL::numeric AS qtydelivered,
    NULL::numeric AS qtybackordered,
    pt.name,
    b.description,
    pt.documentnote,
    p.upc,
    p.sku,
    p.value AS productvalue,
    iol.m_locator_id,
    l.m_warehouse_id,
    l.x,
    l.y,
    l.z,
    iol.m_attributesetinstance_id,
    asi.m_attributeset_id,
    asi.serno,
    asi.lot,
    asi.m_lot_id,
    asi.guaranteedate,
    pt.description AS productdescription,
    p.imageurl,
    iol.c_campaign_id,
    iol.c_project_id,
    iol.c_activity_id,
    iol.c_projectphase_id,
    iol.c_projecttask_id,
    iol.ad_orgtrx_id,
    iol.c_charge_id,
    iol.confirmedqty,
    iol.c_orderline_id,
    iol.c_uom_id AS m_inoutline_c_uom_id,
    iol.isdescription AS m_inoutline_isdescription,
    iol.isinvoiced,
    iol.m_rmaline_id,
    iol.pickedqty,
    iol.processed AS m_inoutline_processed,
    iol.ref_inoutline_id,
    iol.reversalline_id,
    iol.scrappedqty,
    iol.targetqty,
    iol.user1_id AS m_inoutline_user1_id,
    iol.user2_id AS m_inoutline_user2_id,
    pt.ad_org_id AS m_product_ad_org_id,
    p.classification,
    p.copyfrom AS m_product_copyfrom,
    pt.created AS m_product_created,
    pt.createdby AS m_product_createdby,
    p.c_revenuerecognition_id,
    p.c_subscriptiontype_id,
    p.c_taxcategory_id AS m_product_c_taxcategory_id,
    p.c_uom_id AS m_product_c_uom_id,
    p.descriptionurl,
    p.discontinued,
    p.discontinuedat,
    p.group1,
    p.group2,
    p.guaranteedays,
    p.guaranteedaysmin,
    p.help,
    pt.isactive AS m_product_isactive,
    p.isbom,
    p.isdropship,
    p.isexcludeautodelivery,
    p.isinvoiceprintdetails,
    p.ispicklistprintdetails,
    p.ispurchased,
    p.isselfservice AS m_product_isselfservice,
    p.issold,
    p.isstocked,
    p.issummary AS m_product_issummary,
    p.isverified,
    p.iswebstorefeatured,
    p.lowlevel,
    p.m_attributeset_id AS m_product_m_attributeset_id,
    p.m_attributesetinstance_id AS m_product_m_asi_id,
    p.m_freightcategory_id,
    p.m_locator_id AS m_product_m_locator_id,
    p.m_product_category_id AS m_product_m_prod_category_id,
    p.processing AS m_product_processing,
    p.producttype,
    p.r_mailtext_id,
    p.salesrep_id AS m_product_salesrep_id,
    p.s_expensetype_id,
    p.shelfdepth,
    p.shelfheight,
    p.shelfwidth,
    p.s_resource_id AS m_product_s_resource_id,
    p.unitsperpack,
    p.unitsperpallet,
    pt.updated AS m_product_updated,
    pt.updatedby AS m_product_updatedby,
    p.versionno,
    p.volume,
    p.weight,
    uomt.ad_org_id AS c_uom_ad_org_id,
    uom.costingprecision,
    uomt.description AS c_uom_description,
    uomt.isactive AS c_uom_isactive,
    uom.isdefault AS c_uom_isdefault,
    uomt.name AS c_uom_name,
    uom.stdprecision,
    uom.uomtype,
    uom.x12de355,
    asi.ad_org_id AS m_asi_ad_org_id,
    asi.created AS m_asi_created,
    asi.createdby AS m_asi_createdby,
    asi.description AS m_asi_description,
    asi.isactive AS m_asi_isactive,
    asi.updated AS m_asi_updated,
    asi.updatedby AS m_asi_updatedby,
    l.ad_org_id AS m_locator_ad_org_id,
    l.isactive AS m_locator_isactive,
    l.isdefault,
    l.priorityno,
    l.value AS m_locator_value,
    NULL::numeric AS c_orderline_ad_org_id,
    NULL::numeric AS c_orderline_ad_orgtrx_id,
    NULL::numeric AS c_orderline_c_activity_id,
    NULL::numeric AS c_orderline_c_bpartner_id,
    NULL::numeric AS c_orderline_c_bp_location_id,
    NULL::numeric AS c_orderline_c_charge_id,
    NULL::numeric AS c_orderline_c_currency_id,
    NULL::numeric AS c_order_id,
    NULL::numeric AS c_orderline_c_project_id,
    NULL::numeric AS c_orderline_c_projectphase_id,
    NULL::numeric AS c_orderline_c_projecttask_id,
    NULL::timestamp without time zone AS c_orderline_created,
    NULL::numeric AS c_orderline_createdby,
    NULL::numeric AS c_orderline_c_tax_id,
    NULL::numeric AS c_orderline_c_uom_id,
    NULL::timestamp without time zone AS datedelivered,
    NULL::timestamp without time zone AS dateinvoiced,
    NULL::timestamp without time zone AS dateordered,
    NULL::timestamp without time zone AS c_orderline_datepromised,
    NULL::character varying AS c_orderline_description,
    NULL::numeric AS discount,
    NULL::numeric AS c_orderline_freightamt,
    NULL::bpchar AS c_orderline_isactive,
    NULL::bpchar AS c_orderline_isdescription,
    NULL::numeric AS c_orderline_line,
    NULL::numeric AS linenetamt,
    NULL::numeric AS link_orderline_id,
    NULL::numeric AS c_orderline_m_asi_id,
    NULL::numeric AS c_orderline_m_product_id,
    NULL::numeric AS m_promotion_id,
    NULL::numeric AS c_orderline_m_shipper_id,
    NULL::numeric AS c_orderline_warehouse_id,
    NULL::numeric AS priceactual,
    NULL::numeric AS pricecost,
    NULL::numeric AS priceentered,
    NULL::numeric AS pricelimit,
    NULL::numeric AS pricelist,
    NULL::bpchar AS c_orderline_processed,
    NULL::numeric AS c_orderline_qtyentered,
    NULL::numeric AS qtyinvoiced,
    NULL::numeric AS qtylostsales,
    NULL::numeric AS qtyreserved,
    NULL::numeric AS ref_orderline_id,
    NULL::numeric AS rramt,
    NULL::timestamp without time zone AS rrstartdate,
    NULL::numeric AS s_resourceassignment_id,
    NULL::timestamp without time zone AS c_orderline_updated,
    NULL::numeric AS c_orderline_updatedby,
    NULL::numeric AS c_orderline_user1_id,
    NULL::numeric AS c_orderline_user2_id,
    NULL::numeric AS c_charge_c_org_id,
    NULL::numeric AS c_charge_c_bpartner_id,
    NULL::numeric AS c_chargetype_id,
    NULL::numeric AS c_charge_chargeamt,
    NULL::numeric AS c_charge_c_taxcategory_id,
    NULL::character varying AS c_charge_description,
    NULL::bpchar AS c_charge_isactive,
    NULL::bpchar AS issamecurrency,
    NULL::bpchar AS issametax,
    NULL::bpchar AS c_charge_istaxincluded
   FROM (((((((((pp_product_bom b
     JOIN m_inoutline iol ON ((b.m_product_id = iol.m_product_id)))
     JOIN m_product bp ON (((bp.m_product_id = iol.m_product_id) AND (bp.isbom = 'Y'::bpchar) AND (bp.isverified = 'Y'::bpchar) AND (bp.ispicklistprintdetails = 'Y'::bpchar))))
     JOIN pp_product_bomline bl ON ((bl.pp_product_bom_id = b.pp_product_bom_id)))
     JOIN m_product p ON ((bl.m_product_id = p.m_product_id)))
     JOIN c_uom uom ON ((iol.c_uom_id = uom.c_uom_id)))
     JOIN c_uom_trl uomt ON ((p.c_uom_id = uomt.c_uom_id)))
     JOIN m_product_trl pt ON (((bl.m_product_id = pt.m_product_id) AND ((uomt.ad_language)::text = (pt.ad_language)::text))))
     LEFT JOIN m_attributesetinstance asi ON ((iol.m_attributesetinstance_id = asi.m_attributesetinstance_id)))
     LEFT JOIN m_locator l ON ((iol.m_locator_id = l.m_locator_id)));
--
-- create view  wmv_order_header_v
--
CREATE OR REPLACE VIEW wmv_order_header_v AS
 SELECT o.incoterm,
    o.isusingfactoring,
    wmv_textblock('factoring_note'::character varying, o.isusingfactoring) AS factoringtext,
    wmv_textblock('bankverbindung'::character varying, o.isusingfactoring, true) AS bankverbindung,
    wmv_textblock('companyinfo'::character varying) AS companyinfo,
    o.wmv_product_id AS m_product_id,
    lf.name AS lineformat,
    p.description AS productdescription,
    o.ad_client_id,
    o.ad_org_id,
    o.isactive,
    o.created,
    o.createdby,
    o.updated,
    o.updatedby,
    'en_US'::character varying AS ad_language,
    o.c_order_id,
    o.issotrx,
    o.documentno,
    o.docstatus,
    o.c_doctype_id,
    o.c_bpartner_id,
    bp.value AS bpvalue,
    bp.taxid AS bptaxid,
    bp.naics,
    bp.duns,
    oi.c_location_id AS org_location_id,
    org.name AS org_name,
    ol.address1 AS org_address1,
    ol.address2 AS org_address2,
    ol.address3 AS org_address3,
    ol.address4 AS org_address4,
    ol.c_country_id AS org_country_id,
    oc.name AS org_country,
    oc.countrycode AS org_countrycode,
    ol.city AS org_city,
    concat((ol.postal)::text, (ol.postal_add)::text) AS org_postal,
    oi.taxid,
    o.m_warehouse_id,
    wh.c_location_id AS warehouse_location_id,
    dt.printname AS documenttype,
    dt.documentnote AS documenttypenote,
    o.salesrep_id,
    COALESCE(ubp.name, u.name) AS salesrep_name,
    o.dateordered,
    o.datepromised,
    bpg.greeting AS bpgreeting,
    bp.name,
    bp.name2,
    bpcg.greeting AS bpcontactgreeting,
    bpc.title,
    bpc.phone,
    NULLIF((bpc.name)::text, (bp.name)::text) AS contactname,
    bpl.c_location_id,
    concat((l.postal)::text, (l.postal_add)::text) AS postal,
    bp.referenceno,
    o.bill_bpartner_id,
    o.bill_location_id,
    o.bill_user_id,
    bbp.value AS bill_bpvalue,
    bbp.taxid AS bill_bptaxid,
    bbp.name AS bill_name,
    bbp.name2 AS bill_name2,
    bbpc.title AS bill_title,
    bbpc.phone AS bill_phone,
    NULLIF((bbpc.name)::text, (bbp.name)::text) AS bill_contactname,
    bbpl.c_location_id AS bill_c_location_id,
    o.description,
    o.poreference,
    o.c_currency_id,
    pt.name AS paymentterm,
    pt.documentnote AS paymenttermnote,
    o.c_charge_id,
    o.chargeamt,
    o.totallines,
    o.grandtotal,
    o.grandtotal AS amtinwords,
    o.m_pricelist_id,
    o.istaxincluded,
    o.volume,
    o.weight,
    o.c_campaign_id,
    o.c_project_id,
    o.c_activity_id,
    o.m_shipper_id,
    o.deliveryrule,
    o.deliveryviarule,
    o.priorityrule,
    o.invoicerule,
    COALESCE(oi.logo_id, ci.logo_id) AS logo_id,
    o.ad_orgtrx_id,
    o.ad_user_id,
    o.amountrefunded,
    o.amounttendered,
    o.c_bpartner_location_id,
    o.c_cashline_id,
    o.c_cashplanline_id,
    o.c_conversiontype_id,
    o.c_doctypetarget_id,
    o.copyfrom,
    o.c_payment_id,
    o.c_paymentterm_id,
    o.c_pos_id,
    o.dateacct,
    o.dateprinted,
    o.docaction,
    o.dropship_bpartner_id,
    o.dropship_location_id,
    o.dropship_user_id,
    o.freightamt,
    o.freightcostrule,
    o.isapproved,
    o.iscreditapproved,
    o.isdelivered,
    o.isdiscountprinted,
    o.isdropship,
    o.isinvoiced,
    o.ispayschedulevalid,
    o.isprinted,
    o.isselected,
    o.isselfservice,
    o.istransferred,
    o.link_order_id,
    o.m_freightcategory_id,
    o.ordertype,
    o.pay_bpartner_id,
    o.pay_location_id,
    o.paymentrule,
    o.posted,
    o.processed,
    o.processedon,
    o.promotioncode,
    o.ref_order_id,
    o.sendemail,
    o.user1_id,
    o.user2_id,
    wh.ad_org_id AS m_warehouse_ad_org_id,
    wh.description AS m_warehouse_description,
    wh.isactive AS m_warehouse_isactive,
    wh.isdisallownegativeinv,
    wh.isintransit,
    wh.m_warehousesource_id,
    wh.name AS m_warehouse_name,
    wh.replenishmentclass,
    wh.separator,
    wh.value AS m_warehouse_value,
    pt.ad_org_id AS c_paymentterm_ad_org_id,
    pt.afterdelivery,
    pt.description AS c_paymentterm_description,
    pt.discount,
    pt.discount2,
    pt.discountdays,
    pt.discountdays2,
    pt.fixmonthcutoff,
    pt.fixmonthday,
    pt.fixmonthoffset,
    pt.gracedays,
    pt.isactive AS c_paymentterm_isactive,
    pt.isdefault,
    pt.isduefixed,
    pt.isnextbusinessday,
    pt.isvalid,
    pt.netday,
    pt.netdays,
    pt.paymenttermusage,
    pt.value AS m_paymentterm_value,
    bp.acqusitioncost AS bp_acqusitioncost,
    bp.actuallifetimevalue AS bp_actuallifetimevalue,
    bp.ad_language AS bp_ad_language,
    bp.ad_orgbp_id AS bp_ad_orgbp_id,
    bp.ad_org_id AS bp_ad_org_id,
    bp.bpartner_parent_id AS bp_bpartner_parent_id,
    bp.c_bp_group_id AS bp_c_bp_group_id,
    bp.c_dunning_id AS bp_c_dunning_id,
    bp.c_greeting_id AS bp_c_greeting_id,
    bp.c_invoiceschedule_id AS bp_c_invoiceschedule_id,
    bp.c_paymentterm_id AS bp_c_paymentterm_id,
    bp.created AS bp_created,
    bp.createdby AS bp_createdby,
    bp.c_taxgroup_id AS bp_c_taxgroup_id,
    bp.deliveryrule AS bp_deliveryrule,
    bp.deliveryviarule AS bp_deliveryviarule,
    bp.description AS bp_description,
    bp.dunninggrace AS bp_dunninggrace,
    bp.firstsale AS bp_firstsale,
    bp.flatdiscount AS bp_flatdiscount,
    bp.freightcostrule AS bp_freightcostrule,
    bp.invoicerule AS bp_invoicerule,
    bp.isactive AS bp_isactive,
    bp.iscustomer AS bp_iscustomer,
    bp.isdiscountprinted AS bp_isdiscountprinted,
    bp.isemployee AS bp_isemployee,
    bp.ismanufacturer AS bp_ismanufacturer,
    bp.isonetime AS bp_isonetime,
    bp.ispotaxexempt AS bp_ispotaxexempt,
    bp.isprospect AS bp_isprospect,
    bp.issalesrep AS bp_issalesrep,
    bp.issummary AS bp_issummary,
    bp.istaxexempt AS bp_istaxexempt,
    bp.isvendor AS bp_isvendor,
    bp.logo_id AS bp_logo_id,
    bp.m_discountschema_id AS bp_m_discountschema_id,
    bp.m_pricelist_id AS bp_m_pricelist_id,
    bp.numberemployees AS bp_numberemployees,
    bp.paymentrule AS bp_paymentrule,
    bp.paymentrulepo AS bp_paymentrulepo,
    bp.po_discountschema_id AS bp_po_discountschema_id,
    bp.po_paymentterm_id AS bp_po_paymentterm_id,
    bp.po_pricelist_id AS bp_po_pricelist_id,
    bp.poreference AS bp_poreference,
    bp.potentiallifetimevalue AS bp_potentiallifetimevalue,
    bp.rating AS bp_rating,
    bp.salesrep_id AS bp_salesrep_id,
    bp.salesvolume AS bp_salesvolume,
    bp.sendemail AS bp_sendemail,
    bp.shareofcustomer AS bp_shareofcustomer,
    bp.shelflifeminpct AS bp_shelflifeminpct,
    bp.so_creditlimit AS bp_so_creditlimit,
    bp.socreditstatus AS bp_socreditstatus,
    bp.so_creditused AS bp_so_creditused,
    bp.so_description AS bp_so_description,
    bp.totalopenbalance AS bp_totalopenbalance,
    bp.updated AS bp_updated,
    bp.updatedby AS bp_updatedby,
    bp.url AS bp_url,
    bpg.ad_org_id AS c_greeting_ad_org_id,
    bpg.isactive AS c_greeting_isactive,
    bpg.isfirstnameonly,
    bpg.name AS c_greeting_name,
    bpl.ad_org_id AS bp_location_ad_org_id,
    bpl.c_bpartner_id AS bp_location_c_bpartner_id,
    bpl.created AS bp_location_created,
    bpl.createdby AS bp_location_createdby,
    bpl.c_salesregion_id AS bp_location_c_salesregion_id,
    bpl.fax AS bp_location_fax,
    bpl.isactive AS bp_location_isactive,
    bpl.isbillto AS bp_location_isbillto,
    bpl.isdn AS bp_location_isdn,
    bpl.ispayfrom AS bp_location_ispayfrom,
    bpl.isremitto AS bp_location_isremitto,
    bpl.isshipto AS bp_location_isshipto,
    bpl.name AS bp_location_name,
    bpl.phone AS bp_location_phone,
    bpl.phone2 AS bp_location_phone2,
    bpl.updated AS bp_location_updated,
    bpl.updatedby AS bp_location_updatedby,
    l.address1,
    l.address2,
    l.address3,
    l.address4,
    l.ad_org_id AS c_location_ad_org_id,
    l.c_city_id,
    l.c_country_id,
    bpcountry.name AS country,
    l.city,
    l.created AS c_location_created,
    l.createdby AS c_location_createdby,
    l.c_region_id,
    l.isactive AS c_location_isactive,
    l.regionname,
    l.updated AS c_location_updated,
    l.updatedby AS c_location_updatedby,
    bpc.ad_org_id AS ad_user_ad_org_id,
    bpc.ad_orgtrx_id AS ad_user_ad_orgtrx_id,
    bpc.birthday AS ad_user_ad_birthday,
    bpc.c_bpartner_id AS ad_user_c_bpartner_id,
    bpc.c_bpartner_location_id AS ad_user_c_bpartner_location_id,
    bpc.c_greeting_id AS ad_user_c_greeting_id,
    bpc.comments AS ad_user_comments,
    bpc.created AS ad_user_created,
    bpc.createdby AS ad_user_createdby,
    bpc.description AS ad_user_description,
    bpc.email AS ad_user_email,
    bpc.fax AS ad_user_fax,
    bpc.isactive AS ad_user_isactive,
    bpc.lastcontact AS ad_user_lastcontact,
    bpc.lastresult AS ad_user_lastresult,
    bpc.phone2 AS ad_user_phone2,
    bpc.supervisor_id AS ad_user_supervisor_id,
    bpc.updated AS ad_user_updated,
    bpc.updatedby AS ad_user_updatedby,
    bpc.value AS ad_user_value,
    bpcg.ad_org_id AS c_user_greeting_ad_org_id,
    bpcg.isactive AS c_user_greeting_isactive,
    bpcg.isfirstnameonly AS c_user_greeting_isfnameonly,
    bpcg.name AS c_user_greeting_name,
    oi.ad_org_id AS ad_orginfo_ad_org_id,
    oi.ad_orgtype_id,
    oi.c_calendar_id,
    oi.created AS ad_orginfo_created,
    oi.createdby AS ad_orginfo_createdby,
    oi.dropship_warehouse_id,
    oi.duns AS ad_orginfo_duns,
    oi.email AS ad_orginfo_email,
    oi.fax AS ad_orginfo_fax,
    oi.isactive AS ad_orginfo_isactive,
    oi.m_warehouse_id AS ad_orginfo_m_warehouse_id,
    oi.parent_org_id,
    oi.phone AS ad_orginfo_phone,
    oi.phone2 AS ad_orginfo_phone2,
    oi.receiptfootermsg,
    oi.supervisor_id,
    oi.updated AS ad_orginfo_updated,
    oi.updatedby AS ad_orginfo_updatedby,
    u.ad_org_id AS salesrep_ad_org_id,
    u.ad_orgtrx_id AS salesrep_ad_orgtrx_id,
    u.birthday AS salesrep_ad_birthday,
    u.c_bpartner_id AS salesrep_c_bpartner_id,
    u.c_bpartner_location_id AS salesrep_c_bp_location_id,
    u.c_greeting_id AS salesrep_c_greeting_id,
    u.comments AS salesrep_comments,
    u.created AS salesrep_created,
    u.createdby AS salesrep_createdby,
    u.description AS salesrep_description,
    u.email AS salesrep_email,
    u.fax AS salesrep_fax,
    u.isactive AS salesrep_isactive,
    u.lastcontact AS salesrep_lastcontact,
    u.lastresult AS salesrep_lastresult,
    u.phone AS salesrep_phone,
    u.phone2 AS salesrep_phone2,
    u.supervisor_id AS salesrep_supervisor_id,
    u.title AS salesrep_title,
    u.updated AS salesrep_updated,
    u.updatedby AS salesrep_updatedby,
    u.value AS salesrep_value,
    ubp.acqusitioncost AS salesrep_bp_acqusitioncost,
    ubp.actuallifetimevalue AS salesrep_bp_actuallifetimeval,
    ubp.ad_language AS salesrep_bp_ad_language,
    ubp.ad_orgbp_id AS salesrep_bp_ad_orgbp_id,
    ubp.ad_org_id AS salesrep_bp_ad_org_id,
    ubp.bpartner_parent_id AS salesrep_bp_bpartner_parent_id,
    ubp.c_bp_group_id AS salesrep_bp_c_bp_group_id,
    ubp.c_dunning_id AS salesrep_bp_c_dunning_id,
    ubp.c_greeting_id AS salesrep_bp_c_greeting_id,
    ubp.c_invoiceschedule_id AS salesrep_bp_c_invoicesched_id,
    ubp.c_paymentterm_id AS salesrep_bp_c_paymentterm_id,
    ubp.created AS salesrep_bp_created,
    ubp.createdby AS salesrep_bp_createdby,
    ubp.c_taxgroup_id AS salesrep_bp_c_taxgroup_id,
    ubp.deliveryrule AS salesrep_bp_deliveryrule,
    ubp.deliveryviarule AS salesrep_bp_deliveryviarule,
    ubp.description AS salesrep_bp_description,
    ubp.dunninggrace AS salesrep_bp_dunninggrace,
    ubp.duns AS salesrep_bp_duns,
    ubp.firstsale AS salesrep_bp_firstsale,
    ubp.flatdiscount AS salesrep_bp_flatdiscount,
    ubp.freightcostrule AS salesrep_bp_freightcostrule,
    ubp.invoicerule AS salesrep_bp_invoicerule,
    ubp.isactive AS salesrep_bp_isactive,
    ubp.iscustomer AS salesrep_bp_iscustomer,
    ubp.isdiscountprinted AS salesrep_bp_isdiscountprinted,
    ubp.isemployee AS salesrep_bp_isemployee,
    ubp.ismanufacturer AS salesrep_bp_ismanufacturer,
    ubp.isonetime AS salesrep_bp_isonetime,
    ubp.ispotaxexempt AS salesrep_bp_ispotaxexempt,
    ubp.isprospect AS salesrep_bp_isprospect,
    ubp.issalesrep AS salesrep_bp_issalesrep,
    ubp.issummary AS salesrep_bp_issummary,
    ubp.istaxexempt AS salesrep_bp_istaxexempt,
    ubp.isvendor AS salesrep_bp_isvendor,
    ubp.logo_id AS salesrep_bp_logo_id,
    ubp.m_discountschema_id AS salesrep_bp_m_discountschm_id,
    ubp.m_pricelist_id AS salesrep_bp_m_pricelist_id,
    ubp.naics AS salesrep_bp_naics,
    ubp.name2 AS salesrep_bp_name2,
    ubp.numberemployees AS salesrep_bp_numberemployees,
    ubp.paymentrule AS salesrep_bp_paymentrule,
    ubp.paymentrulepo AS salesrep_bp_paymentrulepo,
    ubp.po_discountschema_id AS salesrep_bp_po_discountschm_id,
    ubp.po_paymentterm_id AS salesrep_bp_po_paymentterm_id,
    ubp.po_pricelist_id AS salesrep_bp_po_pricelist_id,
    ubp.poreference AS salesrep_bp_poreference,
    ubp.potentiallifetimevalue AS salesrep_bp_potentiallifetime,
    ubp.rating AS salesrep_bp_rating,
    ubp.referenceno AS salesrep_bp_referenceno,
    ubp.salesrep_id AS salesrep_bp_salesrep_id,
    ubp.salesvolume AS salesrep_bp_salesvolume,
    ubp.sendemail AS salesrep_bp_sendemail,
    ubp.shareofcustomer AS salesrep_bp_shareofcustomer,
    ubp.shelflifeminpct AS salesrep_bp_shelflifeminpct,
    ubp.so_creditlimit AS salesrep_bp_so_creditlimit,
    ubp.socreditstatus AS salesrep_bp_socreditstatus,
    ubp.so_creditused AS salesrep_bp_so_creditused,
    ubp.so_description AS salesrep_bp_so_description,
    ubp.taxid AS salesrep_bp_taxid,
    ubp.totalopenbalance AS salesrep_bp_totalopenbalance,
    ubp.updated AS salesrep_bp_updated,
    ubp.updatedby AS salesrep_bp_updatedby,
    ubp.url AS salesrep_bp_url,
    ubp.value AS salesrep_bp_value,
    bbp.acqusitioncost AS bill_bp_acqusitioncost,
    bbp.actuallifetimevalue AS bill_bp_actuallifetimevalue,
    bbp.ad_language AS bill_bp_ad_language,
    bbp.ad_orgbp_id AS bill_bp_ad_orgbp_id,
    bbp.ad_org_id AS bill_bp_ad_org_id,
    bbp.bpartner_parent_id AS bill_bp_bpartner_parent_id,
    bbp.c_bp_group_id AS bill_bp_c_bp_group_id,
    bbp.c_dunning_id AS bill_bp_c_dunning_id,
    bbp.c_greeting_id AS bill_bp_c_greeting_id,
    bbp.c_invoiceschedule_id AS bill_bp_c_invoiceschedule_id,
    bbp.c_paymentterm_id AS bill_bp_c_paymentterm_id,
    bbp.created AS bill_bp_created,
    bbp.createdby AS bill_bp_createdby,
    bbp.c_taxgroup_id AS bill_bp_c_taxgroup_id,
    bbp.deliveryrule AS bill_bp_deliveryrule,
    bbp.deliveryviarule AS bill_bp_deliveryviarule,
    bbp.description AS bill_bp_description,
    bbp.dunninggrace AS bill_bp_dunninggrace,
    bbp.duns AS bill_bp_duns,
    bbp.firstsale AS bill_bp_firstsale,
    bbp.flatdiscount AS bill_bp_flatdiscount,
    bbp.freightcostrule AS bill_bp_freightcostrule,
    bbp.invoicerule AS bill_bp_invoicerule,
    bbp.isactive AS bill_bp_isactive,
    bbp.iscustomer AS bill_bp_iscustomer,
    bbp.isdiscountprinted AS bill_bp_isdiscountprinted,
    bbp.isemployee AS bill_bp_isemployee,
    bbp.ismanufacturer AS bill_bp_ismanufacturer,
    bbp.isonetime AS bill_bp_isonetime,
    bbp.ispotaxexempt AS bill_bp_ispotaxexempt,
    bbp.isprospect AS bill_bp_isprospect,
    bbp.issalesrep AS bill_bp_issalesrep,
    bbp.issummary AS bill_bp_issummary,
    bbp.istaxexempt AS bill_bp_istaxexempt,
    bbp.isvendor AS bill_bp_isvendor,
    bbp.logo_id AS bill_bp_logo_id,
    bbp.m_discountschema_id AS bill_bp_m_discountschema_id,
    bbp.m_pricelist_id AS bill_bp_m_pricelist_id,
    bbp.naics AS bill_bp_naics,
    bbp.numberemployees AS bill_bp_numberemployees,
    bbp.paymentrule AS bill_bp_paymentrule,
    bbp.paymentrulepo AS bill_bp_paymentrulepo,
    bbp.po_discountschema_id AS bill_bp_po_discountschema_id,
    bbp.po_paymentterm_id AS bill_bp_po_paymentterm_id,
    bbp.po_pricelist_id AS bill_bp_po_pricelist_id,
    bbp.poreference AS bill_bp_poreference,
    bbp.potentiallifetimevalue AS bill_bp_potentiallifetimevalue,
    bbp.rating AS bill_bp_rating,
    bbp.referenceno AS bill_bp_referenceno,
    bbp.salesrep_id AS bill_bp_salesrep_id,
    bbp.salesvolume AS bill_bp_salesvolume,
    bbp.sendemail AS bill_bp_sendemail,
    bbp.shareofcustomer AS bill_bp_shareofcustomer,
    bbp.shelflifeminpct AS bill_bp_shelflifeminpct,
    bbp.so_creditlimit AS bill_bp_so_creditlimit,
    bbp.socreditstatus AS bill_bp_socreditstatus,
    bbp.so_creditused AS bill_bp_so_creditused,
    bbp.so_description AS bill_bp_so_description,
    bbp.totalopenbalance AS bill_bp_totalopenbalance,
    bbp.updated AS bill_bp_updated,
    bbp.updatedby AS bill_bp_updatedby,
    bbp.url AS bill_bp_url,
    bbpl.ad_org_id AS bill_bp_location_ad_org_id,
    bbpl.c_bpartner_id AS bill_bp_location_c_bpartner_id,
    bbpl.created AS bill_bp_location_created,
    bbpl.createdby AS bill_bp_location_createdby,
    bbpl.c_salesregion_id AS bill_bp_location_c_salesreg_id,
    bbpl.fax AS bill_bp_location_fax,
    bbpl.isactive AS bill_bp_location_isactive,
    bbpl.isbillto AS bill_bp_location_isbillto,
    bbpl.isdn AS bill_bp_location_isdn,
    bbpl.ispayfrom AS bill_bp_location_ispayfrom,
    bbpl.isremitto AS bill_bp_location_isremitto,
    bbpl.isshipto AS bill_bp_location_isshipto,
    bbpl.name AS bill_bp_location_name,
    bbpl.phone AS bill_bp_location_phone,
    bbpl.phone2 AS bill_bp_location_phone2,
    bbpl.updated AS bill_bp_location_updated,
    bbpl.updatedby AS bill_bp_location_updatedby,
    bbpc.ad_org_id AS bill_user_ad_org_id,
    bbpc.ad_orgtrx_id AS bill_user_ad_orgtrx_id,
    bbpc.birthday AS bill_user_ad_birthday,
    bbpc.c_bpartner_id AS bill_user_c_bpartner_id,
    bbpc.c_bpartner_location_id AS bill_user_c_bp_location_id,
    bbpc.c_greeting_id AS bill_user_c_greeting_id,
    bbpc.comments AS bill_user_comments,
    bbpc.created AS bill_user_created,
    bbpc.createdby AS bill_user_createdby,
    bbpc.description AS bill_user_description,
    bbpc.email AS bill_user_email,
    bbpc.fax AS bill_user_fax,
    bbpc.isactive AS bill_user_isactive,
    bbpc.lastcontact AS bill_user_lastcontact,
    bbpc.lastresult AS bill_user_lastresult,
    bbpc.phone2 AS bill_user_phone2,
    bbpc.supervisor_id AS bill_user_supervisor_id,
    bbpc.updated AS bill_user_updated,
    bbpc.updatedby AS bill_user_updatedby,
    bbpc.value AS bill_user_value,
    cur.cursymbol,
    cur.description AS cur_description
   FROM (((((((((((((((((((((((c_order o
     JOIN c_doctype dt ON ((o.c_doctype_id = dt.c_doctype_id)))
     JOIN m_warehouse wh ON ((o.m_warehouse_id = wh.m_warehouse_id)))
     JOIN c_paymentterm pt ON ((o.c_paymentterm_id = pt.c_paymentterm_id)))
     JOIN c_bpartner bp ON ((o.c_bpartner_id = bp.c_bpartner_id)))
     LEFT JOIN c_greeting bpg ON ((bp.c_greeting_id = bpg.c_greeting_id)))
     JOIN c_bpartner_location bpl ON ((o.c_bpartner_location_id = bpl.c_bpartner_location_id)))
     JOIN c_location l ON ((bpl.c_location_id = l.c_location_id)))
     JOIN c_country bpcountry ON ((bpcountry.c_country_id = l.c_country_id)))
     LEFT JOIN ad_user bpc ON ((o.ad_user_id = bpc.ad_user_id)))
     LEFT JOIN c_greeting bpcg ON ((bpc.c_greeting_id = bpcg.c_greeting_id)))
     JOIN ad_orginfo oi ON ((o.ad_org_id = oi.ad_org_id)))
     JOIN c_location ol ON ((oi.c_location_id = ol.c_location_id)))
     JOIN ad_org org ON ((org.ad_org_id = o.ad_org_id)))
     JOIN c_country oc ON ((oc.c_country_id = ol.c_country_id)))
     JOIN ad_clientinfo ci ON ((o.ad_client_id = ci.ad_client_id)))
     LEFT JOIN ad_user u ON ((o.salesrep_id = u.ad_user_id)))
     LEFT JOIN c_bpartner ubp ON ((u.c_bpartner_id = ubp.c_bpartner_id)))
     JOIN c_bpartner bbp ON ((o.bill_bpartner_id = bbp.c_bpartner_id)))
     JOIN c_bpartner_location bbpl ON ((o.bill_location_id = bbpl.c_bpartner_location_id)))
     LEFT JOIN ad_user bbpc ON ((o.bill_user_id = bbpc.ad_user_id)))
     LEFT JOIN c_currency cur ON ((o.c_currency_id = cur.c_currency_id)))
     LEFT JOIN m_product p ON ((p.m_product_id = o.wmv_product_id)))
     LEFT JOIN wmv_lineformat lf ON ((lf.wmv_lineformat_id = p.wmv_lineformat_id)));
--
-- create view  wmv_invoice_header_vt
--
CREATE OR REPLACE VIEW wmv_invoice_header_vt AS
 SELECT i.incoterm,
    i.isusingfactoring,
    wmv_textblock('factoring_note'::character varying, i.isusingfactoring) AS factoringtext,
    wmv_textblock('bankverbindung'::character varying, i.isusingfactoring, true) AS bankverbindung,
    wmv_textblock('companyinfo'::character varying) AS companyinfo,
    i.wmv_product_id AS m_product_id,
    lf.name AS lineformat,
    prod_trl.description AS productdescription,
    paymenttermduedate(i.c_paymentterm_id, (i.dateinvoiced)::timestamp with time zone) AS paydueday,
    i.ad_client_id,
    i.ad_org_id,
    i.isactive,
    i.created,
    i.createdby,
    i.updated,
    i.updatedby,
    dt.ad_language,
    i.c_invoice_id,
    i.issotrx,
    i.documentno,
    i.docstatus,
    i.c_doctype_id,
    i.c_bpartner_id,
    bp.value AS bpvalue,
    bp.taxid AS bptaxid,
    bp.naics,
    bp.duns,
    oi.c_location_id AS org_location_id,
    org.name AS org_name,
    ol.address1 AS org_address1,
    ol.address2 AS org_address2,
    ol.address3 AS org_address3,
    ol.address4 AS org_address4,
    ol.c_country_id AS org_country_id,
    oc.name AS org_country,
    oc.countrycode AS org_countrycode,
    ol.city AS org_city,
    concat((ol.postal)::text, (ol.postal_add)::text) AS org_postal,
    oi.taxid,
    dt.printname AS documenttype,
    dt.documentnote AS documenttypenote,
    i.c_order_id,
    o.documentno AS order_no,
    i.salesrep_id,
    COALESCE(ubp.name, u.name) AS salesrep_name,
    i.dateinvoiced,
    bpgt.greeting AS bpgreeting,
    bp.name,
    bp.name2,
    bpcgt.greeting AS bpcontactgreeting,
    bpc.title,
    bpc.phone,
    NULLIF((bpc.name)::text, (bp.name)::text) AS contactname,
    bpl.c_location_id,
    bp.referenceno,
    concat((l.postal)::text, (l.postal_add)::text) AS postal,
    i.description,
    i.poreference,
    i.dateordered,
    i.c_currency_id,
    ptt.name AS paymentterm,
    ptt.documentnote AS paymenttermnote,
    i.c_charge_id,
    i.chargeamt,
    i.totallines,
    i.grandtotal,
    i.grandtotal AS amtinwords,
    i.m_pricelist_id,
    i.istaxincluded,
    i.c_campaign_id,
    i.c_project_id,
    i.c_activity_id,
    i.ispaid,
    COALESCE(oi.logo_id, ci.logo_id) AS logo_id,
    i.ad_orgtrx_id AS c_invoice_ad_orgtrx_id,
    i.ad_user_id,
    i.c_bpartner_location_id,
    i.c_conversiontype_id,
    i.c_doctypetarget_id,
    i.c_dunninglevel_id,
    i.c_payment_id,
    i.dateacct,
    i.dateprinted,
    i.docaction,
    i.dunninggrace,
    i.generateto,
    i.invoicecollectiontype,
    i.isapproved,
    i.isdiscountprinted,
    i.isindispute,
    i.ispayschedulevalid,
    i.isprinted,
    i.isselfservice AS c_invoice_isselfservice,
    i.istransferred,
    i.m_rma_id,
    i.paymentrule,
    i.posted,
    i.processedon,
    i.processing,
    i.ref_invoice_id,
    i.reversal_id,
    i.sendemail,
    i.user1_id,
    i.user2_id,
    ptt.ad_org_id AS c_paymentterm_ad_org_id,
    pt.afterdelivery,
    pt.c_paymentterm_id,
    ptt.description AS c_paymentterm_description,
    pt.discount,
    pt.discount2,
    pt.discountdays,
    pt.discountdays2,
    pt.fixmonthcutoff,
    pt.fixmonthday,
    pt.fixmonthoffset,
    pt.gracedays,
    ptt.isactive AS c_paymentterm_isactive,
    pt.isdefault,
    pt.isduefixed,
    pt.isnextbusinessday,
    pt.isvalid,
    pt.netday,
    pt.netdays,
    pt.paymenttermusage,
    pt.value AS c_paymentterm_value,
    bp.acqusitioncost AS bp_acqusitioncost,
    bp.actuallifetimevalue AS bp_actuallifetimevalue,
    bp.ad_language AS bp_ad_language,
    bp.ad_orgbp_id AS bp_ad_orgbp_id,
    bp.ad_org_id AS bp_ad_org_id,
    bp.bpartner_parent_id AS bp_bpartner_parent_id,
    bp.c_bp_group_id AS bp_c_bp_group_id,
    bp.c_dunning_id AS bp_c_dunning_id,
    bp.c_greeting_id AS bp_c_greeting_id,
    bp.c_invoiceschedule_id AS bp_c_invoiceschedule_id,
    bp.c_paymentterm_id AS bp_c_paymentterm_id,
    bp.created AS bp_created,
    bp.createdby AS bp_createdby,
    bp.c_taxgroup_id AS bp_c_taxgroup_id,
    bp.deliveryrule AS bp_deliveryrule,
    bp.deliveryviarule AS bp_deliveryviarule,
    bp.description AS bp_description,
    bp.dunninggrace AS bp_dunninggrace,
    bp.firstsale AS bp_firstsale,
    bp.flatdiscount AS bp_flatdiscount,
    bp.freightcostrule AS bp_freightcostrule,
    bp.invoicerule AS bp_invoicerule,
    bp.isactive AS bp_isactive,
    bp.iscustomer AS bp_iscustomer,
    bp.isdiscountprinted AS bp_isdiscountprinted,
    bp.isemployee AS bp_isemployee,
    bp.ismanufacturer AS bp_ismanufacturer,
    bp.isonetime AS bp_isonetime,
    bp.ispotaxexempt AS bp_ispotaxexempt,
    bp.isprospect AS bp_isprospect,
    bp.issalesrep AS bp_issalesrep,
    bp.issummary AS bp_issummary,
    bp.istaxexempt AS bp_istaxexempt,
    bp.isvendor AS bp_isvendor,
    bp.logo_id AS bp_logo_id,
    bp.m_discountschema_id AS bp_m_discountschema_id,
    bp.m_pricelist_id AS bp_m_pricelist_id,
    bp.naics AS bp_naics,
    bp.numberemployees AS bp_numberemployees,
    bp.paymentrule AS bp_paymentrule,
    bp.paymentrulepo AS bp_paymentrulepo,
    bp.po_discountschema_id AS bp_po_discountschema_id,
    bp.po_paymentterm_id AS bp_po_paymentterm_id,
    bp.po_pricelist_id AS bp_po_pricelist_id,
    bp.poreference AS bp_poreference,
    bp.potentiallifetimevalue AS bp_potentiallifetimevalue,
    bp.rating AS bp_rating,
    bp.salesrep_id AS bp_salesrep_id,
    bp.salesvolume AS bp_salesvolume,
    bp.sendemail AS bp_sendemail,
    bp.shareofcustomer AS bp_shareofcustomer,
    bp.shelflifeminpct AS bp_shelflifeminpct,
    bp.so_creditlimit AS bp_so_creditlimit,
    bp.socreditstatus AS bp_socreditstatus,
    bp.so_creditused AS bp_so_creditused,
    bp.so_description AS bp_so_description,
    bp.totalopenbalance AS bp_totalopenbalance,
    bp.updated AS bp_updated,
    bp.updatedby AS bp_updatedby,
    bp.url AS bp_url,
    bpgt.isactive AS c_greeting_isactive,
    bpg.isfirstnameonly,
    bpgt.name AS c_greeting_name,
    bpl.ad_org_id AS bp_location_ad_org_id,
    bpl.c_bpartner_id AS bp_location_c_bpartner_id,
    bpl.created AS bp_location_created,
    bpl.createdby AS bp_location_createdby,
    bpl.c_salesregion_id,
    bpl.fax AS bp_location_fax,
    bpl.isactive AS bp_location_isactive,
    bpl.isbillto,
    bpl.isdn,
    bpl.ispayfrom,
    bpl.isremitto,
    bpl.isshipto,
    bpl.name AS bp_location_name,
    bpl.phone AS bp_location_phone,
    bpl.phone2 AS bp_location_phone2,
    bpl.updated AS bp_location_updated,
    bpl.updatedby AS bp_location_updatedby,
    l.address1,
    l.address2,
    l.address3,
    l.address4,
    l.ad_org_id AS c_location_ad_org_id,
    l.c_city_id,
    l.c_country_id,
    bpcountry.name AS country,
    l.city,
    l.created AS c_location_created,
    l.createdby AS c_location_createdby,
    l.c_region_id,
    l.isactive AS c_location_isactive,
    l.regionname,
    l.updated AS c_location_updated,
    l.updatedby AS c_location_updatedby,
    bpc.ad_org_id AS ad_user_ad_org_id,
    bpc.ad_orgtrx_id AS ad_user_ad_ad_orgtrx_id,
    bpc.birthday AS ad_user_ad_birthday,
    bpc.c_bpartner_id AS ad_user_c_bpartner_id,
    bpc.c_bpartner_location_id AS ad_user_c_bpartner_location_id,
    bpc.c_greeting_id AS ad_user_c_greeting_id,
    bpc.comments AS ad_user_comments,
    bpc.created AS ad_user_created,
    bpc.createdby AS ad_user_createdby,
    bpc.description AS ad_user_description,
    bpc.email AS ad_user_email,
    bpc.fax AS ad_user_fax,
    bpc.isactive AS ad_user_isactive,
    bpc.lastcontact AS ad_user_lastcontact,
    bpc.lastresult AS ad_user_lastresult,
    bpc.phone2 AS ad_user_phone2,
    bpc.supervisor_id AS ad_user_supervisor_id,
    bpc.updated AS ad_user_updated,
    bpc.updatedby AS ad_user_updatedby,
    bpc.value AS ad_user_value,
    bpcgt.isactive AS user_greeting_isactive,
    bpcg.isfirstnameonly AS user_greeting_isfirstnameonly,
    bpcgt.name AS user_greeting_name,
    oi.ad_org_id AS ad_orginfo_ad_org_id,
    oi.ad_orgtype_id,
    oi.c_calendar_id,
    oi.created AS ad_orginfo_created,
    oi.createdby AS ad_orginfo_createdby,
    oi.dropship_warehouse_id,
    oi.duns AS ad_orginfo_duns,
    oi.email AS ad_orginfo_email,
    oi.fax AS ad_orginfo_fax,
    oi.isactive AS ad_orginfo_isactive,
    oi.m_warehouse_id,
    oi.parent_org_id,
    oi.phone AS ad_orginfo_phone,
    oi.phone2 AS ad_orginfo_phone2,
    oi.receiptfootermsg,
    oi.supervisor_id,
    oi.updated AS ad_orginfo_updated,
    oi.updatedby AS ad_orginfo_updatedby,
    u.ad_org_id AS salesrep_ad_org_id,
    u.ad_orgtrx_id AS salesrep_ad_ad_orgtrx_id,
    u.birthday AS salesrep_ad_birthday,
    u.c_bpartner_id AS salesrep_c_bpartner_id,
    u.c_bpartner_location_id AS salesrep_c_bp_location_id,
    u.c_greeting_id AS salesrep_c_greeting_id,
    u.comments AS salesrep_comments,
    u.created AS salesrep_created,
    u.createdby AS salesrep_createdby,
    u.description AS salesrep_description,
    u.email AS salesrep_email,
    u.fax AS salesrep_fax,
    u.isactive AS salesrep_isactive,
    u.lastcontact AS salesrep_lastcontact,
    u.lastresult AS salesrep_lastresult,
    u.phone AS salesrep_phone,
    u.phone2 AS salesrep_phone2,
    u.supervisor_id AS salesrep_supervisor_id,
    u.title AS salesrep_title,
    u.updated AS salesrep_updated,
    u.updatedby AS salesrep_updatedby,
    u.value AS salesrep_value,
    ubp.acqusitioncost AS bpartner_acqusitioncost,
    ubp.actuallifetimevalue AS bpartner_actuallifetimevalue,
    ubp.ad_language AS bpartner_ad_language,
    ubp.ad_orgbp_id AS bpartner_ad_orgbp_id,
    ubp.ad_org_id AS bpartner_ad_org_id,
    ubp.bpartner_parent_id AS bpartner_bpartner_parent_id,
    ubp.c_bp_group_id AS bpartner_c_bp_group_id,
    ubp.c_dunning_id AS bpartner_c_dunning_id,
    ubp.c_greeting_id AS bpartner_c_greeting_id,
    ubp.c_invoiceschedule_id AS bpartner_c_invoiceschedule_id,
    ubp.c_paymentterm_id AS bpartner_c_paymentterm_id,
    ubp.created AS bpartner_created,
    ubp.createdby AS bpartner_createdby,
    ubp.c_taxgroup_id AS bpartner_c_taxgroup_id,
    ubp.deliveryrule AS bpartner_deliveryrule,
    ubp.deliveryviarule AS bpartner_deliveryviarule,
    ubp.description AS bpartner_description,
    ubp.dunninggrace AS bpartner_dunninggrace,
    ubp.duns AS bpartner_duns,
    ubp.firstsale AS bpartner_firstsale,
    ubp.flatdiscount AS bpartner_flatdiscount,
    ubp.freightcostrule AS bpartner_freightcostrule,
    ubp.invoicerule AS bpartner_invoicerule,
    ubp.isactive AS bpartner_isactive,
    ubp.iscustomer AS bpartner_iscustomer,
    ubp.isdiscountprinted AS bpartner_isdiscountprinted,
    ubp.isemployee AS bpartner_isemployee,
    ubp.ismanufacturer AS bpartner_ismanufacturer,
    ubp.isonetime AS bpartner_isonetime,
    ubp.ispotaxexempt AS bpartner_ispotaxexempt,
    ubp.isprospect AS bpartner_isprospect,
    ubp.issalesrep AS bpartner_issalesrep,
    ubp.issummary AS bpartner_issummary,
    ubp.istaxexempt AS bpartner_istaxexempt,
    ubp.isvendor AS bpartner_isvendor,
    ubp.logo_id AS bpartner_logo_id,
    ubp.m_discountschema_id AS bpartner_m_discountschema_id,
    ubp.m_pricelist_id AS bpartner_m_pricelist_id,
    ubp.naics AS bpartner_naics,
    ubp.name2 AS bpartner_name2,
    ubp.numberemployees AS bpartner_numberemployees,
    ubp.paymentrule AS bpartner_paymentrule,
    ubp.paymentrulepo AS bpartner_paymentrulepo,
    ubp.po_discountschema_id AS bpartner_po_discountschema_id,
    ubp.po_paymentterm_id AS bpartner_po_paymentterm_id,
    ubp.po_pricelist_id AS bpartner_po_pricelist_id,
    ubp.poreference AS bpartner_poreference,
    ubp.potentiallifetimevalue AS bpartner_potentiallifetimeval,
    ubp.rating AS bpartner_rating,
    ubp.referenceno AS bpartner_referenceno,
    ubp.salesrep_id AS bpartner_salesrep_id,
    ubp.salesvolume AS bpartner_salesvolume,
    ubp.sendemail AS bpartner_sendemail,
    ubp.shareofcustomer AS bpartner_shareofcustomer,
    ubp.shelflifeminpct AS bpartner_shelflifeminpct,
    ubp.so_creditlimit AS bpartner_so_creditlimit,
    ubp.socreditstatus AS bpartner_socreditstatus,
    ubp.so_creditused AS bpartner_so_creditused,
    ubp.so_description AS bpartner_so_description,
    ubp.taxid AS bpartner_taxid,
    ubp.totalopenbalance AS bpartner_totalopenbalance,
    ubp.updated AS bpartner_updated,
    ubp.updatedby AS bpartner_updatedby,
    ubp.url AS bpartner_url,
    ubp.value AS bpartner_value,
    cur.cursymbol,
    cur.description AS cur_description
   FROM (((((((((((((((((((((((((c_invoice i
     JOIN c_doctype_trl dt ON ((i.c_doctype_id = dt.c_doctype_id)))
     JOIN c_paymentterm pt ON ((i.c_paymentterm_id = pt.c_paymentterm_id)))
     JOIN c_paymentterm_trl ptt ON (((i.c_paymentterm_id = ptt.c_paymentterm_id) AND ((dt.ad_language)::text = (ptt.ad_language)::text))))
     JOIN c_bpartner bp ON ((i.c_bpartner_id = bp.c_bpartner_id)))
     LEFT JOIN c_greeting bpg ON ((bp.c_greeting_id = bpg.c_greeting_id)))
     LEFT JOIN c_greeting_trl bpgt ON (((bp.c_greeting_id = bpgt.c_greeting_id) AND ((dt.ad_language)::text = (bpgt.ad_language)::text))))
     JOIN c_bpartner_location bpl ON ((i.c_bpartner_location_id = bpl.c_bpartner_location_id)))
     JOIN c_location l ON ((bpl.c_location_id = l.c_location_id)))
     LEFT JOIN ad_user bpc ON ((i.ad_user_id = bpc.ad_user_id)))
     LEFT JOIN c_greeting bpcg ON ((bpc.c_greeting_id = bpcg.c_greeting_id)))
     LEFT JOIN c_greeting_trl bpcgt ON (((bpc.c_greeting_id = bpcgt.c_greeting_id) AND ((dt.ad_language)::text = (bpcgt.ad_language)::text))))
     JOIN ad_orginfo oi ON ((i.ad_org_id = oi.ad_org_id)))
     JOIN ad_clientinfo ci ON ((i.ad_client_id = ci.ad_client_id)))
     LEFT JOIN ad_user u ON ((i.salesrep_id = u.ad_user_id)))
     LEFT JOIN c_bpartner ubp ON ((u.c_bpartner_id = ubp.c_bpartner_id)))
     LEFT JOIN c_currency_trl cur ON (((i.c_currency_id = cur.c_currency_id) AND ((dt.ad_language)::text = (cur.ad_language)::text))))
     LEFT JOIN ad_image img ON ((img.ad_image_id = COALESCE(oi.logo_id, ci.logo_id))))
     JOIN c_location ol ON ((oi.c_location_id = ol.c_location_id)))
     JOIN ad_org org ON ((org.ad_org_id = i.ad_org_id)))
     JOIN c_country oc ON ((oc.c_country_id = ol.c_country_id)))
     JOIN c_country bpcountry ON ((bpcountry.c_country_id = l.c_country_id)))
     LEFT JOIN c_order o ON ((o.c_order_id = i.c_order_id)))
     LEFT JOIN m_product p ON ((p.m_product_id = i.wmv_product_id)))
     LEFT JOIN m_product_trl prod_trl ON (((prod_trl.m_product_id = i.wmv_product_id) AND ((dt.ad_language)::text = (prod_trl.ad_language)::text))))
     LEFT JOIN wmv_lineformat lf ON ((lf.wmv_lineformat_id = p.wmv_lineformat_id)));
--
-- create view  wmv_order_linetax_vt
--
CREATE OR REPLACE VIEW wmv_order_linetax_vt AS
 SELECT ol.ad_client_id,
    ol.ad_org_id,
    ol.isactive,
    ol.created,
    ol.createdby,
    ol.updated,
    ol.updatedby,
    uomt.ad_language,
    ol.c_order_id,
    ol.c_orderline_id,
    ol.c_tax_id,
    tt.taxindicator,
    ol.c_bpartner_id,
    ol.c_bpartner_location_id,
    bp.name AS bpname,
    bpl.c_location_id,
    ol.line,
    pt.m_product_id,
    po.vendorproductno,
        CASE
            WHEN ((ol.qtyordered <> (0)::numeric) OR (ol.m_product_id IS NOT NULL)) THEN ol.qtyordered
            ELSE NULL::numeric
        END AS qtyordered,
        CASE
            WHEN ((ol.qtyentered <> (0)::numeric) OR (ol.m_product_id IS NOT NULL)) THEN ol.qtyentered
            ELSE NULL::numeric
        END AS qtyentered,
        CASE
            WHEN ((ol.qtyentered <> (0)::numeric) OR (ol.m_product_id IS NOT NULL)) THEN uomt.uomsymbol
            ELSE NULL::character varying
        END AS uomsymbol,
    COALESCE(p.wmv_display_precision, uom.stdprecision, (2)::numeric) AS qtyprecision,
    COALESCE(ct.name, (((COALESCE(pt.name, p.name))::text || (productattribute(ol.m_attributesetinstance_id))::text))::character varying, ol.description) AS name,
        CASE
            WHEN (COALESCE(ct.name, pt.name, p.name) IS NOT NULL) THEN ol.description
            ELSE NULL::character varying
        END AS description,
    COALESCE(pt.documentnote, p.documentnote) AS documentnote,
    p.upc,
    p.sku,
    COALESCE(pp.vendorproductno, p.value) AS productvalue,
    ra.description AS resourcedescription,
        CASE
            WHEN ((o.isdiscountprinted = 'Y'::bpchar) AND (ol.pricelist <> (0)::numeric)) THEN ol.pricelist
            ELSE NULL::numeric
        END AS pricelist,
        CASE
            WHEN ((o.isdiscountprinted = 'Y'::bpchar) AND (ol.pricelist <> (0)::numeric) AND (ol.qtyentered <> (0)::numeric)) THEN ((ol.pricelist * ol.qtyordered) / ol.qtyentered)
            ELSE NULL::numeric
        END AS priceenteredlist,
        CASE
            WHEN ((o.isdiscountprinted = 'Y'::bpchar) AND (ol.pricelist > ol.priceactual) AND (ol.pricelist <> (0)::numeric)) THEN (((ol.pricelist - ol.priceactual) / ol.pricelist) * (100)::numeric)
            ELSE NULL::numeric
        END AS discount,
        CASE
            WHEN ((ol.priceactual <> (0)::numeric) OR (ol.m_product_id IS NOT NULL)) THEN ol.priceactual
            ELSE NULL::numeric
        END AS priceactual,
        CASE
            WHEN ((ol.priceentered <> (0)::numeric) OR (ol.m_product_id IS NOT NULL)) THEN ol.priceentered
            ELSE NULL::numeric
        END AS priceentered,
        CASE
            WHEN ((ol.linenetamt <> (0)::numeric) OR (ol.m_product_id IS NOT NULL)) THEN ol.linenetamt
            ELSE NULL::numeric
        END AS linenetamt,
    pt.description AS productdescription,
    p.imageurl,
    ol.c_campaign_id,
    ol.c_project_id,
    ol.c_activity_id,
    ol.c_projectphase_id,
    ol.c_projecttask_id,
    ol.ad_orgtrx_id AS c_orderline_ad_orgtrx_id,
    ol.c_charge_id AS c_orderline_c_charge_id,
    ol.c_currency_id AS c_orderline_c_currency_id,
    COALESCE(cur.cursymbol, (cur.iso_code)::character varying) AS cursymbol,
    ol.c_uom_id,
    ol.datedelivered,
    ol.dateinvoiced,
    ol.dateordered,
    ol.datepromised AS c_orderline_datepromised,
    ol.freightamt AS c_orderline_freightamt,
    ol.isdescription,
    ol.link_orderline_id,
    ol.m_promotion_id,
    ol.m_shipper_id AS c_orderline_m_shipper_id,
    ol.m_warehouse_id AS c_orderline_m_warehouse_id,
    ol.pricecost,
    ol.pricelimit,
    ol.processed AS c_orderline_processed,
    ol.qtydelivered,
    ol.qtyinvoiced,
    ol.qtylostsales,
    ol.qtyreserved,
    ol.ref_orderline_id,
    ol.rramt,
    ol.rrstartdate,
    ol.s_resourceassignment_id,
    ol.user1_id AS c_orderline_user1_id,
    ol.user2_id AS c_orderline_user2_id,
    uomt.ad_org_id AS c_uom_ad_org_id,
    uom.costingprecision,
    uomt.description AS c_uom_description,
    uomt.isactive AS c_uom_isactive,
    uom.isdefault,
    uomt.name AS c_uom_name,
    uom.stdprecision,
    uom.uomtype,
    uom.x12de355,
    o.ad_org_id AS c_order_ad_org_id,
    o.ad_orgtrx_id AS c_order_ad_orgtrx_id,
    o.ad_user_id,
    o.amountrefunded,
    o.amounttendered,
    o.bill_bpartner_id,
    o.bill_location_id,
    o.bill_user_id,
    o.c_activity_id AS c_order_c_activity_id,
    o.c_bpartner_id AS c_order_c_bpartner_id,
    o.c_campaign_id AS c_order_c_campaign_id,
    o.c_cashline_id,
    o.c_cashplanline_id,
    o.c_charge_id AS c_order_c_charge_id,
    o.c_conversiontype_id,
    o.c_currency_id AS c_order_c_currency_id,
    o.c_doctype_id,
    o.c_doctypetarget_id,
    o.chargeamt,
    o.copyfrom,
    o.c_payment_id,
    o.c_paymentterm_id,
    o.c_pos_id,
    o.c_project_id AS c_order_c_project_id,
    o.created AS c_order_created,
    o.createdby AS c_order_createdby,
    o.dateacct,
    o.dateprinted,
    o.datepromised AS c_order_datepromised,
    o.deliveryrule,
    o.deliveryviarule,
    o.description AS c_order_description,
    o.docaction,
    o.docstatus,
    o.documentno,
    o.dropship_bpartner_id,
    o.dropship_location_id,
    o.dropship_user_id,
    o.freightamt AS c_order_freightamt,
    o.freightcostrule,
    o.grandtotal,
    o.invoicerule,
    o.isactive AS c_order_isactive,
    o.isapproved,
    o.iscreditapproved,
    o.isdelivered,
    o.isdiscountprinted AS c_order_isdiscountprinted,
    o.isdropship AS c_order_isdropship,
    o.isinvoiced,
    o.ispayschedulevalid,
    o.isprinted,
    o.isselected,
    o.isselfservice AS c_order_isselfservice,
    o.issotrx,
    o.istaxincluded,
    o.istransferred,
    o.link_order_id,
    o.m_freightcategory_id AS c_order_m_freightcategory_id,
    o.m_pricelist_id AS c_order_m_pricelist_id,
    o.m_shipper_id AS c_order_m_shipper_id,
    o.m_warehouse_id AS c_order_m_warehouse_id,
    o.ordertype,
    o.pay_bpartner_id,
    o.pay_location_id,
    o.paymentrule AS c_order_paymentrule,
    o.poreference,
    o.posted,
    o.priorityrule,
    o.processed AS c_order_processed,
    o.processedon,
    o.promotioncode,
    o.ref_order_id,
    o.salesrep_id,
    o.sendemail AS c_order_sendemail,
    o.totallines,
    o.updated AS c_order_updated,
    o.updatedby AS c_order_updatedby,
    o.user1_id AS c_order_user1_id,
    o.user2_id AS c_order_user2_id,
    o.volume AS c_order_volume,
    o.weight AS c_order_weight,
    pt.ad_org_id AS m_product_ad_org_id,
    p.classification,
    p.copyfrom AS m_product_copyfrom,
    pt.created AS m_product_created,
    pt.createdby AS m_product_createdby,
    p.c_revenuerecognition_id,
    p.c_subscriptiontype_id,
    p.c_taxcategory_id,
    p.c_uom_id AS m_product_c_uom_id,
    p.descriptionurl,
    p.discontinued AS m_product_discontinued,
    p.discontinuedat AS m_product_discontinuedat,
    p.group1,
    p.group2,
    p.guaranteedays,
    p.guaranteedaysmin,
    p.help,
    pt.isactive AS m_product_isactive,
    p.isbom,
    p.isdropship AS m_product_isdropship,
    p.isexcludeautodelivery,
    p.isinvoiceprintdetails,
    p.ispicklistprintdetails,
    p.ispurchased,
    p.isselfservice AS m_product_isselfservice,
    p.issold,
    p.isstocked,
    p.issummary AS m_product_issummary,
    p.isverified,
    p.iswebstorefeatured,
    p.lowlevel,
    p.m_attributeset_id,
    p.m_attributesetinstance_id,
    p.m_freightcategory_id AS m_product_m_freightcategory_id,
    p.m_locator_id,
    p.m_product_category_id AS m_product_product_category_id,
    p.processing AS m_product_processing,
    p.producttype,
    p.r_mailtext_id,
    p.salesrep_id AS m_product_salesrep_id,
    p.s_expensetype_id,
    p.shelfdepth,
    p.shelfheight,
    p.shelfwidth,
    p.s_resource_id,
    p.unitsperpack,
    p.unitsperpallet,
    pt.updated AS m_product_updated,
    pt.updatedby AS m_product_updatedby,
    p.versionno,
    p.volume AS m_product_volume,
    p.weight AS m_product_weight,
    po.ad_org_id AS m_product_po_ad_org_id,
    po.c_bpartner_id AS m_product_po_c_bpartner_id,
    po.c_currency_id AS m_product_po_c_currency_id,
    po.costperorder,
    po.created AS m_product_po_created,
    po.createdby AS m_product_po_createdby,
    po.c_uom_id AS m_product_po_c_uom_id,
    po.deliverytime_actual,
    po.deliverytime_promised,
    po.discontinued AS m_product_po_discontinued,
    po.discontinuedat AS m_product_po_discontinuedat,
    po.isactive AS m_product_po_isactive,
    po.iscurrentvendor,
    po.manufacturer AS m_product_po_manufacturer,
    po.m_product_id AS m_product_po_m_product_id,
    po.order_min,
    po.order_pack,
    po.priceeffective,
    po.pricelastinv,
    po.pricelastpo,
    po.pricelist AS m_product_po_pricelist,
    po.pricepo,
    po.qualityrating AS m_product_po_qualityrating,
    po.royaltyamt,
    po.upc AS m_product_po_upc,
    po.updated AS m_product_po_updated,
    po.updatedby AS m_product_po_updatedby,
    po.vendorcategory AS m_product_po_vendorcategory,
    ra.ad_org_id AS s_resourceassignment_ad_org_id,
    ra.assigndatefrom,
    ra.assigndateto,
    ra.created AS s_resourceassignment_created,
    ra.createdby AS s_resourceassignment_createby,
    ra.isactive AS s_resourceassignment_isactive,
    ra.isconfirmed,
    ra.name AS s_resourceassignment_name,
    ra.qty AS s_resourceassignment_qty,
    ra.s_resource_id AS s_resourceassignment_s_resour,
    ra.updated AS s_resourceassignment_updated,
    ra.updatedby AS s_resourceassignment_updatedby,
    ct.ad_org_id AS c_charge_c_org_id,
    c.c_bpartner_id AS c_charge_c_bpartner_id,
    c.c_chargetype_id,
    c.chargeamt AS c_charge_chargeamt,
    c.c_taxcategory_id AS c_charge_c_taxcategory_id,
    c.description AS c_charge_description,
    ct.isactive AS c_charge_isactive,
    c.issamecurrency,
    c.issametax,
    c.istaxincluded AS c_charge_istaxincluded,
    pp.ad_org_id AS c_bpartner_product_ad_org_id,
    pp.c_bpartner_id AS c_bp_product_c_bpartner_id,
    pp.created AS c_bpartner_product_created,
    pp.createdby AS c_bpartner_product_createdby,
    pp.description AS c_bpartner_product_descriptio,
    pp.isactive AS c_bpartner_product_isactive,
    pp.ismanufacturer,
    pp.manufacturer AS c_bpartner_product_manufactur,
    pp.qualityrating AS c_bpartner_product_qualityrat,
    pp.shelflifemindays,
    pp.shelflifeminpct AS c_bpartner_product_shelflifem,
    pp.updated AS c_bpartner_product_updated,
    pp.updatedby AS c_bpartner_product_updatedby,
    pp.vendorcategory AS c_bpartner_product_vendorcate,
    bp.acqusitioncost,
    bp.actuallifetimevalue,
    bp.ad_language AS c_bpartner_ad_language,
    bp.ad_orgbp_id,
    bp.ad_org_id AS c_bpartner_ad_org_id,
    bp.bpartner_parent_id,
    bp.c_bp_group_id,
    bp.c_dunning_id,
    bp.c_greeting_id,
    bp.c_invoiceschedule_id,
    bp.c_paymentterm_id AS c_bpartner_c_paymentterm_id,
    bp.created AS c_bpartner_created,
    bp.createdby AS c_bpartner_createdby,
    bp.c_taxgroup_id AS c_bpartner_c_taxgroup_id,
    bp.deliveryrule AS c_bpartner_deliveryrule,
    bp.deliveryviarule AS c_bpartner_deliveryviarule,
    bp.description AS c_bpartner_description,
    bp.dunninggrace AS c_bpartner_dunninggrace,
    bp.duns,
    bp.firstsale AS c_bpartner_firstsale,
    bp.flatdiscount AS c_bpartner_flatdiscount,
    bp.freightcostrule AS c_bpartner_freightcostrule,
    bp.invoicerule AS c_bpartner_invoicerule,
    bp.isactive AS c_bpartner_isactive,
    bp.iscustomer,
    bp.isdiscountprinted AS c_bpartner_isdiscountprinted,
    bp.isemployee AS c_bpartner_isemployee,
    bp.ismanufacturer AS c_bpartner_ismanufacturer,
    bp.isonetime,
    bp.ispotaxexempt,
    bp.isprospect,
    bp.issalesrep,
    bp.issummary AS c_bpartner_issummary,
    bp.istaxexempt AS c_bpartner_istaxexempt,
    bp.isvendor,
    bp.logo_id,
    bp.m_discountschema_id,
    bp.m_pricelist_id AS c_bpartner_m_pricelist_id,
    bp.naics,
    bp.name AS c_bpartner_name,
    bp.name2 AS c_bpartner_name2,
    bp.numberemployees,
    bp.paymentrule AS c_bpartner_paymentrule,
    bp.paymentrulepo,
    bp.po_discountschema_id,
    bp.po_paymentterm_id,
    bp.po_pricelist_id,
    bp.poreference AS c_bpartner_poreference,
    bp.potentiallifetimevalue,
    bp.rating AS c_bpartner_rating,
    bp.referenceno AS c_bpartner_referenceno,
    bp.salesrep_id AS c_bpartner_salesrep_id,
    bp.salesvolume,
    bp.sendemail AS c_bpartner_sendemail,
    bp.shareofcustomer,
    bp.shelflifeminpct AS c_bpartner_shelflifeminpct,
    bp.so_creditlimit,
    bp.socreditstatus,
    bp.so_creditused,
    bp.so_description,
    bp.taxid AS c_bpartner_taxid,
    bp.totalopenbalance,
    bp.updated AS c_bpartner_updated,
    bp.updatedby AS c_bpartner_updatedby,
    bp.url AS c_bpartner_url,
    bp.value AS c_bpartner_value,
    bpl.ad_org_id AS c_bpartner_location_ad_org_id,
    bpl.c_bpartner_id AS c_bpartner_location_c_bpartne,
    bpl.created AS c_bpartner_location_created,
    bpl.createdby AS c_bpartner_location_createdby,
    bpl.c_salesregion_id,
    bpl.fax AS c_bpartner_location_fax,
    bpl.isactive AS c_bpartner_location_isactive,
    bpl.isbillto,
    bpl.isdn,
    bpl.ispayfrom,
    bpl.isremitto,
    bpl.isshipto,
    bpl.name AS c_bpartner_location_name,
    bpl.phone AS c_bpartner_location_phone,
    bpl.phone2 AS c_bpartner_location_phone2,
    bpl.updated AS c_bpartner_location_updated,
    bpl.updatedby AS c_bpartner_location_updatedby,
    tt.ad_org_id AS c_tax_ad_org_id,
    t.ad_rule_id,
    t.c_country_id,
    t.c_region_id,
    t.c_taxcategory_id AS c_tax_c_taxcategory_id,
    tt.description AS c_tax_description,
    tt.isactive AS c_tax_isactive,
    t.isdefault AS c_tax_isdefault,
    t.isdocumentlevel,
    t.issalestax,
    t.issummary AS c_tax_issummary,
    t.istaxexempt AS c_tax_istaxexempt,
    tt.name AS c_tax_name,
    t.parent_tax_id,
    t.rate,
    t.requirestaxcertificate,
    t.sopotype,
    t.to_country_id,
    t.to_region_id AS c_tax_to_region_id,
    t.validfrom
   FROM (((((((((((((((c_orderline ol
     JOIN c_uom uom ON ((ol.c_uom_id = uom.c_uom_id)))
     JOIN c_uom_trl uomt ON ((ol.c_uom_id = uomt.c_uom_id)))
     JOIN c_order o ON ((ol.c_order_id = o.c_order_id)))
     LEFT JOIN m_product p ON ((ol.m_product_id = p.m_product_id)))
     LEFT JOIN m_product_trl pt ON (((ol.m_product_id = pt.m_product_id) AND ((uomt.ad_language)::text = (pt.ad_language)::text))))
     LEFT JOIN m_product_po po ON (((p.m_product_id = po.m_product_id) AND (o.c_bpartner_id = po.c_bpartner_id))))
     LEFT JOIN s_resourceassignment ra ON ((ol.s_resourceassignment_id = ra.s_resourceassignment_id)))
     LEFT JOIN c_charge c ON ((ol.c_charge_id = c.c_charge_id)))
     LEFT JOIN c_charge_trl ct ON (((ol.c_charge_id = ct.c_charge_id) AND ((uomt.ad_language)::text = (ct.ad_language)::text))))
     LEFT JOIN c_bpartner_product pp ON (((ol.m_product_id = pp.m_product_id) AND (o.c_bpartner_id = pp.c_bpartner_id))))
     JOIN c_bpartner bp ON ((ol.c_bpartner_id = bp.c_bpartner_id)))
     JOIN c_bpartner_location bpl ON ((ol.c_bpartner_location_id = bpl.c_bpartner_location_id)))
     LEFT JOIN c_tax t ON ((ol.c_tax_id = t.c_tax_id)))
     LEFT JOIN c_tax_trl tt ON (((ol.c_tax_id = tt.c_tax_id) AND ((uomt.ad_language)::text = (tt.ad_language)::text))))
     LEFT JOIN c_currency cur ON ((o.c_currency_id = cur.c_currency_id)))
UNION
 SELECT ol.ad_client_id,
    ol.ad_org_id,
    ol.isactive,
    ol.created,
    ol.createdby,
    ol.updated,
    ol.updatedby,
    uomt.ad_language,
    ol.c_order_id,
    ol.c_orderline_id,
    ol.c_tax_id,
    NULL::character varying AS taxindicator,
    NULL::numeric AS c_bpartner_id,
    NULL::numeric AS c_bpartner_location_id,
    NULL::character varying AS bpname,
    NULL::numeric AS c_location_id,
    (ol.line + (bl.line / (100)::numeric)) AS line,
    pt.m_product_id,
    po.vendorproductno,
        CASE
            WHEN (bl.isqtypercentage = 'N'::bpchar) THEN (ol.qtyordered * bl.qtybom)
            ELSE (ol.qtyordered * (bl.qtybatch / (100)::numeric))
        END AS qtyordered,
        CASE
            WHEN (bl.isqtypercentage = 'N'::bpchar) THEN (ol.qtyentered * bl.qtybom)
            ELSE (ol.qtyentered * (bl.qtybatch / (100)::numeric))
        END AS qtyentered,
    uomt.uomsymbol,
    COALESCE(p.wmv_display_precision, uom.stdprecision, (2)::numeric) AS qtyprecision,
    pt.name,
    bl.description,
    pt.documentnote,
    p.upc,
    p.sku,
    p.value AS productvalue,
    NULL::character varying AS resourcedescription,
    NULL::numeric AS pricelist,
    NULL::numeric AS priceenteredlist,
    NULL::numeric AS discount,
    NULL::numeric AS priceactual,
    NULL::numeric AS priceentered,
    NULL::numeric AS linenetamt,
    pt.description AS productdescription,
    p.imageurl,
    ol.c_campaign_id,
    ol.c_project_id,
    ol.c_activity_id,
    ol.c_projectphase_id,
    ol.c_projecttask_id,
    ol.ad_orgtrx_id AS c_orderline_ad_orgtrx_id,
    ol.c_charge_id AS c_orderline_c_charge_id,
    ol.c_currency_id AS c_orderline_c_currency_id,
    COALESCE(cur.cursymbol, (cur.iso_code)::character varying) AS cursymbol,
    ol.c_uom_id,
    ol.datedelivered,
    ol.dateinvoiced,
    ol.dateordered,
    ol.datepromised AS c_orderline_datepromised,
    ol.freightamt AS c_orderline_freightamt,
    ol.isdescription,
    ol.link_orderline_id,
    ol.m_promotion_id,
    ol.m_shipper_id AS c_orderline_m_shipper_id,
    ol.m_warehouse_id AS c_orderline_m_warehouse_id,
    ol.pricecost,
    ol.pricelimit,
    ol.processed AS c_orderline_processed,
    ol.qtydelivered,
    ol.qtyinvoiced,
    ol.qtylostsales,
    ol.qtyreserved,
    ol.ref_orderline_id,
    ol.rramt,
    ol.rrstartdate,
    ol.s_resourceassignment_id,
    ol.user1_id AS c_orderline_user1_id,
    ol.user2_id AS c_orderline_user2_id,
    uomt.ad_org_id AS c_uom_ad_org_id,
    uom.costingprecision,
    uom.description AS c_uom_description,
    uomt.isactive AS c_uom_isactive,
    uom.isdefault,
    uomt.name AS c_uom_name,
    uom.stdprecision,
    uom.uomtype,
    uom.x12de355,
    o.ad_org_id AS c_order_ad_org_id,
    o.ad_orgtrx_id AS c_order_ad_orgtrx_id,
    o.ad_user_id,
    o.amountrefunded,
    o.amounttendered,
    o.bill_bpartner_id,
    o.bill_location_id,
    o.bill_user_id,
    o.c_activity_id AS c_order_c_activity_id,
    o.c_bpartner_id AS c_order_c_bpartner_id,
    o.c_campaign_id AS c_order_c_campaign_id,
    o.c_cashline_id,
    o.c_cashplanline_id,
    o.c_charge_id AS c_order_c_charge_id,
    o.c_conversiontype_id,
    o.c_currency_id AS c_order_c_currency_id,
    o.c_doctype_id,
    o.c_doctypetarget_id,
    o.chargeamt,
    o.copyfrom,
    o.c_payment_id,
    o.c_paymentterm_id,
    o.c_pos_id,
    o.c_project_id AS c_order_c_project_id,
    o.created AS c_order_created,
    o.createdby AS c_order_createdby,
    o.dateacct,
    o.dateprinted,
    o.datepromised AS c_order_datepromised,
    o.deliveryrule,
    o.deliveryviarule,
    o.description AS c_order_description,
    o.docaction,
    o.docstatus,
    o.documentno,
    o.dropship_bpartner_id,
    o.dropship_location_id,
    o.dropship_user_id,
    o.freightamt AS c_order_freightamt,
    o.freightcostrule,
    o.grandtotal,
    o.invoicerule,
    o.isactive AS c_order_isactive,
    o.isapproved,
    o.iscreditapproved,
    o.isdelivered,
    o.isdiscountprinted AS c_order_isdiscountprinted,
    o.isdropship AS c_order_isdropship,
    o.isinvoiced,
    o.ispayschedulevalid,
    o.isprinted,
    o.isselected,
    o.isselfservice AS c_order_isselfservice,
    o.issotrx,
    o.istaxincluded,
    o.istransferred,
    o.link_order_id,
    o.m_freightcategory_id AS c_order_m_freightcategory_id,
    o.m_pricelist_id AS c_order_m_pricelist_id,
    o.m_shipper_id AS c_order_m_shipper_id,
    o.m_warehouse_id AS c_order_m_warehouse_id,
    o.ordertype,
    o.pay_bpartner_id,
    o.pay_location_id,
    o.paymentrule AS c_order_paymentrule,
    o.poreference,
    o.posted,
    o.priorityrule,
    o.processed AS c_order_processed,
    o.processedon,
    o.promotioncode,
    o.ref_order_id,
    o.salesrep_id,
    o.sendemail AS c_order_sendemail,
    o.totallines,
    o.updated AS c_order_updated,
    o.updatedby AS c_order_updatedby,
    o.user1_id AS c_order_user1_id,
    o.user2_id AS c_order_user2_id,
    o.volume AS c_order_volume,
    o.weight AS c_order_weight,
    pt.ad_org_id AS m_product_ad_org_id,
    p.classification,
    p.copyfrom AS m_product_copyfrom,
    pt.created AS m_product_created,
    pt.createdby AS m_product_createdby,
    p.c_revenuerecognition_id,
    p.c_subscriptiontype_id,
    p.c_taxcategory_id,
    p.c_uom_id AS m_product_c_uom_id,
    p.descriptionurl,
    p.discontinued AS m_product_discontinued,
    p.discontinuedat AS m_product_discontinuedat,
    p.group1,
    p.group2,
    p.guaranteedays,
    p.guaranteedaysmin,
    p.help,
    pt.isactive AS m_product_isactive,
    p.isbom,
    p.isdropship AS m_product_isdropship,
    p.isexcludeautodelivery,
    p.isinvoiceprintdetails,
    p.ispicklistprintdetails,
    p.ispurchased,
    p.isselfservice AS m_product_isselfservice,
    p.issold,
    p.isstocked,
    p.issummary AS m_product_issummary,
    p.isverified,
    p.iswebstorefeatured,
    p.lowlevel,
    p.m_attributeset_id,
    p.m_attributesetinstance_id,
    p.m_freightcategory_id AS m_product_m_freightcategory_id,
    p.m_locator_id,
    p.m_product_category_id AS m_product_product_category_id,
    p.processing AS m_product_processing,
    p.producttype,
    p.r_mailtext_id,
    p.salesrep_id AS m_product_salesrep_id,
    p.s_expensetype_id,
    p.shelfdepth,
    p.shelfheight,
    p.shelfwidth,
    p.s_resource_id,
    p.unitsperpack,
    p.unitsperpallet,
    p.updated AS m_product_updated,
    p.updatedby AS m_product_updatedby,
    p.versionno,
    p.volume AS m_product_volume,
    p.weight AS m_product_weight,
    po.ad_org_id AS m_product_po_ad_org_id,
    po.c_bpartner_id AS m_product_po_c_bpartner_id,
    po.c_currency_id AS m_product_po_c_currency_id,
    po.costperorder,
    po.created AS m_product_po_created,
    po.createdby AS m_product_po_createdby,
    po.c_uom_id AS m_product_po_c_uom_id,
    po.deliverytime_actual,
    po.deliverytime_promised,
    po.discontinued AS m_product_po_discontinued,
    po.discontinuedat AS m_product_po_discontinuedat,
    po.isactive AS m_product_po_isactive,
    po.iscurrentvendor,
    po.manufacturer AS m_product_po_manufacturer,
    po.m_product_id AS m_product_po_m_product_id,
    po.order_min,
    po.order_pack,
    po.priceeffective,
    po.pricelastinv,
    po.pricelastpo,
    po.pricelist AS m_product_po_pricelist,
    po.pricepo,
    po.qualityrating AS m_product_po_qualityrating,
    po.royaltyamt,
    po.upc AS m_product_po_upc,
    po.updated AS m_product_po_updated,
    po.updatedby AS m_product_po_updatedby,
    po.vendorcategory AS m_product_po_vendorcategory,
    NULL::numeric AS s_resourceassignment_ad_org_id,
    NULL::timestamp without time zone AS assigndatefrom,
    NULL::timestamp without time zone AS assigndateto,
    NULL::timestamp without time zone AS s_resourceassignment_created,
    NULL::numeric AS s_resourceassignment_createby,
    NULL::bpchar AS s_resourceassignment_isactive,
    NULL::bpchar AS isconfirmed,
    NULL::character varying AS s_resourceassignment_name,
    NULL::numeric AS s_resourceassignment_qty,
    NULL::numeric AS s_resourceassignment_s_resour,
    NULL::timestamp without time zone AS s_resourceassignment_updated,
    NULL::numeric AS s_resourceassignment_updatedby,
    NULL::numeric AS c_charge_c_org_id,
    NULL::numeric AS c_charge_c_bpartner_id,
    NULL::numeric AS c_chargetype_id,
    NULL::numeric AS c_charge_chargeamt,
    NULL::numeric AS c_charge_c_taxcategory_id,
    NULL::character varying AS c_charge_description,
    NULL::bpchar AS c_charge_isactive,
    NULL::bpchar AS issamecurrency,
    NULL::bpchar AS issametax,
    NULL::bpchar AS c_charge_istaxincluded,
    NULL::numeric AS c_bpartner_product_ad_org_id,
    NULL::numeric AS c_bp_product_c_bpartner_id,
    NULL::timestamp without time zone AS c_bpartner_product_created,
    NULL::numeric AS c_bpartner_product_createdby,
    NULL::character varying AS c_bpartner_product_descriptio,
    NULL::bpchar AS c_bpartner_product_isactive,
    NULL::bpchar AS ismanufacturer,
    NULL::character varying AS c_bpartner_product_manufactur,
    NULL::numeric AS c_bpartner_product_qualityrat,
    NULL::numeric AS shelflifemindays,
    NULL::numeric AS c_bpartner_product_shelflifem,
    NULL::timestamp without time zone AS c_bpartner_product_updated,
    NULL::numeric AS c_bpartner_product_updatedby,
    NULL::character varying AS c_bpartner_product_vendorcate,
    NULL::numeric AS acqusitioncost,
    NULL::numeric AS actuallifetimevalue,
    NULL::character varying AS c_bpartner_ad_language,
    NULL::numeric AS ad_orgbp_id,
    NULL::numeric AS c_bpartner_ad_org_id,
    NULL::numeric AS bpartner_parent_id,
    NULL::numeric AS c_bp_group_id,
    NULL::numeric AS c_dunning_id,
    NULL::numeric AS c_greeting_id,
    NULL::numeric AS c_invoiceschedule_id,
    NULL::numeric AS c_bpartner_c_paymentterm_id,
    NULL::timestamp without time zone AS c_bpartner_created,
    NULL::numeric AS c_bpartner_createdby,
    NULL::numeric AS c_bpartner_c_taxgroup_id,
    NULL::bpchar AS c_bpartner_deliveryrule,
    NULL::bpchar AS c_bpartner_deliveryviarule,
    NULL::character varying AS c_bpartner_description,
    NULL::date AS c_bpartner_dunninggrace,
    NULL::bpchar AS duns,
    NULL::timestamp without time zone AS c_bpartner_firstsale,
    NULL::numeric AS c_bpartner_flatdiscount,
    NULL::bpchar AS c_bpartner_freightcostrule,
    NULL::bpchar AS c_bpartner_invoicerule,
    NULL::bpchar AS c_bpartner_isactive,
    NULL::bpchar AS iscustomer,
    NULL::bpchar AS c_bpartner_isdiscountprinted,
    NULL::bpchar AS c_bpartner_isemployee,
    NULL::bpchar AS c_bpartner_ismanufacturer,
    NULL::bpchar AS isonetime,
    NULL::bpchar AS ispotaxexempt,
    NULL::bpchar AS isprospect,
    NULL::bpchar AS issalesrep,
    NULL::bpchar AS c_bpartner_issummary,
    NULL::bpchar AS c_bpartner_istaxexempt,
    NULL::bpchar AS isvendor,
    NULL::numeric AS logo_id,
    NULL::numeric AS m_discountschema_id,
    NULL::numeric AS c_bpartner_m_pricelist_id,
    NULL::bpchar AS naics,
    NULL::character varying AS c_bpartner_name,
    NULL::character varying AS c_bpartner_name2,
    NULL::numeric AS numberemployees,
    NULL::bpchar AS c_bpartner_paymentrule,
    NULL::bpchar AS paymentrulepo,
    NULL::numeric AS po_discountschema_id,
    NULL::numeric AS po_paymentterm_id,
    NULL::numeric AS po_pricelist_id,
    NULL::character varying AS c_bpartner_poreference,
    NULL::numeric AS potentiallifetimevalue,
    NULL::bpchar AS c_bpartner_rating,
    NULL::character varying AS c_bpartner_referenceno,
    NULL::numeric AS c_bpartner_salesrep_id,
    NULL::numeric AS salesvolume,
    NULL::bpchar AS c_bpartner_sendemail,
    NULL::numeric AS shareofcustomer,
    NULL::numeric AS c_bpartner_shelflifeminpct,
    NULL::numeric AS so_creditlimit,
    NULL::bpchar AS socreditstatus,
    NULL::numeric AS so_creditused,
    NULL::character varying AS so_description,
    NULL::character varying AS c_bpartner_taxid,
    NULL::numeric AS totalopenbalance,
    NULL::timestamp without time zone AS c_bpartner_updated,
    NULL::numeric AS c_bpartner_updatedby,
    NULL::character varying AS c_bpartner_url,
    NULL::character varying AS c_bpartner_value,
    NULL::numeric AS c_bpartner_location_ad_org_id,
    NULL::numeric AS c_bpartner_location_c_bpartne,
    NULL::timestamp without time zone AS c_bpartner_location_created,
    NULL::numeric AS c_bpartner_location_createdby,
    NULL::numeric AS c_salesregion_id,
    NULL::character varying AS c_bpartner_location_fax,
    NULL::bpchar AS c_bpartner_location_isactive,
    NULL::bpchar AS isbillto,
    NULL::character varying AS isdn,
    NULL::bpchar AS ispayfrom,
    NULL::bpchar AS isremitto,
    NULL::bpchar AS isshipto,
    NULL::character varying AS c_bpartner_location_name,
    NULL::character varying AS c_bpartner_location_phone,
    NULL::character varying AS c_bpartner_location_phone2,
    NULL::timestamp without time zone AS c_bpartner_location_updated,
    NULL::numeric AS c_bpartner_location_updatedby,
    NULL::numeric AS c_tax_ad_org_id,
    NULL::numeric AS ad_rule_id,
    NULL::numeric AS c_country_id,
    NULL::numeric AS c_region_id,
    NULL::numeric AS c_tax_c_taxcategory_id,
    NULL::character varying AS c_tax_description,
    NULL::bpchar AS c_tax_isactive,
    NULL::bpchar AS c_tax_isdefault,
    NULL::bpchar AS isdocumentlevel,
    NULL::bpchar AS issalestax,
    NULL::bpchar AS c_tax_issummary,
    NULL::bpchar AS c_tax_istaxexempt,
    NULL::character varying AS c_tax_name,
    NULL::numeric AS parent_tax_id,
    NULL::numeric AS rate,
    NULL::bpchar AS requirestaxcertificate,
    NULL::bpchar AS sopotype,
    NULL::numeric AS to_country_id,
    NULL::numeric AS c_tax_to_region_id,
    NULL::timestamp without time zone AS validfrom
   FROM ((((((((((pp_product_bom b
     JOIN c_orderline ol ON ((b.m_product_id = ol.m_product_id)))
     JOIN c_order o ON ((ol.c_order_id = o.c_order_id)))
     JOIN m_product bp ON (((bp.m_product_id = ol.m_product_id) AND (bp.isbom = 'Y'::bpchar) AND (bp.isverified = 'Y'::bpchar) AND (bp.isinvoiceprintdetails = 'Y'::bpchar))))
     JOIN pp_product_bomline bl ON ((bl.pp_product_bom_id = b.pp_product_bom_id)))
     JOIN m_product p ON ((p.m_product_id = bl.m_product_id)))
     LEFT JOIN m_product_po po ON (((p.m_product_id = po.m_product_id) AND (o.c_bpartner_id = po.c_bpartner_id))))
     JOIN c_uom uom ON ((ol.c_uom_id = uom.c_uom_id)))
     JOIN c_uom_trl uomt ON ((p.c_uom_id = uomt.c_uom_id)))
     JOIN m_product_trl pt ON (((pt.m_product_id = bl.m_product_id) AND ((uomt.ad_language)::text = (pt.ad_language)::text))))
     LEFT JOIN c_currency cur ON ((o.c_currency_id = cur.c_currency_id)))
UNION
 SELECT o.ad_client_id,
    o.ad_org_id,
    o.isactive,
    o.created,
    o.createdby,
    o.updated,
    o.updatedby,
    l.ad_language,
    o.c_order_id,
    NULL::numeric AS c_orderline_id,
    NULL::numeric AS c_tax_id,
    NULL::character varying AS taxindicator,
    NULL::numeric AS c_bpartner_id,
    NULL::numeric AS c_bpartner_location_id,
    NULL::character varying AS bpname,
    NULL::numeric AS c_location_id,
    NULL::numeric AS line,
    NULL::numeric AS m_product_id,
    NULL::character varying AS vendorproductno,
    NULL::numeric AS qtyordered,
    NULL::numeric AS qtyentered,
    NULL::character varying AS uomsymbol,
    NULL::integer AS qtyprecision,
    NULL::character varying AS name,
    NULL::character varying AS description,
    NULL::character varying AS documentnote,
    NULL::character varying AS upc,
    NULL::character varying AS sku,
    NULL::character varying AS productvalue,
    NULL::character varying AS resourcedescription,
    NULL::numeric AS pricelist,
    NULL::numeric AS priceenteredlist,
    NULL::numeric AS discount,
    NULL::numeric AS priceactual,
    NULL::numeric AS priceentered,
    NULL::numeric AS linenetamt,
    NULL::character varying AS productdescription,
    NULL::character varying AS imageurl,
    NULL::numeric AS c_campaign_id,
    NULL::numeric AS c_project_id,
    NULL::numeric AS c_activity_id,
    NULL::numeric AS c_projectphase_id,
    NULL::numeric AS c_projecttask_id,
    NULL::numeric AS c_orderline_ad_orgtrx_id,
    NULL::numeric AS c_orderline_c_charge_id,
    NULL::numeric AS c_orderline_c_currency_id,
    NULL::character varying AS cursymbol,
    NULL::numeric AS c_uom_id,
    NULL::timestamp without time zone AS datedelivered,
    NULL::timestamp without time zone AS dateinvoiced,
    NULL::timestamp without time zone AS dateordered,
    NULL::timestamp without time zone AS c_orderline_datepromised,
    NULL::numeric AS c_orderline_freightamt,
    NULL::bpchar AS isdescription,
    NULL::numeric AS link_orderline_id,
    NULL::numeric AS m_promotion_id,
    NULL::numeric AS c_orderline_m_shipper_id,
    NULL::numeric AS c_orderline_m_warehouse_id,
    NULL::numeric AS pricecost,
    NULL::numeric AS pricelimit,
    NULL::bpchar AS c_orderline_processed,
    NULL::numeric AS qtydelivered,
    NULL::numeric AS qtyinvoiced,
    NULL::numeric AS qtylostsales,
    NULL::numeric AS qtyreserved,
    NULL::numeric AS ref_orderline_id,
    NULL::numeric AS rramt,
    NULL::timestamp without time zone AS rrstartdate,
    NULL::numeric AS s_resourceassignment_id,
    NULL::numeric AS c_orderline_user1_id,
    NULL::numeric AS c_orderline_user2_id,
    NULL::numeric AS c_uom_ad_org_id,
    NULL::numeric AS costingprecision,
    NULL::character varying AS c_uom_description,
    NULL::bpchar AS c_uom_isactive,
    NULL::bpchar AS isdefault,
    NULL::character varying AS c_uom_name,
    NULL::numeric AS stdprecision,
    NULL::character varying AS uomtype,
    NULL::character varying AS x12de355,
    NULL::numeric AS c_order_ad_org_id,
    NULL::numeric AS c_order_ad_orgtrx_id,
    NULL::numeric AS ad_user_id,
    NULL::numeric AS amountrefunded,
    NULL::numeric AS amounttendered,
    NULL::numeric AS bill_bpartner_id,
    NULL::numeric AS bill_location_id,
    NULL::numeric AS bill_user_id,
    NULL::numeric AS c_order_c_activity_id,
    NULL::numeric AS c_order_c_bpartner_id,
    NULL::numeric AS c_order_c_campaign_id,
    NULL::numeric AS c_cashline_id,
    NULL::numeric AS c_cashplanline_id,
    NULL::numeric AS c_order_c_charge_id,
    NULL::numeric AS c_conversiontype_id,
    NULL::numeric AS c_order_c_currency_id,
    NULL::numeric AS c_doctype_id,
    NULL::numeric AS c_doctypetarget_id,
    NULL::numeric AS chargeamt,
    NULL::bpchar AS copyfrom,
    NULL::numeric AS c_payment_id,
    NULL::numeric AS c_paymentterm_id,
    NULL::numeric AS c_pos_id,
    NULL::numeric AS c_order_c_project_id,
    NULL::timestamp without time zone AS c_order_created,
    NULL::numeric AS c_order_createdby,
    NULL::timestamp without time zone AS dateacct,
    NULL::timestamp without time zone AS dateprinted,
    NULL::timestamp without time zone AS c_order_datepromised,
    NULL::bpchar AS deliveryrule,
    NULL::bpchar AS deliveryviarule,
    NULL::character varying AS c_order_description,
    NULL::bpchar AS docaction,
    NULL::bpchar AS docstatus,
    NULL::character varying AS documentno,
    NULL::numeric AS dropship_bpartner_id,
    NULL::numeric AS dropship_location_id,
    NULL::numeric AS dropship_user_id,
    NULL::numeric AS c_order_freightamt,
    NULL::bpchar AS freightcostrule,
    NULL::numeric AS grandtotal,
    NULL::bpchar AS invoicerule,
    NULL::bpchar AS c_order_isactive,
    NULL::bpchar AS isapproved,
    NULL::bpchar AS iscreditapproved,
    NULL::bpchar AS isdelivered,
    NULL::bpchar AS c_order_isdiscountprinted,
    NULL::bpchar AS c_order_isdropship,
    NULL::bpchar AS isinvoiced,
    NULL::bpchar AS ispayschedulevalid,
    NULL::bpchar AS isprinted,
    NULL::bpchar AS isselected,
    NULL::bpchar AS c_order_isselfservice,
    NULL::bpchar AS issotrx,
    NULL::bpchar AS istaxincluded,
    NULL::bpchar AS istransferred,
    NULL::numeric AS link_order_id,
    NULL::numeric AS c_order_m_freightcategory_id,
    NULL::numeric AS c_order_m_pricelist_id,
    NULL::numeric AS c_order_m_shipper_id,
    NULL::numeric AS c_order_m_warehouse_id,
    NULL::character varying AS ordertype,
    NULL::numeric AS pay_bpartner_id,
    NULL::numeric AS pay_location_id,
    NULL::bpchar AS c_order_paymentrule,
    NULL::character varying AS poreference,
    NULL::bpchar AS posted,
    NULL::bpchar AS priorityrule,
    NULL::bpchar AS c_order_processed,
    NULL::numeric AS processedon,
    NULL::character varying AS promotioncode,
    NULL::numeric AS ref_order_id,
    NULL::numeric AS salesrep_id,
    NULL::bpchar AS c_order_sendemail,
    NULL::numeric AS totallines,
    NULL::timestamp without time zone AS c_order_updated,
    NULL::numeric AS c_order_updatedby,
    NULL::numeric AS c_order_user1_id,
    NULL::numeric AS c_order_user2_id,
    NULL::numeric AS c_order_volume,
    NULL::numeric AS c_order_weight,
    NULL::numeric AS m_product_ad_org_id,
    NULL::character varying AS classification,
    NULL::bpchar AS m_product_copyfrom,
    NULL::timestamp without time zone AS m_product_created,
    NULL::numeric AS m_product_createdby,
    NULL::numeric AS c_revenuerecognition_id,
    NULL::numeric AS c_subscriptiontype_id,
    NULL::numeric AS c_taxcategory_id,
    NULL::numeric AS m_product_c_uom_id,
    NULL::character varying AS descriptionurl,
    NULL::bpchar AS m_product_discontinued,
    NULL::timestamp without time zone AS m_product_discontinuedat,
    NULL::character varying AS group1,
    NULL::character varying AS group2,
    NULL::numeric AS guaranteedays,
    NULL::numeric AS guaranteedaysmin,
    NULL::character varying AS help,
    NULL::bpchar AS m_product_isactive,
    NULL::bpchar AS isbom,
    NULL::bpchar AS m_product_isdropship,
    NULL::bpchar AS isexcludeautodelivery,
    NULL::bpchar AS isinvoiceprintdetails,
    NULL::bpchar AS ispicklistprintdetails,
    NULL::bpchar AS ispurchased,
    NULL::bpchar AS m_product_isselfservice,
    NULL::bpchar AS issold,
    NULL::bpchar AS isstocked,
    NULL::bpchar AS m_product_issummary,
    NULL::bpchar AS isverified,
    NULL::bpchar AS iswebstorefeatured,
    NULL::numeric AS lowlevel,
    NULL::numeric AS m_attributeset_id,
    NULL::numeric AS m_attributesetinstance_id,
    NULL::numeric AS m_product_m_freightcategory_id,
    NULL::numeric AS m_locator_id,
    NULL::numeric AS m_product_product_category_id,
    NULL::bpchar AS m_product_processing,
    NULL::bpchar AS producttype,
    NULL::numeric AS r_mailtext_id,
    NULL::numeric AS m_product_salesrep_id,
    NULL::numeric AS s_expensetype_id,
    NULL::numeric AS shelfdepth,
    NULL::numeric AS shelfheight,
    NULL::numeric AS shelfwidth,
    NULL::numeric AS s_resource_id,
    NULL::numeric AS unitsperpack,
    NULL::numeric AS unitsperpallet,
    NULL::timestamp without time zone AS m_product_updated,
    NULL::numeric AS m_product_updatedby,
    NULL::character varying AS versionno,
    NULL::numeric AS m_product_volume,
    NULL::numeric AS m_product_weight,
    NULL::numeric AS m_product_po_ad_org_id,
    NULL::numeric AS m_product_po_c_bpartner_id,
    NULL::numeric AS m_product_po_c_currency_id,
    NULL::numeric AS costperorder,
    NULL::timestamp without time zone AS m_product_po_created,
    NULL::numeric AS m_product_po_createdby,
    NULL::numeric AS m_product_po_c_uom_id,
    NULL::numeric AS deliverytime_actual,
    NULL::numeric AS deliverytime_promised,
    NULL::bpchar AS m_product_po_discontinued,
    NULL::timestamp without time zone AS m_product_po_discontinuedat,
    NULL::bpchar AS m_product_po_isactive,
    NULL::bpchar AS iscurrentvendor,
    NULL::bpchar AS m_product_po_manufacturer,
    NULL::numeric AS m_product_po_m_product_id,
    NULL::numeric AS order_min,
    NULL::numeric AS order_pack,
    NULL::timestamp without time zone AS priceeffective,
    NULL::numeric AS pricelastinv,
    NULL::numeric AS pricelastpo,
    NULL::numeric AS m_product_po_pricelist,
    NULL::numeric AS pricepo,
    NULL::numeric AS m_product_po_qualityrating,
    NULL::numeric AS royaltyamt,
    NULL::character varying AS m_product_po_upc,
    NULL::timestamp without time zone AS m_product_po_updated,
    NULL::numeric AS m_product_po_updatedby,
    NULL::bpchar AS m_product_po_vendorcategory,
    NULL::numeric AS s_resourceassignment_ad_org_id,
    NULL::timestamp without time zone AS assigndatefrom,
    NULL::timestamp without time zone AS assigndateto,
    NULL::timestamp without time zone AS s_resourceassignment_created,
    NULL::numeric AS s_resourceassignment_createby,
    NULL::bpchar AS s_resourceassignment_isactive,
    NULL::bpchar AS isconfirmed,
    NULL::character varying AS s_resourceassignment_name,
    NULL::numeric AS s_resourceassignment_qty,
    NULL::numeric AS s_resourceassignment_s_resour,
    NULL::timestamp without time zone AS s_resourceassignment_updated,
    NULL::numeric AS s_resourceassignment_updatedby,
    NULL::numeric AS c_charge_c_org_id,
    NULL::numeric AS c_charge_c_bpartner_id,
    NULL::numeric AS c_chargetype_id,
    NULL::numeric AS c_charge_chargeamt,
    NULL::numeric AS c_charge_c_taxcategory_id,
    NULL::character varying AS c_charge_description,
    NULL::bpchar AS c_charge_isactive,
    NULL::bpchar AS issamecurrency,
    NULL::bpchar AS issametax,
    NULL::bpchar AS c_charge_istaxincluded,
    NULL::numeric AS c_bpartner_product_ad_org_id,
    NULL::numeric AS c_bp_product_c_bpartner_id,
    NULL::timestamp without time zone AS c_bpartner_product_created,
    NULL::numeric AS c_bpartner_product_createdby,
    NULL::character varying AS c_bpartner_product_descriptio,
    NULL::bpchar AS c_bpartner_product_isactive,
    NULL::bpchar AS ismanufacturer,
    NULL::character varying AS c_bpartner_product_manufactur,
    NULL::numeric AS c_bpartner_product_qualityrat,
    NULL::numeric AS shelflifemindays,
    NULL::numeric AS c_bpartner_product_shelflifem,
    NULL::timestamp without time zone AS c_bpartner_product_updated,
    NULL::numeric AS c_bpartner_product_updatedby,
    NULL::character varying AS c_bpartner_product_vendorcate,
    NULL::numeric AS acqusitioncost,
    NULL::numeric AS actuallifetimevalue,
    NULL::character varying AS c_bpartner_ad_language,
    NULL::numeric AS ad_orgbp_id,
    NULL::numeric AS c_bpartner_ad_org_id,
    NULL::numeric AS bpartner_parent_id,
    NULL::numeric AS c_bp_group_id,
    NULL::numeric AS c_dunning_id,
    NULL::numeric AS c_greeting_id,
    NULL::numeric AS c_invoiceschedule_id,
    NULL::numeric AS c_bpartner_c_paymentterm_id,
    NULL::timestamp without time zone AS c_bpartner_created,
    NULL::numeric AS c_bpartner_createdby,
    NULL::numeric AS c_bpartner_c_taxgroup_id,
    NULL::bpchar AS c_bpartner_deliveryrule,
    NULL::bpchar AS c_bpartner_deliveryviarule,
    NULL::character varying AS c_bpartner_description,
    NULL::date AS c_bpartner_dunninggrace,
    NULL::bpchar AS duns,
    NULL::timestamp without time zone AS c_bpartner_firstsale,
    NULL::numeric AS c_bpartner_flatdiscount,
    NULL::bpchar AS c_bpartner_freightcostrule,
    NULL::bpchar AS c_bpartner_invoicerule,
    NULL::bpchar AS c_bpartner_isactive,
    NULL::bpchar AS iscustomer,
    NULL::bpchar AS c_bpartner_isdiscountprinted,
    NULL::bpchar AS c_bpartner_isemployee,
    NULL::bpchar AS c_bpartner_ismanufacturer,
    NULL::bpchar AS isonetime,
    NULL::bpchar AS ispotaxexempt,
    NULL::bpchar AS isprospect,
    NULL::bpchar AS issalesrep,
    NULL::bpchar AS c_bpartner_issummary,
    NULL::bpchar AS c_bpartner_istaxexempt,
    NULL::bpchar AS isvendor,
    NULL::numeric AS logo_id,
    NULL::numeric AS m_discountschema_id,
    NULL::numeric AS c_bpartner_m_pricelist_id,
    NULL::bpchar AS naics,
    NULL::character varying AS c_bpartner_name,
    NULL::character varying AS c_bpartner_name2,
    NULL::numeric AS numberemployees,
    NULL::bpchar AS c_bpartner_paymentrule,
    NULL::bpchar AS paymentrulepo,
    NULL::numeric AS po_discountschema_id,
    NULL::numeric AS po_paymentterm_id,
    NULL::numeric AS po_pricelist_id,
    NULL::character varying AS c_bpartner_poreference,
    NULL::numeric AS potentiallifetimevalue,
    NULL::bpchar AS c_bpartner_rating,
    NULL::character varying AS c_bpartner_referenceno,
    NULL::numeric AS c_bpartner_salesrep_id,
    NULL::numeric AS salesvolume,
    NULL::bpchar AS c_bpartner_sendemail,
    NULL::numeric AS shareofcustomer,
    NULL::numeric AS c_bpartner_shelflifeminpct,
    NULL::numeric AS so_creditlimit,
    NULL::bpchar AS socreditstatus,
    NULL::numeric AS so_creditused,
    NULL::character varying AS so_description,
    NULL::character varying AS c_bpartner_taxid,
    NULL::numeric AS totalopenbalance,
    NULL::timestamp without time zone AS c_bpartner_updated,
    NULL::numeric AS c_bpartner_updatedby,
    NULL::character varying AS c_bpartner_url,
    NULL::character varying AS c_bpartner_value,
    NULL::numeric AS c_bpartner_location_ad_org_id,
    NULL::numeric AS c_bpartner_location_c_bpartne,
    NULL::timestamp without time zone AS c_bpartner_location_created,
    NULL::numeric AS c_bpartner_location_createdby,
    NULL::numeric AS c_salesregion_id,
    NULL::character varying AS c_bpartner_location_fax,
    NULL::bpchar AS c_bpartner_location_isactive,
    NULL::bpchar AS isbillto,
    NULL::character varying AS isdn,
    NULL::bpchar AS ispayfrom,
    NULL::bpchar AS isremitto,
    NULL::bpchar AS isshipto,
    NULL::character varying AS c_bpartner_location_name,
    NULL::character varying AS c_bpartner_location_phone,
    NULL::character varying AS c_bpartner_location_phone2,
    NULL::timestamp without time zone AS c_bpartner_location_updated,
    NULL::numeric AS c_bpartner_location_updatedby,
    NULL::numeric AS c_tax_ad_org_id,
    NULL::numeric AS ad_rule_id,
    NULL::numeric AS c_country_id,
    NULL::numeric AS c_region_id,
    NULL::numeric AS c_tax_c_taxcategory_id,
    NULL::character varying AS c_tax_description,
    NULL::bpchar AS c_tax_isactive,
    NULL::bpchar AS c_tax_isdefault,
    NULL::bpchar AS isdocumentlevel,
    NULL::bpchar AS issalestax,
    NULL::bpchar AS c_tax_issummary,
    NULL::bpchar AS c_tax_istaxexempt,
    NULL::character varying AS c_tax_name,
    NULL::numeric AS parent_tax_id,
    NULL::numeric AS rate,
    NULL::bpchar AS requirestaxcertificate,
    NULL::bpchar AS sopotype,
    NULL::numeric AS to_country_id,
    NULL::numeric AS c_tax_to_region_id,
    NULL::timestamp without time zone AS validfrom
   FROM c_order o,
    ad_language l
  WHERE ((l.isbaselanguage = 'N'::bpchar) AND (l.issystemlanguage = 'Y'::bpchar))
UNION
 SELECT ot.ad_client_id,
    ot.ad_org_id,
    ot.isactive,
    ot.created,
    ot.createdby,
    ot.updated,
    ot.updatedby,
    tt.ad_language,
    ot.c_order_id,
    NULL::numeric AS c_orderline_id,
    ot.c_tax_id,
    tt.taxindicator,
    NULL::numeric AS c_bpartner_id,
    NULL::numeric AS c_bpartner_location_id,
    NULL::character varying AS bpname,
    NULL::numeric AS c_location_id,
    NULL::numeric AS line,
    NULL::numeric AS m_product_id,
    NULL::character varying AS vendorproductno,
    NULL::numeric AS qtyordered,
    NULL::numeric AS qtyentered,
    NULL::character varying AS uomsymbol,
    NULL::integer AS qtyprecision,
    tt.name,
    NULL::character varying AS description,
    NULL::character varying AS documentnote,
    NULL::character varying AS upc,
    NULL::character varying AS sku,
    NULL::character varying AS productvalue,
    NULL::character varying AS resourcedescription,
    NULL::numeric AS pricelist,
    NULL::numeric AS priceenteredlist,
    NULL::numeric AS discount,
        CASE
            WHEN (ot.istaxincluded = 'Y'::bpchar) THEN ot.taxamt
            ELSE ot.taxbaseamt
        END AS priceactual,
        CASE
            WHEN (ot.istaxincluded = 'Y'::bpchar) THEN ot.taxamt
            ELSE ot.taxbaseamt
        END AS priceentered,
        CASE
            WHEN (ot.istaxincluded = 'Y'::bpchar) THEN NULL::numeric
            ELSE ot.taxamt
        END AS linenetamt,
    NULL::character varying AS productdescription,
    NULL::character varying AS imageurl,
    NULL::numeric AS c_campaign_id,
    NULL::numeric AS c_project_id,
    NULL::numeric AS c_activity_id,
    NULL::numeric AS c_projectphase_id,
    NULL::numeric AS c_projecttask_id,
    NULL::numeric AS c_orderline_ad_orgtrx_id,
    NULL::numeric AS c_orderline_c_charge_id,
    NULL::numeric AS c_orderline_c_currency_id,
    NULL::character varying AS cursymbol,
    NULL::numeric AS c_uom_id,
    NULL::timestamp without time zone AS datedelivered,
    NULL::timestamp without time zone AS dateinvoiced,
    NULL::timestamp without time zone AS dateordered,
    NULL::timestamp without time zone AS c_orderline_datepromised,
    NULL::numeric AS c_orderline_freightamt,
    NULL::bpchar AS isdescription,
    NULL::numeric AS link_orderline_id,
    NULL::numeric AS m_promotion_id,
    NULL::numeric AS c_orderline_m_shipper_id,
    NULL::numeric AS c_orderline_m_warehouse_id,
    NULL::numeric AS pricecost,
    NULL::numeric AS pricelimit,
    NULL::bpchar AS c_orderline_processed,
    NULL::numeric AS qtydelivered,
    NULL::numeric AS qtyinvoiced,
    NULL::numeric AS qtylostsales,
    NULL::numeric AS qtyreserved,
    NULL::numeric AS ref_orderline_id,
    NULL::numeric AS rramt,
    NULL::timestamp without time zone AS rrstartdate,
    NULL::numeric AS s_resourceassignment_id,
    NULL::numeric AS c_orderline_user1_id,
    NULL::numeric AS c_orderline_user2_id,
    NULL::numeric AS c_uom_ad_org_id,
    NULL::numeric AS costingprecision,
    NULL::character varying AS c_uom_description,
    NULL::bpchar AS c_uom_isactive,
    NULL::bpchar AS isdefault,
    NULL::character varying AS c_uom_name,
    NULL::numeric AS stdprecision,
    NULL::character varying AS uomtype,
    NULL::character varying AS x12de355,
    NULL::numeric AS c_order_ad_org_id,
    NULL::numeric AS c_order_ad_orgtrx_id,
    NULL::numeric AS ad_user_id,
    NULL::numeric AS amountrefunded,
    NULL::numeric AS amounttendered,
    NULL::numeric AS bill_bpartner_id,
    NULL::numeric AS bill_location_id,
    NULL::numeric AS bill_user_id,
    NULL::numeric AS c_order_c_activity_id,
    NULL::numeric AS c_order_c_bpartner_id,
    NULL::numeric AS c_order_c_campaign_id,
    NULL::numeric AS c_cashline_id,
    NULL::numeric AS c_cashplanline_id,
    NULL::numeric AS c_order_c_charge_id,
    NULL::numeric AS c_conversiontype_id,
    NULL::numeric AS c_order_c_currency_id,
    NULL::numeric AS c_doctype_id,
    NULL::numeric AS c_doctypetarget_id,
    NULL::numeric AS chargeamt,
    NULL::bpchar AS copyfrom,
    NULL::numeric AS c_payment_id,
    NULL::numeric AS c_paymentterm_id,
    NULL::numeric AS c_pos_id,
    NULL::numeric AS c_order_c_project_id,
    NULL::timestamp without time zone AS c_order_created,
    NULL::numeric AS c_order_createdby,
    NULL::timestamp without time zone AS dateacct,
    NULL::timestamp without time zone AS dateprinted,
    NULL::timestamp without time zone AS c_order_datepromised,
    NULL::bpchar AS deliveryrule,
    NULL::bpchar AS deliveryviarule,
    NULL::character varying AS c_order_description,
    NULL::bpchar AS docaction,
    NULL::bpchar AS docstatus,
    NULL::character varying AS documentno,
    NULL::numeric AS dropship_bpartner_id,
    NULL::numeric AS dropship_location_id,
    NULL::numeric AS dropship_user_id,
    NULL::numeric AS c_order_freightamt,
    NULL::bpchar AS freightcostrule,
    NULL::numeric AS grandtotal,
    NULL::bpchar AS invoicerule,
    NULL::bpchar AS c_order_isactive,
    NULL::bpchar AS isapproved,
    NULL::bpchar AS iscreditapproved,
    NULL::bpchar AS isdelivered,
    NULL::bpchar AS c_order_isdiscountprinted,
    NULL::bpchar AS c_order_isdropship,
    NULL::bpchar AS isinvoiced,
    NULL::bpchar AS ispayschedulevalid,
    NULL::bpchar AS isprinted,
    NULL::bpchar AS isselected,
    NULL::bpchar AS c_order_isselfservice,
    NULL::bpchar AS issotrx,
    NULL::bpchar AS istaxincluded,
    NULL::bpchar AS istransferred,
    NULL::numeric AS link_order_id,
    NULL::numeric AS c_order_m_freightcategory_id,
    NULL::numeric AS c_order_m_pricelist_id,
    NULL::numeric AS c_order_m_shipper_id,
    NULL::numeric AS c_order_m_warehouse_id,
    NULL::character varying AS ordertype,
    NULL::numeric AS pay_bpartner_id,
    NULL::numeric AS pay_location_id,
    NULL::bpchar AS c_order_paymentrule,
    NULL::character varying AS poreference,
    NULL::bpchar AS posted,
    NULL::bpchar AS priorityrule,
    NULL::bpchar AS c_order_processed,
    NULL::numeric AS processedon,
    NULL::character varying AS promotioncode,
    NULL::numeric AS ref_order_id,
    NULL::numeric AS salesrep_id,
    NULL::bpchar AS c_order_sendemail,
    NULL::numeric AS totallines,
    NULL::timestamp without time zone AS c_order_updated,
    NULL::numeric AS c_order_updatedby,
    NULL::numeric AS c_order_user1_id,
    NULL::numeric AS c_order_user2_id,
    NULL::numeric AS c_order_volume,
    NULL::numeric AS c_order_weight,
    NULL::numeric AS m_product_ad_org_id,
    NULL::character varying AS classification,
    NULL::bpchar AS m_product_copyfrom,
    NULL::timestamp without time zone AS m_product_created,
    NULL::numeric AS m_product_createdby,
    NULL::numeric AS c_revenuerecognition_id,
    NULL::numeric AS c_subscriptiontype_id,
    NULL::numeric AS c_taxcategory_id,
    NULL::numeric AS m_product_c_uom_id,
    NULL::character varying AS descriptionurl,
    NULL::bpchar AS m_product_discontinued,
    NULL::timestamp without time zone AS m_product_discontinuedat,
    NULL::character varying AS group1,
    NULL::character varying AS group2,
    NULL::numeric AS guaranteedays,
    NULL::numeric AS guaranteedaysmin,
    NULL::character varying AS help,
    NULL::bpchar AS m_product_isactive,
    NULL::bpchar AS isbom,
    NULL::bpchar AS m_product_isdropship,
    NULL::bpchar AS isexcludeautodelivery,
    NULL::bpchar AS isinvoiceprintdetails,
    NULL::bpchar AS ispicklistprintdetails,
    NULL::bpchar AS ispurchased,
    NULL::bpchar AS m_product_isselfservice,
    NULL::bpchar AS issold,
    NULL::bpchar AS isstocked,
    NULL::bpchar AS m_product_issummary,
    NULL::bpchar AS isverified,
    NULL::bpchar AS iswebstorefeatured,
    NULL::numeric AS lowlevel,
    NULL::numeric AS m_attributeset_id,
    NULL::numeric AS m_attributesetinstance_id,
    NULL::numeric AS m_product_m_freightcategory_id,
    NULL::numeric AS m_locator_id,
    NULL::numeric AS m_product_product_category_id,
    NULL::bpchar AS m_product_processing,
    NULL::bpchar AS producttype,
    NULL::numeric AS r_mailtext_id,
    NULL::numeric AS m_product_salesrep_id,
    NULL::numeric AS s_expensetype_id,
    NULL::numeric AS shelfdepth,
    NULL::numeric AS shelfheight,
    NULL::numeric AS shelfwidth,
    NULL::numeric AS s_resource_id,
    NULL::numeric AS unitsperpack,
    NULL::numeric AS unitsperpallet,
    NULL::timestamp without time zone AS m_product_updated,
    NULL::numeric AS m_product_updatedby,
    NULL::character varying AS versionno,
    NULL::numeric AS m_product_volume,
    NULL::numeric AS m_product_weight,
    NULL::numeric AS m_product_po_ad_org_id,
    NULL::numeric AS m_product_po_c_bpartner_id,
    NULL::numeric AS m_product_po_c_currency_id,
    NULL::numeric AS costperorder,
    NULL::timestamp without time zone AS m_product_po_created,
    NULL::numeric AS m_product_po_createdby,
    NULL::numeric AS m_product_po_c_uom_id,
    NULL::numeric AS deliverytime_actual,
    NULL::numeric AS deliverytime_promised,
    NULL::bpchar AS m_product_po_discontinued,
    NULL::timestamp without time zone AS m_product_po_discontinuedat,
    NULL::bpchar AS m_product_po_isactive,
    NULL::bpchar AS iscurrentvendor,
    NULL::bpchar AS m_product_po_manufacturer,
    NULL::numeric AS m_product_po_m_product_id,
    NULL::numeric AS order_min,
    NULL::numeric AS order_pack,
    NULL::timestamp without time zone AS priceeffective,
    NULL::numeric AS pricelastinv,
    NULL::numeric AS pricelastpo,
    NULL::numeric AS m_product_po_pricelist,
    NULL::numeric AS pricepo,
    NULL::numeric AS m_product_po_qualityrating,
    NULL::numeric AS royaltyamt,
    NULL::character varying AS m_product_po_upc,
    NULL::timestamp without time zone AS m_product_po_updated,
    NULL::numeric AS m_product_po_updatedby,
    NULL::bpchar AS m_product_po_vendorcategory,
    NULL::numeric AS s_resourceassignment_ad_org_id,
    NULL::timestamp without time zone AS assigndatefrom,
    NULL::timestamp without time zone AS assigndateto,
    NULL::timestamp without time zone AS s_resourceassignment_created,
    NULL::numeric AS s_resourceassignment_createby,
    NULL::bpchar AS s_resourceassignment_isactive,
    NULL::bpchar AS isconfirmed,
    NULL::character varying AS s_resourceassignment_name,
    NULL::numeric AS s_resourceassignment_qty,
    NULL::numeric AS s_resourceassignment_s_resour,
    NULL::timestamp without time zone AS s_resourceassignment_updated,
    NULL::numeric AS s_resourceassignment_updatedby,
    NULL::numeric AS c_charge_c_org_id,
    NULL::numeric AS c_charge_c_bpartner_id,
    NULL::numeric AS c_chargetype_id,
    NULL::numeric AS c_charge_chargeamt,
    NULL::numeric AS c_charge_c_taxcategory_id,
    NULL::character varying AS c_charge_description,
    NULL::bpchar AS c_charge_isactive,
    NULL::bpchar AS issamecurrency,
    NULL::bpchar AS issametax,
    NULL::bpchar AS c_charge_istaxincluded,
    NULL::numeric AS c_bpartner_product_ad_org_id,
    NULL::numeric AS c_bp_product_c_bpartner_id,
    NULL::timestamp without time zone AS c_bpartner_product_created,
    NULL::numeric AS c_bpartner_product_createdby,
    NULL::character varying AS c_bpartner_product_descriptio,
    NULL::bpchar AS c_bpartner_product_isactive,
    NULL::bpchar AS ismanufacturer,
    NULL::character varying AS c_bpartner_product_manufactur,
    NULL::numeric AS c_bpartner_product_qualityrat,
    NULL::numeric AS shelflifemindays,
    NULL::numeric AS c_bpartner_product_shelflifem,
    NULL::timestamp without time zone AS c_bpartner_product_updated,
    NULL::numeric AS c_bpartner_product_updatedby,
    NULL::character varying AS c_bpartner_product_vendorcate,
    NULL::numeric AS acqusitioncost,
    NULL::numeric AS actuallifetimevalue,
    NULL::character varying AS c_bpartner_ad_language,
    NULL::numeric AS ad_orgbp_id,
    NULL::numeric AS c_bpartner_ad_org_id,
    NULL::numeric AS bpartner_parent_id,
    NULL::numeric AS c_bp_group_id,
    NULL::numeric AS c_dunning_id,
    NULL::numeric AS c_greeting_id,
    NULL::numeric AS c_invoiceschedule_id,
    NULL::numeric AS c_bpartner_c_paymentterm_id,
    NULL::timestamp without time zone AS c_bpartner_created,
    NULL::numeric AS c_bpartner_createdby,
    NULL::numeric AS c_bpartner_c_taxgroup_id,
    NULL::bpchar AS c_bpartner_deliveryrule,
    NULL::bpchar AS c_bpartner_deliveryviarule,
    NULL::character varying AS c_bpartner_description,
    NULL::date AS c_bpartner_dunninggrace,
    NULL::bpchar AS duns,
    NULL::timestamp without time zone AS c_bpartner_firstsale,
    NULL::numeric AS c_bpartner_flatdiscount,
    NULL::bpchar AS c_bpartner_freightcostrule,
    NULL::bpchar AS c_bpartner_invoicerule,
    NULL::bpchar AS c_bpartner_isactive,
    NULL::bpchar AS iscustomer,
    NULL::bpchar AS c_bpartner_isdiscountprinted,
    NULL::bpchar AS c_bpartner_isemployee,
    NULL::bpchar AS c_bpartner_ismanufacturer,
    NULL::bpchar AS isonetime,
    NULL::bpchar AS ispotaxexempt,
    NULL::bpchar AS isprospect,
    NULL::bpchar AS issalesrep,
    NULL::bpchar AS c_bpartner_issummary,
    NULL::bpchar AS c_bpartner_istaxexempt,
    NULL::bpchar AS isvendor,
    NULL::numeric AS logo_id,
    NULL::numeric AS m_discountschema_id,
    NULL::numeric AS c_bpartner_m_pricelist_id,
    NULL::bpchar AS naics,
    NULL::character varying AS c_bpartner_name,
    NULL::character varying AS c_bpartner_name2,
    NULL::numeric AS numberemployees,
    NULL::bpchar AS c_bpartner_paymentrule,
    NULL::bpchar AS paymentrulepo,
    NULL::numeric AS po_discountschema_id,
    NULL::numeric AS po_paymentterm_id,
    NULL::numeric AS po_pricelist_id,
    NULL::character varying AS c_bpartner_poreference,
    NULL::numeric AS potentiallifetimevalue,
    NULL::bpchar AS c_bpartner_rating,
    NULL::character varying AS c_bpartner_referenceno,
    NULL::numeric AS c_bpartner_salesrep_id,
    NULL::numeric AS salesvolume,
    NULL::bpchar AS c_bpartner_sendemail,
    NULL::numeric AS shareofcustomer,
    NULL::numeric AS c_bpartner_shelflifeminpct,
    NULL::numeric AS so_creditlimit,
    NULL::bpchar AS socreditstatus,
    NULL::numeric AS so_creditused,
    NULL::character varying AS so_description,
    NULL::character varying AS c_bpartner_taxid,
    NULL::numeric AS totalopenbalance,
    NULL::timestamp without time zone AS c_bpartner_updated,
    NULL::numeric AS c_bpartner_updatedby,
    NULL::character varying AS c_bpartner_url,
    NULL::character varying AS c_bpartner_value,
    NULL::numeric AS c_bpartner_location_ad_org_id,
    NULL::numeric AS c_bpartner_location_c_bpartne,
    NULL::timestamp without time zone AS c_bpartner_location_created,
    NULL::numeric AS c_bpartner_location_createdby,
    NULL::numeric AS c_salesregion_id,
    NULL::character varying AS c_bpartner_location_fax,
    NULL::bpchar AS c_bpartner_location_isactive,
    NULL::bpchar AS isbillto,
    NULL::character varying AS isdn,
    NULL::bpchar AS ispayfrom,
    NULL::bpchar AS isremitto,
    NULL::bpchar AS isshipto,
    NULL::character varying AS c_bpartner_location_name,
    NULL::character varying AS c_bpartner_location_phone,
    NULL::character varying AS c_bpartner_location_phone2,
    NULL::timestamp without time zone AS c_bpartner_location_updated,
    NULL::numeric AS c_bpartner_location_updatedby,
    tt.ad_org_id AS c_tax_ad_org_id,
    t.ad_rule_id,
    t.c_country_id,
    t.c_region_id,
    t.c_taxcategory_id AS c_tax_c_taxcategory_id,
    tt.description AS c_tax_description,
    tt.isactive AS c_tax_isactive,
    t.isdefault AS c_tax_isdefault,
    t.isdocumentlevel,
    t.issalestax,
    t.issummary AS c_tax_issummary,
    t.istaxexempt AS c_tax_istaxexempt,
    tt.name AS c_tax_name,
    t.parent_tax_id,
    t.rate,
    t.requirestaxcertificate,
    t.sopotype,
    t.to_country_id,
    t.to_region_id AS c_tax_to_region_id,
    t.validfrom
   FROM ((c_ordertax ot
     JOIN c_tax t ON ((ot.c_tax_id = t.c_tax_id)))
     JOIN c_tax_trl tt ON ((ot.c_tax_id = tt.c_tax_id)));
--
-- create view  wmv_order_header_vt
--
CREATE OR REPLACE VIEW wmv_order_header_vt AS
 SELECT o.incoterm,
    o.isusingfactoring,
    wmv_textblock('factoring_note'::character varying, o.isusingfactoring) AS factoringtext,
    wmv_textblock('bankverbindung'::character varying, o.isusingfactoring, true) AS bankverbindung,
    wmv_textblock('companyinfo'::character varying) AS companyinfo,
    o.wmv_product_id AS m_product_id,
    lf.name AS lineformat,
    p.description AS productdescription,
    o.ad_client_id,
    o.ad_org_id,
    o.isactive,
    o.created,
    o.createdby,
    o.updated,
    o.updatedby,
    dt.ad_language,
    o.c_order_id,
    o.issotrx,
    o.documentno,
    o.docstatus,
    o.c_doctype_id,
    o.c_bpartner_id,
    bp.value AS bpvalue,
    bp.taxid AS bptaxid,
    bp.naics,
    bp.duns,
    oi.c_location_id AS org_location_id,
    org.name AS org_name,
    ol.address1 AS org_address1,
    ol.address2 AS org_address2,
    ol.address3 AS org_address3,
    ol.address4 AS org_address4,
    ol.c_country_id AS org_country_id,
    oc.name AS org_country,
    oc.countrycode AS org_countrycode,
    ol.city AS org_city,
    concat((ol.postal)::text, (ol.postal_add)::text) AS org_postal,
    oi.taxid,
    o.m_warehouse_id,
    wh.c_location_id AS warehouse_location_id,
    dt.printname AS documenttype,
    dt.documentnote AS documenttypenote,
    o.salesrep_id,
    COALESCE(ubp.name, u.name) AS salesrep_name,
    o.dateordered,
    o.datepromised,
    bpgt.greeting AS bpgreeting,
    bp.name,
    bp.name2,
    bpcgt.greeting AS bpcontactgreeting,
    bpc.title,
    bpc.phone,
    NULLIF((bpc.name)::text, (bp.name)::text) AS contactname,
    bpl.c_location_id,
    concat((l.postal)::text, (l.postal_add)::text) AS postal,
    bp.referenceno,
    o.bill_bpartner_id,
    o.bill_location_id,
    o.bill_user_id,
    bbp.value AS bill_bpvalue,
    bbp.taxid AS bill_bptaxid,
    bbp.name AS bill_name,
    bbp.name2 AS bill_name2,
    bbpc.title AS bill_title,
    bbpc.phone AS bill_phone,
    NULLIF((bbpc.name)::text, (bbp.name)::text) AS bill_contactname,
    bbpl.c_location_id AS bill_c_location_id,
    o.description,
    o.poreference,
    o.c_currency_id,
    ptt.name AS paymentterm,
    ptt.documentnote AS paymenttermnote,
    o.c_charge_id,
    o.chargeamt,
    o.totallines,
    o.grandtotal,
    o.grandtotal AS amtinwords,
    o.m_pricelist_id,
    o.istaxincluded,
    o.volume,
    o.weight,
    o.c_campaign_id,
    o.c_project_id,
    o.c_activity_id,
    o.m_shipper_id,
    o.deliveryrule,
    o.deliveryviarule,
    o.priorityrule,
    o.invoicerule,
    COALESCE(oi.logo_id, ci.logo_id) AS logo_id,
    o.ad_orgtrx_id,
    o.ad_user_id,
    o.amountrefunded,
    o.amounttendered,
    o.c_bpartner_location_id,
    o.c_cashline_id,
    o.c_cashplanline_id,
    o.c_conversiontype_id,
    o.c_doctypetarget_id,
    o.copyfrom,
    o.c_payment_id,
    o.c_paymentterm_id,
    o.c_pos_id,
    o.dateacct,
    o.dateprinted,
    o.docaction,
    o.dropship_bpartner_id,
    o.dropship_location_id,
    o.dropship_user_id,
    o.freightamt,
    o.freightcostrule,
    o.isapproved,
    o.iscreditapproved,
    o.isdelivered,
    o.isdiscountprinted,
    o.isdropship,
    o.isinvoiced,
    o.ispayschedulevalid,
    o.isprinted,
    o.isselected,
    o.isselfservice,
    o.istransferred,
    o.link_order_id,
    o.m_freightcategory_id,
    o.ordertype,
    o.pay_bpartner_id,
    o.pay_location_id,
    o.paymentrule,
    o.posted,
    o.processed,
    o.processedon,
    o.promotioncode,
    o.ref_order_id,
    o.sendemail,
    o.user1_id,
    o.user2_id,
    wh.ad_org_id AS m_warehouse_ad_org_id,
    wh.description AS m_warehouse_description,
    wh.isactive AS m_warehouse_isactive,
    wh.isdisallownegativeinv,
    wh.isintransit,
    wh.m_warehousesource_id,
    wh.name AS m_warehouse_name,
    wh.replenishmentclass,
    wh.separator,
    wh.value AS m_warehouse_value,
    ptt.ad_org_id AS c_paymentterm_ad_org_id,
    pt.afterdelivery,
    ptt.description AS c_paymentterm_description,
    pt.discount,
    pt.discount2,
    pt.discountdays,
    pt.discountdays2,
    pt.fixmonthcutoff,
    pt.fixmonthday,
    pt.fixmonthoffset,
    pt.gracedays,
    ptt.isactive AS c_paymentterm_isactive,
    pt.isdefault,
    pt.isduefixed,
    pt.isnextbusinessday,
    pt.isvalid,
    pt.netday,
    pt.netdays,
    pt.paymenttermusage,
    pt.value AS m_paymentterm_value,
    bp.acqusitioncost AS bp_acqusitioncost,
    bp.actuallifetimevalue AS bp_actuallifetimevalue,
    bp.ad_language AS bp_ad_language,
    bp.ad_orgbp_id AS bp_ad_orgbp_id,
    bp.ad_org_id AS bp_ad_org_id,
    bp.bpartner_parent_id AS bp_bpartner_parent_id,
    bp.c_bp_group_id AS bp_c_bp_group_id,
    bp.c_dunning_id AS bp_c_dunning_id,
    bp.c_greeting_id AS bp_c_greeting_id,
    bp.c_invoiceschedule_id AS bp_c_invoiceschedule_id,
    bp.c_paymentterm_id AS bp_c_paymentterm_id,
    bp.created AS bp_created,
    bp.createdby AS bp_createdby,
    bp.c_taxgroup_id AS bp_c_taxgroup_id,
    bp.deliveryrule AS bp_deliveryrule,
    bp.deliveryviarule AS bp_deliveryviarule,
    bp.description AS bp_description,
    bp.dunninggrace AS bp_dunninggrace,
    bp.firstsale AS bp_firstsale,
    bp.flatdiscount AS bp_flatdiscount,
    bp.freightcostrule AS bp_freightcostrule,
    bp.invoicerule AS bp_invoicerule,
    bp.isactive AS bp_isactive,
    bp.iscustomer AS bp_iscustomer,
    bp.isdiscountprinted AS bp_isdiscountprinted,
    bp.isemployee AS bp_isemployee,
    bp.ismanufacturer AS bp_ismanufacturer,
    bp.isonetime AS bp_isonetime,
    bp.ispotaxexempt AS bp_ispotaxexempt,
    bp.isprospect AS bp_isprospect,
    bp.issalesrep AS bp_issalesrep,
    bp.issummary AS bp_issummary,
    bp.istaxexempt AS bp_istaxexempt,
    bp.isvendor AS bp_isvendor,
    bp.logo_id AS bp_logo_id,
    bp.m_discountschema_id AS bp_m_discountschema_id,
    bp.m_pricelist_id AS bp_m_pricelist_id,
    bp.numberemployees AS bp_numberemployees,
    bp.paymentrule AS bp_paymentrule,
    bp.paymentrulepo AS bp_paymentrulepo,
    bp.po_discountschema_id AS bp_po_discountschema_id,
    bp.po_paymentterm_id AS bp_po_paymentterm_id,
    bp.po_pricelist_id AS bp_po_pricelist_id,
    bp.poreference AS bp_poreference,
    bp.potentiallifetimevalue AS bp_potentiallifetimevalue,
    bp.rating AS bp_rating,
    bp.salesrep_id AS bp_salesrep_id,
    bp.salesvolume AS bp_salesvolume,
    bp.sendemail AS bp_sendemail,
    bp.shareofcustomer AS bp_shareofcustomer,
    bp.shelflifeminpct AS bp_shelflifeminpct,
    bp.so_creditlimit AS bp_so_creditlimit,
    bp.socreditstatus AS bp_socreditstatus,
    bp.so_creditused AS bp_so_creditused,
    bp.so_description AS bp_so_description,
    bp.totalopenbalance AS bp_totalopenbalance,
    bp.updated AS bp_updated,
    bp.updatedby AS bp_updatedby,
    bp.url AS bp_url,
    bpgt.ad_org_id AS c_greeting_ad_org_id,
    bpgt.isactive AS c_greeting_isactive,
    bpg.isfirstnameonly,
    bpgt.name AS c_greeting_name,
    bpl.ad_org_id AS bp_location_ad_org_id,
    bpl.c_bpartner_id AS bp_location_c_bpartner_id,
    bpl.created AS bp_location_created,
    bpl.createdby AS bp_location_createdby,
    bpl.c_salesregion_id AS bp_location_c_salesregion_id,
    bpl.fax AS bp_location_fax,
    bpl.isactive AS bp_location_isactive,
    bpl.isbillto AS bp_location_isbillto,
    bpl.isdn AS bp_location_isdn,
    bpl.ispayfrom AS bp_location_ispayfrom,
    bpl.isremitto AS bp_location_isremitto,
    bpl.isshipto AS bp_location_isshipto,
    bpl.name AS bp_location_name,
    bpl.phone AS bp_location_phone,
    bpl.phone2 AS bp_location_phone2,
    bpl.updated AS bp_location_updated,
    bpl.updatedby AS bp_location_updatedby,
    l.address1,
    l.address2,
    l.address3,
    l.address4,
    l.ad_org_id AS c_location_ad_org_id,
    l.c_city_id,
    l.c_country_id,
    bpcountry_trl.name AS country,
    l.city,
    l.created AS c_location_created,
    l.createdby AS c_location_createdby,
    l.c_region_id,
    l.isactive AS c_location_isactive,
    l.regionname,
    l.updated AS c_location_updated,
    l.updatedby AS c_location_updatedby,
    bpc.ad_org_id AS ad_user_ad_org_id,
    bpc.ad_orgtrx_id AS ad_user_ad_orgtrx_id,
    bpc.birthday AS ad_user_ad_birthday,
    bpc.c_bpartner_id AS ad_user_c_bpartner_id,
    bpc.c_bpartner_location_id AS ad_user_c_bpartner_location_id,
    bpc.c_greeting_id AS ad_user_c_greeting_id,
    bpc.comments AS ad_user_comments,
    bpc.created AS ad_user_created,
    bpc.createdby AS ad_user_createdby,
    bpc.description AS ad_user_description,
    bpc.email AS ad_user_email,
    bpc.fax AS ad_user_fax,
    bpc.isactive AS ad_user_isactive,
    bpc.lastcontact AS ad_user_lastcontact,
    bpc.lastresult AS ad_user_lastresult,
    bpc.phone2 AS ad_user_phone2,
    bpc.supervisor_id AS ad_user_supervisor_id,
    bpc.updated AS ad_user_updated,
    bpc.updatedby AS ad_user_updatedby,
    bpc.value AS ad_user_value,
    bpcgt.ad_org_id AS c_user_greeting_ad_org_id,
    bpcgt.isactive AS c_user_greeting_isactive,
    bpcg.isfirstnameonly AS c_user_greeting_isfnameonly,
    bpcgt.name AS c_user_greeting_name,
    oi.ad_org_id AS ad_orginfo_ad_org_id,
    oi.ad_orgtype_id,
    oi.c_calendar_id,
    oi.created AS ad_orginfo_created,
    oi.createdby AS ad_orginfo_createdby,
    oi.dropship_warehouse_id,
    oi.duns AS ad_orginfo_duns,
    oi.email AS ad_orginfo_email,
    oi.fax AS ad_orginfo_fax,
    oi.isactive AS ad_orginfo_isactive,
    oi.m_warehouse_id AS ad_orginfo_m_warehouse_id,
    oi.parent_org_id,
    oi.phone AS ad_orginfo_phone,
    oi.phone2 AS ad_orginfo_phone2,
    oi.receiptfootermsg,
    oi.supervisor_id,
    oi.updated AS ad_orginfo_updated,
    oi.updatedby AS ad_orginfo_updatedby,
    u.ad_org_id AS salesrep_ad_org_id,
    u.ad_orgtrx_id AS salesrep_ad_orgtrx_id,
    u.birthday AS salesrep_ad_birthday,
    u.c_bpartner_id AS salesrep_c_bpartner_id,
    u.c_bpartner_location_id AS salesrep_c_bp_location_id,
    u.c_greeting_id AS salesrep_c_greeting_id,
    u.comments AS salesrep_comments,
    u.created AS salesrep_created,
    u.createdby AS salesrep_createdby,
    u.description AS salesrep_description,
    u.email AS salesrep_email,
    u.fax AS salesrep_fax,
    u.isactive AS salesrep_isactive,
    u.lastcontact AS salesrep_lastcontact,
    u.lastresult AS salesrep_lastresult,
    u.phone AS salesrep_phone,
    u.phone2 AS salesrep_phone2,
    u.supervisor_id AS salesrep_supervisor_id,
    u.title AS salesrep_title,
    u.updated AS salesrep_updated,
    u.updatedby AS salesrep_updatedby,
    u.value AS salesrep_value,
    ubp.acqusitioncost AS salesrep_bp_acqusitioncost,
    ubp.actuallifetimevalue AS salesrep_bp_actuallifetimeval,
    ubp.ad_language AS salesrep_bp_ad_language,
    ubp.ad_orgbp_id AS salesrep_bp_ad_orgbp_id,
    ubp.ad_org_id AS salesrep_bp_ad_org_id,
    ubp.bpartner_parent_id AS salesrep_bp_bpartner_parent_id,
    ubp.c_bp_group_id AS salesrep_bp_c_bp_group_id,
    ubp.c_dunning_id AS salesrep_bp_c_dunning_id,
    ubp.c_greeting_id AS salesrep_bp_c_greeting_id,
    ubp.c_invoiceschedule_id AS salesrep_bp_c_invoicesched_id,
    ubp.c_paymentterm_id AS salesrep_bp_c_paymentterm_id,
    ubp.created AS salesrep_bp_created,
    ubp.createdby AS salesrep_bp_createdby,
    ubp.c_taxgroup_id AS salesrep_bp_c_taxgroup_id,
    ubp.deliveryrule AS salesrep_bp_deliveryrule,
    ubp.deliveryviarule AS salesrep_bp_deliveryviarule,
    ubp.description AS salesrep_bp_description,
    ubp.dunninggrace AS salesrep_bp_dunninggrace,
    ubp.duns AS salesrep_bp_duns,
    ubp.firstsale AS salesrep_bp_firstsale,
    ubp.flatdiscount AS salesrep_bp_flatdiscount,
    ubp.freightcostrule AS salesrep_bp_freightcostrule,
    ubp.invoicerule AS salesrep_bp_invoicerule,
    ubp.isactive AS salesrep_bp_isactive,
    ubp.iscustomer AS salesrep_bp_iscustomer,
    ubp.isdiscountprinted AS salesrep_bp_isdiscountprinted,
    ubp.isemployee AS salesrep_bp_isemployee,
    ubp.ismanufacturer AS salesrep_bp_ismanufacturer,
    ubp.isonetime AS salesrep_bp_isonetime,
    ubp.ispotaxexempt AS salesrep_bp_ispotaxexempt,
    ubp.isprospect AS salesrep_bp_isprospect,
    ubp.issalesrep AS salesrep_bp_issalesrep,
    ubp.issummary AS salesrep_bp_issummary,
    ubp.istaxexempt AS salesrep_bp_istaxexempt,
    ubp.isvendor AS salesrep_bp_isvendor,
    ubp.logo_id AS salesrep_bp_logo_id,
    ubp.m_discountschema_id AS salesrep_bp_m_discountschm_id,
    ubp.m_pricelist_id AS salesrep_bp_m_pricelist_id,
    ubp.naics AS salesrep_bp_naics,
    ubp.name2 AS salesrep_bp_name2,
    ubp.numberemployees AS salesrep_bp_numberemployees,
    ubp.paymentrule AS salesrep_bp_paymentrule,
    ubp.paymentrulepo AS salesrep_bp_paymentrulepo,
    ubp.po_discountschema_id AS salesrep_bp_po_discountschm_id,
    ubp.po_paymentterm_id AS salesrep_bp_po_paymentterm_id,
    ubp.po_pricelist_id AS salesrep_bp_po_pricelist_id,
    ubp.poreference AS salesrep_bp_poreference,
    ubp.potentiallifetimevalue AS salesrep_bp_potentiallifetime,
    ubp.rating AS salesrep_bp_rating,
    ubp.referenceno AS salesrep_bp_referenceno,
    ubp.salesrep_id AS salesrep_bp_salesrep_id,
    ubp.salesvolume AS salesrep_bp_salesvolume,
    ubp.sendemail AS salesrep_bp_sendemail,
    ubp.shareofcustomer AS salesrep_bp_shareofcustomer,
    ubp.shelflifeminpct AS salesrep_bp_shelflifeminpct,
    ubp.so_creditlimit AS salesrep_bp_so_creditlimit,
    ubp.socreditstatus AS salesrep_bp_socreditstatus,
    ubp.so_creditused AS salesrep_bp_so_creditused,
    ubp.so_description AS salesrep_bp_so_description,
    ubp.taxid AS salesrep_bp_taxid,
    ubp.totalopenbalance AS salesrep_bp_totalopenbalance,
    ubp.updated AS salesrep_bp_updated,
    ubp.updatedby AS salesrep_bp_updatedby,
    ubp.url AS salesrep_bp_url,
    ubp.value AS salesrep_bp_value,
    bbp.acqusitioncost AS bill_bp_acqusitioncost,
    bbp.actuallifetimevalue AS bill_bp_actuallifetimevalue,
    bbp.ad_language AS bill_bp_ad_language,
    bbp.ad_orgbp_id AS bill_bp_ad_orgbp_id,
    bbp.ad_org_id AS bill_bp_ad_org_id,
    bbp.bpartner_parent_id AS bill_bp_bpartner_parent_id,
    bbp.c_bp_group_id AS bill_bp_c_bp_group_id,
    bbp.c_dunning_id AS bill_bp_c_dunning_id,
    bbp.c_greeting_id AS bill_bp_c_greeting_id,
    bbp.c_invoiceschedule_id AS bill_bp_c_invoiceschedule_id,
    bbp.c_paymentterm_id AS bill_bp_c_paymentterm_id,
    bbp.created AS bill_bp_created,
    bbp.createdby AS bill_bp_createdby,
    bbp.c_taxgroup_id AS bill_bp_c_taxgroup_id,
    bbp.deliveryrule AS bill_bp_deliveryrule,
    bbp.deliveryviarule AS bill_bp_deliveryviarule,
    bbp.description AS bill_bp_description,
    bbp.dunninggrace AS bill_bp_dunninggrace,
    bbp.duns AS bill_bp_duns,
    bbp.firstsale AS bill_bp_firstsale,
    bbp.flatdiscount AS bill_bp_flatdiscount,
    bbp.freightcostrule AS bill_bp_freightcostrule,
    bbp.invoicerule AS bill_bp_invoicerule,
    bbp.isactive AS bill_bp_isactive,
    bbp.iscustomer AS bill_bp_iscustomer,
    bbp.isdiscountprinted AS bill_bp_isdiscountprinted,
    bbp.isemployee AS bill_bp_isemployee,
    bbp.ismanufacturer AS bill_bp_ismanufacturer,
    bbp.isonetime AS bill_bp_isonetime,
    bbp.ispotaxexempt AS bill_bp_ispotaxexempt,
    bbp.isprospect AS bill_bp_isprospect,
    bbp.issalesrep AS bill_bp_issalesrep,
    bbp.issummary AS bill_bp_issummary,
    bbp.istaxexempt AS bill_bp_istaxexempt,
    bbp.isvendor AS bill_bp_isvendor,
    bbp.logo_id AS bill_bp_logo_id,
    bbp.m_discountschema_id AS bill_bp_m_discountschema_id,
    bbp.m_pricelist_id AS bill_bp_m_pricelist_id,
    bbp.naics AS bill_bp_naics,
    bbp.numberemployees AS bill_bp_numberemployees,
    bbp.paymentrule AS bill_bp_paymentrule,
    bbp.paymentrulepo AS bill_bp_paymentrulepo,
    bbp.po_discountschema_id AS bill_bp_po_discountschema_id,
    bbp.po_paymentterm_id AS bill_bp_po_paymentterm_id,
    bbp.po_pricelist_id AS bill_bp_po_pricelist_id,
    bbp.poreference AS bill_bp_poreference,
    bbp.potentiallifetimevalue AS bill_bp_potentiallifetimevalue,
    bbp.rating AS bill_bp_rating,
    bbp.referenceno AS bill_bp_referenceno,
    bbp.salesrep_id AS bill_bp_salesrep_id,
    bbp.salesvolume AS bill_bp_salesvolume,
    bbp.sendemail AS bill_bp_sendemail,
    bbp.shareofcustomer AS bill_bp_shareofcustomer,
    bbp.shelflifeminpct AS bill_bp_shelflifeminpct,
    bbp.so_creditlimit AS bill_bp_so_creditlimit,
    bbp.socreditstatus AS bill_bp_socreditstatus,
    bbp.so_creditused AS bill_bp_so_creditused,
    bbp.so_description AS bill_bp_so_description,
    bbp.totalopenbalance AS bill_bp_totalopenbalance,
    bbp.updated AS bill_bp_updated,
    bbp.updatedby AS bill_bp_updatedby,
    bbp.url AS bill_bp_url,
    bbpl.ad_org_id AS bill_bp_location_ad_org_id,
    bbpl.c_bpartner_id AS bill_bp_location_c_bpartner_id,
    bbpl.created AS bill_bp_location_created,
    bbpl.createdby AS bill_bp_location_createdby,
    bbpl.c_salesregion_id AS bill_bp_location_c_salesreg_id,
    bbpl.fax AS bill_bp_location_fax,
    bbpl.isactive AS bill_bp_location_isactive,
    bbpl.isbillto AS bill_bp_location_isbillto,
    bbpl.isdn AS bill_bp_location_isdn,
    bbpl.ispayfrom AS bill_bp_location_ispayfrom,
    bbpl.isremitto AS bill_bp_location_isremitto,
    bbpl.isshipto AS bill_bp_location_isshipto,
    bbpl.name AS bill_bp_location_name,
    bbpl.phone AS bill_bp_location_phone,
    bbpl.phone2 AS bill_bp_location_phone2,
    bbpl.updated AS bill_bp_location_updated,
    bbpl.updatedby AS bill_bp_location_updatedby,
    bbpc.ad_org_id AS bill_user_ad_org_id,
    bbpc.ad_orgtrx_id AS bill_user_ad_orgtrx_id,
    bbpc.birthday AS bill_user_ad_birthday,
    bbpc.c_bpartner_id AS bill_user_c_bpartner_id,
    bbpc.c_bpartner_location_id AS bill_user_c_bp_location_id,
    bbpc.c_greeting_id AS bill_user_c_greeting_id,
    bbpc.comments AS bill_user_comments,
    bbpc.created AS bill_user_created,
    bbpc.createdby AS bill_user_createdby,
    bbpc.description AS bill_user_description,
    bbpc.email AS bill_user_email,
    bbpc.fax AS bill_user_fax,
    bbpc.isactive AS bill_user_isactive,
    bbpc.lastcontact AS bill_user_lastcontact,
    bbpc.lastresult AS bill_user_lastresult,
    bbpc.phone2 AS bill_user_phone2,
    bbpc.supervisor_id AS bill_user_supervisor_id,
    bbpc.updated AS bill_user_updated,
    bbpc.updatedby AS bill_user_updatedby,
    bbpc.value AS bill_user_value,
    cur.cursymbol,
    cur.description AS cur_description
   FROM (((((((((((((((((((((((((((c_order o
     JOIN c_doctype_trl dt ON ((o.c_doctype_id = dt.c_doctype_id)))
     JOIN m_warehouse wh ON ((o.m_warehouse_id = wh.m_warehouse_id)))
     JOIN c_paymentterm pt ON ((o.c_paymentterm_id = pt.c_paymentterm_id)))
     JOIN c_paymentterm_trl ptt ON (((o.c_paymentterm_id = ptt.c_paymentterm_id) AND ((dt.ad_language)::text = (ptt.ad_language)::text))))
     JOIN c_bpartner bp ON ((o.c_bpartner_id = bp.c_bpartner_id)))
     LEFT JOIN c_greeting bpg ON ((bp.c_greeting_id = bpg.c_greeting_id)))
     LEFT JOIN c_greeting_trl bpgt ON (((bp.c_greeting_id = bpgt.c_greeting_id) AND ((dt.ad_language)::text = (bpgt.ad_language)::text))))
     JOIN c_bpartner_location bpl ON ((o.c_bpartner_location_id = bpl.c_bpartner_location_id)))
     JOIN c_location l ON ((bpl.c_location_id = l.c_location_id)))
     JOIN c_country_trl bpcountry_trl ON (((bpcountry_trl.c_country_id = l.c_country_id) AND ((dt.ad_language)::text = (bpcountry_trl.ad_language)::text))))
     LEFT JOIN ad_user bpc ON ((o.ad_user_id = bpc.ad_user_id)))
     LEFT JOIN c_greeting bpcg ON ((bpc.c_greeting_id = bpcg.c_greeting_id)))
     LEFT JOIN c_greeting_trl bpcgt ON (((bpc.c_greeting_id = bpcgt.c_greeting_id) AND ((dt.ad_language)::text = (bpcgt.ad_language)::text))))
     JOIN ad_orginfo oi ON ((o.ad_org_id = oi.ad_org_id)))
     JOIN c_location ol ON ((oi.c_location_id = ol.c_location_id)))
     JOIN ad_org org ON ((org.ad_org_id = o.ad_org_id)))
     JOIN c_country oc ON ((oc.c_country_id = ol.c_country_id)))
     JOIN c_country_trl oc_trl ON (((oc_trl.c_country_id = ol.c_country_id) AND ((dt.ad_language)::text = (oc_trl.ad_language)::text))))
     JOIN ad_clientinfo ci ON ((o.ad_client_id = ci.ad_client_id)))
     LEFT JOIN ad_user u ON ((o.salesrep_id = u.ad_user_id)))
     LEFT JOIN c_bpartner ubp ON ((u.c_bpartner_id = ubp.c_bpartner_id)))
     JOIN c_bpartner bbp ON ((o.bill_bpartner_id = bbp.c_bpartner_id)))
     JOIN c_bpartner_location bbpl ON ((o.bill_location_id = bbpl.c_bpartner_location_id)))
     LEFT JOIN ad_user bbpc ON ((o.bill_user_id = bbpc.ad_user_id)))
     LEFT JOIN c_currency_trl cur ON (((o.c_currency_id = cur.c_currency_id) AND ((dt.ad_language)::text = (cur.ad_language)::text))))
     LEFT JOIN m_product p ON ((p.m_product_id = o.wmv_product_id)))
     LEFT JOIN wmv_lineformat lf ON ((lf.wmv_lineformat_id = p.wmv_lineformat_id)));
--
-- create view  wmv_inout_header_vt
--
CREATE OR REPLACE VIEW wmv_inout_header_vt AS
 SELECT io.ad_client_id,
    io.ad_org_id,
    io.isactive,
    io.created,
    io.createdby,
    io.updated,
    io.updatedby,
    NULL::character varying AS bankverbindung,
    wmv_textblock('companyinfo'::character varying) AS companyinfo,
    dt.ad_language,
    io.m_inout_id,
    io.issotrx,
    io.documentno,
    io.docstatus,
    io.c_doctype_id,
    io.c_bpartner_id,
    bp.value AS bpvalue,
    bp.taxid AS bptaxid,
    bp.naics,
    bp.duns,
    oi.c_location_id AS org_location_id,
    org.name AS org_name,
    ol.address1 AS org_address1,
    ol.address2 AS org_address2,
    ol.address3 AS org_address3,
    ol.address4 AS org_address4,
    ol.c_country_id AS org_country_id,
    oc.name AS org_country,
    oc.countrycode AS org_countrycode,
    ol.city AS org_city,
    concat((ol.postal)::text, (ol.postal_add)::text) AS org_postal,
    oi.taxid,
    io.m_warehouse_id,
    wh.c_location_id AS warehouse_location_id,
    dt.printname AS documenttype,
    dt.documentnote AS documenttypenote,
    io.c_order_id,
    o.documentno AS order_no,
    io.movementdate,
    io.movementtype,
    bpgt.greeting AS bpgreeting,
    bp.name,
    bp.name2,
    bpcgt.greeting AS bpcontactgreeting,
    bpc.title,
    bpc.phone,
    NULLIF((bpc.name)::text, (bp.name)::text) AS contactname,
    bpl.c_location_id,
    concat((l.postal)::text, (l.postal_add)::text) AS postal,
    bp.referenceno,
    io.description,
    io.poreference,
    io.dateordered,
    io.volume,
    io.weight,
    io.m_shipper_id,
    io.deliveryrule,
    io.deliveryviarule,
    io.priorityrule,
    COALESCE(oi.logo_id, ci.logo_id) AS logo_id,
    io.ad_orgtrx_id,
    io.ad_user_id,
    io.c_activity_id,
    io.c_bpartner_location_id,
    io.c_campaign_id,
    io.c_charge_id,
    io.chargeamt,
    io.c_invoice_id,
    io.c_project_id,
    io.createconfirm,
    io.createfrom,
    io.createpackage,
    io.dateacct,
    io.dateprinted,
    io.datereceived,
    io.docaction,
    io.dropship_bpartner_id,
    io.dropship_location_id,
    io.dropship_user_id,
    io.freightamt,
    io.freightcostrule,
    io.generateto,
    io.isapproved,
    io.isdropship,
    io.isindispute,
    io.isintransit AS m_inout_isintransit,
    io.isprinted,
    io.m_rma_id,
    io.nopackages,
    io.pickdate,
    io.posted,
    io.processed,
    io.processedon,
    io.processing,
    io.ref_inout_id,
    io.reversal_id,
    io.salesrep_id AS m_inout_salesrep_id,
    io.sendemail,
    io.shipdate,
    io.trackingno,
    io.user1_id,
    io.user2_id,
    io.wmv_product_id,
    io.wmv_ghgcertificate_id,
    io.wmv_ghgaudit_id,
    COALESCE(bp.wmv_ghgcertsystem, crt.wmv_ghgcertsystem) AS wmv_ghgcertsystem,
    io.wmv_deliverymethod,
    bp.acqusitioncost AS c_bp_acqusitioncost,
    bp.actuallifetimevalue AS c_bp_actuallifetimevalue,
    bp.ad_language AS c_bp_ad_language,
    bp.ad_orgbp_id AS c_bp_ad_orgbp_id,
    bp.ad_org_id AS c_bp_ad_org_id,
    bp.bpartner_parent_id AS c_bp_bpartner_parent_id,
    bp.c_bp_group_id AS c_bp_c_bp_group_id,
    bp.c_dunning_id AS c_bp_c_dunning_id,
    bp.c_greeting_id AS c_bp_c_greeting_id,
    bp.c_invoiceschedule_id AS c_bp_c_invoiceschedule_id,
    bp.c_paymentterm_id AS c_bp_c_paymentterm_id,
    bp.created AS c_bp_created,
    bp.createdby AS c_bp_createdby,
    bp.c_taxgroup_id AS c_bp_c_taxgroup_id,
    bp.deliveryrule AS c_bp_deliveryrule,
    bp.deliveryviarule AS c_bp_deliveryviarule,
    bp.description AS c_bp_description,
    bp.dunninggrace AS c_bp_dunninggrace,
    bp.firstsale AS c_bp_firstsale,
    bp.flatdiscount AS c_bp_flatdiscount,
    bp.freightcostrule AS c_bp_freightcostrule,
    bp.invoicerule AS c_bp_invoicerule,
    bp.isactive AS c_bp_isactive,
    bp.iscustomer AS c_bp_iscustomer,
    bp.isdiscountprinted AS c_bp_isdiscountprinted,
    bp.isemployee AS c_bp_isemployee,
    bp.ismanufacturer AS c_bp_ismanufacturer,
    bp.isonetime AS c_bp_isonetime,
    bp.ispotaxexempt AS c_bp_ispotaxexempt,
    bp.isprospect AS c_bp_isprospect,
    bp.issalesrep AS c_bp_issalesrep,
    bp.issummary AS c_bp_issummary,
    bp.istaxexempt AS c_bp_istaxexempt,
    bp.isvendor AS c_bp_isvendor,
    bp.logo_id AS c_bp_logo_id,
    bp.m_discountschema_id AS c_bp_m_discountschema_id,
    bp.m_pricelist_id AS c_bp_m_pricelist_id,
    bp.numberemployees AS c_bp_numberemployees,
    bp.paymentrule AS c_bp_paymentrule,
    bp.paymentrulepo AS c_bp_paymentrulepo,
    bp.po_discountschema_id AS c_bp_po_discountschema_id,
    bp.po_paymentterm_id AS c_bp_po_paymentterm_id,
    bp.po_pricelist_id AS c_bp_po_pricelist_id,
    bp.poreference AS c_bp_poreference,
    bp.potentiallifetimevalue AS c_bp_potentiallifetimevalue,
    bp.rating AS c_bp_rating,
    bp.salesrep_id AS c_bp_salesrep_id,
    bp.salesvolume AS c_bp_salesvolume,
    bp.sendemail AS c_bp_sendemail,
    bp.shareofcustomer AS c_bp_shareofcustomer,
    bp.shelflifeminpct AS c_bp_shelflifeminpct,
    bp.so_creditlimit AS c_bp_so_creditlimit,
    bp.socreditstatus AS c_bp_socreditstatus,
    bp.so_creditused AS c_bp_so_creditused,
    bp.so_description AS c_bp_so_description,
    bp.totalopenbalance AS c_bp_totalopenbalance,
    bp.updated AS c_bp_updated,
    bp.updatedby AS c_bp_updatedby,
    bp.url AS c_bp_url,
    bpgt.ad_org_id AS c_greeting_ad_org_id,
    bpgt.isactive AS c_greeting_isactive,
    bpg.isfirstnameonly,
    bpgt.name AS c_greeting_name,
    bpl.ad_org_id AS c_bp_location_ad_org_id,
    bpl.c_bpartner_id AS c_bp_location_c_bpartner_id,
    bpl.created AS c_bp_location_created,
    bpl.createdby AS c_bp_location_createdby,
    bpl.c_salesregion_id,
    bpl.fax AS c_bp_location_fax,
    bpl.isactive AS c_bp_location_isactive,
    bpl.isbillto,
    bpl.isdn,
    bpl.ispayfrom,
    bpl.isremitto,
    bpl.isshipto,
    bpl.name AS c_bp_location_name,
    bpl.phone AS c_bp_location_phone,
    bpl.phone2 AS c_bp_location_phone2,
    bpl.updated AS c_bp_location_updated,
    bpl.updatedby AS c_bp_location_updatedby,
    l.address1,
    l.address2,
    l.address3,
    l.address4,
    l.ad_org_id AS c_location_ad_org_id,
    l.c_city_id,
    l.c_country_id,
    bpcountry_trl.name AS country,
    l.city,
    l.created AS c_location_created,
    l.createdby AS c_location_createdby,
    l.c_region_id,
    l.isactive AS c_location_isactive,
    l.regionname,
    l.updated AS c_location_updated,
    l.updatedby AS c_location_updatedby,
    bpc.ad_org_id AS ad_user_ad_org_id,
    bpc.ad_orgtrx_id AS ad_user_ad_ad_orgtrx_id,
    bpc.birthday AS ad_user_ad_birthday,
    bpc.c_bpartner_id AS ad_user_c_bpartner_id,
    bpc.c_bpartner_location_id AS ad_user_c_bpartner_location_id,
    bpc.c_greeting_id AS ad_user_c_greeting_id,
    bpc.comments AS ad_user_comments,
    bpc.created AS ad_user_created,
    bpc.createdby AS ad_user_createdby,
    bpc.description AS ad_user_description,
    bpc.email AS ad_user_email,
    bpc.fax AS ad_user_fax,
    bpc.isactive AS ad_user_isactive,
    bpc.lastcontact AS ad_user_lastcontact,
    bpc.lastresult AS ad_user_lastresult,
    bpc.phone2 AS ad_user_phone2,
    bpc.supervisor_id AS ad_user_supervisor_id,
    bpc.updated AS ad_user_updated,
    bpc.updatedby AS ad_user_updatedby,
    bpc.value AS ad_user_value,
    bpcgt.ad_org_id AS c_user_greeting_ad_org_id,
    bpcgt.isactive AS c_user_greeting_isactive,
    bpcg.isfirstnameonly AS c_user_greeting_isfnameonly,
    bpcgt.name AS c_user_greeting_name,
    oi.ad_org_id AS ad_orginfo_ad_org_id,
    oi.ad_orgtype_id,
    oi.c_calendar_id,
    oi.created AS ad_orginfo_created,
    oi.createdby AS ad_orginfo_createdby,
    oi.dropship_warehouse_id,
    oi.duns AS ad_orginfo_duns,
    oi.email AS ad_orginfo_email,
    oi.fax AS ad_orginfo_fax,
    oi.isactive AS ad_orginfo_isactive,
    oi.m_warehouse_id AS ad_orginfo_m_warehouse_id,
    oi.parent_org_id,
    oi.phone AS ad_orginfo_phone,
    oi.phone2 AS ad_orginfo_phone2,
    oi.receiptfootermsg,
    oi.supervisor_id,
    oi.updated AS ad_orginfo_updated,
    oi.updatedby AS ad_orginfo_updatedby,
    wh.ad_org_id AS m_warehouse_ad_org_id,
    wh.description AS m_warehouse_description,
    wh.isactive AS m_warehouse__isactive,
    wh.isdisallownegativeinv,
    wh.isintransit AS m_warehouse_isintransit,
    wh.m_warehousesource_id,
    wh.name AS m_warehouse_name,
    wh.replenishmentclass,
    wh.separator,
    wh.value AS m_warehouse_value
   FROM ((((((((((((((((((m_inout io
     JOIN c_doctype_trl dt ON ((io.c_doctype_id = dt.c_doctype_id)))
     JOIN c_bpartner bp ON ((io.c_bpartner_id = bp.c_bpartner_id)))
     LEFT JOIN c_greeting bpg ON ((bp.c_greeting_id = bpg.c_greeting_id)))
     LEFT JOIN c_greeting_trl bpgt ON (((bp.c_greeting_id = bpgt.c_greeting_id) AND ((dt.ad_language)::text = (bpgt.ad_language)::text))))
     JOIN c_bpartner_location bpl ON ((io.c_bpartner_location_id = bpl.c_bpartner_location_id)))
     JOIN c_location l ON ((bpl.c_location_id = l.c_location_id)))
     JOIN c_country_trl bpcountry_trl ON (((bpcountry_trl.c_country_id = l.c_country_id) AND ((dt.ad_language)::text = (bpcountry_trl.ad_language)::text))))
     LEFT JOIN ad_user bpc ON ((io.ad_user_id = bpc.ad_user_id)))
     LEFT JOIN c_greeting bpcg ON ((bpc.c_greeting_id = bpcg.c_greeting_id)))
     LEFT JOIN c_greeting_trl bpcgt ON (((bpc.c_greeting_id = bpcgt.c_greeting_id) AND ((dt.ad_language)::text = (bpcgt.ad_language)::text))))
     JOIN ad_orginfo oi ON ((io.ad_org_id = oi.ad_org_id)))
     JOIN c_location ol ON ((oi.c_location_id = ol.c_location_id)))
     JOIN ad_org org ON ((org.ad_org_id = io.ad_org_id)))
     JOIN c_country oc ON ((oc.c_country_id = ol.c_country_id)))
     JOIN ad_clientinfo ci ON ((io.ad_client_id = ci.ad_client_id)))
     JOIN m_warehouse wh ON ((io.m_warehouse_id = wh.m_warehouse_id)))
     JOIN c_order o ON ((io.c_order_id = o.c_order_id)))
     LEFT JOIN wmv_ghgcertificate crt ON ((crt.wmv_ghgcertificate_id = io.wmv_ghgcertificate_id)));
--
-- create view  wmv_inout_header_v
--
CREATE OR REPLACE VIEW wmv_inout_header_v AS
 SELECT io.ad_client_id,
    io.ad_org_id,
    io.isactive,
    io.created,
    io.createdby,
    io.updated,
    io.updatedby,
    NULL::character varying AS bankverbindung,
    wmv_textblock('companyinfo'::character varying) AS companyinfo,
    'en_US'::character varying AS ad_language,
    io.m_inout_id,
    io.issotrx,
    io.documentno,
    io.docstatus,
    io.c_doctype_id,
    io.c_bpartner_id,
    bp.value AS bpvalue,
    bp.taxid AS bptaxid,
    bp.naics,
    bp.duns,
    oi.c_location_id AS org_location_id,
    org.name AS org_name,
    ol.address1 AS org_address1,
    ol.address2 AS org_address2,
    ol.address3 AS org_address3,
    ol.address4 AS org_address4,
    ol.c_country_id AS org_country_id,
    oc.name AS org_country,
    oc.countrycode AS org_countrycode,
    ol.city AS org_city,
    concat((ol.postal)::text, (ol.postal_add)::text) AS org_postal,
    oi.taxid,
    io.m_warehouse_id,
    wh.c_location_id AS warehouse_location_id,
    dt.printname AS documenttype,
    dt.documentnote AS documenttypenote,
    io.c_order_id,
    o.documentno AS order_no,
    io.movementdate,
    io.movementtype,
    bpg.greeting AS bpgreeting,
    bp.name,
    bp.name2,
    bpcg.greeting AS bpcontactgreeting,
    bpc.title,
    bpc.phone,
    NULLIF((bpc.name)::text, (bp.name)::text) AS contactname,
    bpl.c_location_id,
    concat((l.postal)::text, (l.postal_add)::text) AS postal,
    bp.referenceno,
    io.description,
    io.poreference,
    io.dateordered,
    io.volume,
    io.weight,
    io.m_shipper_id,
    io.deliveryrule,
    io.deliveryviarule,
    io.priorityrule,
    COALESCE(oi.logo_id, ci.logo_id) AS logo_id,
    io.ad_orgtrx_id,
    io.ad_user_id,
    io.c_activity_id,
    io.c_bpartner_location_id,
    io.c_campaign_id,
    io.c_charge_id,
    io.chargeamt,
    io.c_invoice_id,
    io.c_project_id,
    io.createconfirm,
    io.createfrom,
    io.createpackage,
    io.dateacct,
    io.dateprinted,
    io.datereceived,
    io.docaction,
    io.dropship_bpartner_id,
    io.dropship_location_id,
    io.dropship_user_id,
    io.freightamt,
    io.freightcostrule,
    io.generateto,
    io.isapproved,
    io.isdropship,
    io.isindispute,
    io.isintransit AS m_inout_isintransit,
    io.isprinted,
    io.m_rma_id,
    io.nopackages,
    io.pickdate,
    io.posted,
    io.processed,
    io.processedon,
    io.processing,
    io.ref_inout_id,
    io.reversal_id,
    io.salesrep_id AS m_inout_salesrep_id,
    io.sendemail,
    io.shipdate,
    io.trackingno,
    io.user1_id,
    io.user2_id,
    io.wmv_product_id,
    io.wmv_ghgcertificate_id,
    io.wmv_ghgaudit_id,
    COALESCE(bp.wmv_ghgcertsystem, crt.wmv_ghgcertsystem) AS wmv_ghgcertsystem,
    io.wmv_deliverymethod,
    bp.acqusitioncost AS c_bp_acqusitioncost,
    bp.actuallifetimevalue AS c_bp_actuallifetimevalue,
    bp.ad_language AS c_bp_ad_language,
    bp.ad_orgbp_id AS c_bp_ad_orgbp_id,
    bp.ad_org_id AS c_bp_ad_org_id,
    bp.bpartner_parent_id AS c_bp_bpartner_parent_id,
    bp.c_bp_group_id AS c_bp_c_bp_group_id,
    bp.c_dunning_id AS c_bp_c_dunning_id,
    bp.c_greeting_id AS c_bp_c_greeting_id,
    bp.c_invoiceschedule_id AS c_bp_c_invoiceschedule_id,
    bp.c_paymentterm_id AS c_bp_c_paymentterm_id,
    bp.created AS c_bp_created,
    bp.createdby AS c_bp_createdby,
    bp.c_taxgroup_id AS c_bp_c_taxgroup_id,
    bp.deliveryrule AS c_bp_deliveryrule,
    bp.deliveryviarule AS c_bp_deliveryviarule,
    bp.description AS c_bp_description,
    bp.dunninggrace AS c_bp_dunninggrace,
    bp.firstsale AS c_bp_firstsale,
    bp.flatdiscount AS c_bp_flatdiscount,
    bp.freightcostrule AS c_bp_freightcostrule,
    bp.invoicerule AS c_bp_invoicerule,
    bp.isactive AS c_bp_isactive,
    bp.iscustomer AS c_bp_iscustomer,
    bp.isdiscountprinted AS c_bp_isdiscountprinted,
    bp.isemployee AS c_bp_isemployee,
    bp.ismanufacturer AS c_bp_ismanufacturer,
    bp.isonetime AS c_bp_isonetime,
    bp.ispotaxexempt AS c_bp_ispotaxexempt,
    bp.isprospect AS c_bp_isprospect,
    bp.issalesrep AS c_bp_issalesrep,
    bp.issummary AS c_bp_issummary,
    bp.istaxexempt AS c_bp_istaxexempt,
    bp.isvendor AS c_bp_isvendor,
    bp.logo_id AS c_bp_logo_id,
    bp.m_discountschema_id AS c_bp_m_discountschema_id,
    bp.m_pricelist_id AS c_bp_m_pricelist_id,
    bp.numberemployees AS c_bp_numberemployees,
    bp.paymentrule AS c_bp_paymentrule,
    bp.paymentrulepo AS c_bp_paymentrulepo,
    bp.po_discountschema_id AS c_bp_po_discountschema_id,
    bp.po_paymentterm_id AS c_bp_po_paymentterm_id,
    bp.po_pricelist_id AS c_bp_po_pricelist_id,
    bp.poreference AS c_bp_poreference,
    bp.potentiallifetimevalue AS c_bp_potentiallifetimevalue,
    bp.rating AS c_bp_rating,
    bp.salesrep_id AS c_bp_salesrep_id,
    bp.salesvolume AS c_bp_salesvolume,
    bp.sendemail AS c_bp_sendemail,
    bp.shareofcustomer AS c_bp_shareofcustomer,
    bp.shelflifeminpct AS c_bp_shelflifeminpct,
    bp.so_creditlimit AS c_bp_so_creditlimit,
    bp.socreditstatus AS c_bp_socreditstatus,
    bp.so_creditused AS c_bp_so_creditused,
    bp.so_description AS c_bp_so_description,
    bp.totalopenbalance AS c_bp_totalopenbalance,
    bp.updated AS c_bp_updated,
    bp.updatedby AS c_bp_updatedby,
    bp.url AS c_bp_url,
    bpg.ad_org_id AS c_greeting_ad_org_id,
    bpg.isactive AS c_greeting_isactive,
    bpg.isfirstnameonly,
    bpg.name AS c_greeting_name,
    bpl.ad_org_id AS c_bp_location_ad_org_id,
    bpl.c_bpartner_id AS c_bp_location_c_bpartner_id,
    bpl.created AS c_bp_location_created,
    bpl.createdby AS c_bp_location_createdby,
    bpl.c_salesregion_id,
    bpl.fax AS c_bp_location_fax,
    bpl.isactive AS c_bp_location_isactive,
    bpl.isbillto,
    bpl.isdn,
    bpl.ispayfrom,
    bpl.isremitto,
    bpl.isshipto,
    bpl.name AS c_bp_location_name,
    bpl.phone AS c_bp_location_phone,
    bpl.phone2 AS c_bp_location_phone2,
    bpl.updated AS c_bp_location_updated,
    bpl.updatedby AS c_bp_location_updatedby,
    l.address1,
    l.address2,
    l.address3,
    l.address4,
    l.ad_org_id AS c_location_ad_org_id,
    l.c_city_id,
    l.c_country_id,
    bpcountry.name AS country,
    l.city,
    l.created AS c_location_created,
    l.createdby AS c_location_createdby,
    l.c_region_id,
    l.isactive AS c_location_isactive,
    l.regionname,
    l.updated AS c_location_updated,
    l.updatedby AS c_location_updatedby,
    bpc.ad_org_id AS ad_user_ad_org_id,
    bpc.ad_orgtrx_id AS ad_user_ad_ad_orgtrx_id,
    bpc.birthday AS ad_user_ad_birthday,
    bpc.c_bpartner_id AS ad_user_c_bpartner_id,
    bpc.c_bpartner_location_id AS ad_user_c_bpartner_location_id,
    bpc.c_greeting_id AS ad_user_c_greeting_id,
    bpc.comments AS ad_user_comments,
    bpc.created AS ad_user_created,
    bpc.createdby AS ad_user_createdby,
    bpc.description AS ad_user_description,
    bpc.email AS ad_user_email,
    bpc.fax AS ad_user_fax,
    bpc.isactive AS ad_user_isactive,
    bpc.lastcontact AS ad_user_lastcontact,
    bpc.lastresult AS ad_user_lastresult,
    bpc.phone2 AS ad_user_phone2,
    bpc.supervisor_id AS ad_user_supervisor_id,
    bpc.updated AS ad_user_updated,
    bpc.updatedby AS ad_user_updatedby,
    bpc.value AS ad_user_value,
    bpcg.ad_org_id AS c_user_greeting_ad_org_id,
    bpcg.isactive AS c_user_greeting_isactive,
    bpcg.isfirstnameonly AS c_user_greeting_isfnameonly,
    bpcg.name AS c_user_greeting_name,
    oi.ad_org_id AS ad_orginfo_ad_org_id,
    oi.ad_orgtype_id,
    oi.c_calendar_id,
    oi.created AS ad_orginfo_created,
    oi.createdby AS ad_orginfo_createdby,
    oi.dropship_warehouse_id,
    oi.duns AS ad_orginfo_duns,
    oi.email AS ad_orginfo_email,
    oi.fax AS ad_orginfo_fax,
    oi.isactive AS ad_orginfo_isactive,
    oi.m_warehouse_id AS ad_orginfo_m_warehouse_id,
    oi.parent_org_id,
    oi.phone AS ad_orginfo_phone,
    oi.phone2 AS ad_orginfo_phone2,
    oi.receiptfootermsg,
    oi.supervisor_id,
    oi.updated AS ad_orginfo_updated,
    oi.updatedby AS ad_orginfo_updatedby,
    wh.ad_org_id AS m_warehouse_ad_org_id,
    wh.description AS m_warehouse_description,
    wh.isactive AS m_warehouse__isactive,
    wh.isdisallownegativeinv,
    wh.isintransit AS m_warehouse_isintransit,
    wh.m_warehousesource_id,
    wh.name AS m_warehouse_name,
    wh.replenishmentclass,
    wh.separator,
    wh.value AS m_warehouse_value
   FROM ((((((((((((((((m_inout io
     JOIN c_doctype dt ON ((io.c_doctype_id = dt.c_doctype_id)))
     JOIN c_bpartner bp ON ((io.c_bpartner_id = bp.c_bpartner_id)))
     LEFT JOIN c_greeting bpg ON ((bp.c_greeting_id = bpg.c_greeting_id)))
     JOIN c_bpartner_location bpl ON ((io.c_bpartner_location_id = bpl.c_bpartner_location_id)))
     JOIN c_location l ON ((bpl.c_location_id = l.c_location_id)))
     JOIN c_country bpcountry ON ((bpcountry.c_country_id = l.c_country_id)))
     LEFT JOIN ad_user bpc ON ((io.ad_user_id = bpc.ad_user_id)))
     LEFT JOIN c_greeting bpcg ON ((bpc.c_greeting_id = bpcg.c_greeting_id)))
     JOIN ad_orginfo oi ON ((io.ad_org_id = oi.ad_org_id)))
     JOIN c_location ol ON ((oi.c_location_id = ol.c_location_id)))
     JOIN ad_org org ON ((org.ad_org_id = io.ad_org_id)))
     JOIN c_country oc ON ((oc.c_country_id = ol.c_country_id)))
     JOIN ad_clientinfo ci ON ((io.ad_client_id = ci.ad_client_id)))
     JOIN m_warehouse wh ON ((io.m_warehouse_id = wh.m_warehouse_id)))
     JOIN c_order o ON ((io.c_order_id = o.c_order_id)))
     LEFT JOIN wmv_ghgcertificate crt ON ((crt.wmv_ghgcertificate_id = io.wmv_ghgcertificate_id)));
--
-- create view  wmv_order_linetax_v
--
CREATE OR REPLACE VIEW wmv_order_linetax_v AS
 SELECT ol.ad_client_id,
    ol.ad_org_id,
    ol.isactive,
    ol.created,
    ol.createdby,
    ol.updated,
    ol.updatedby,
    'en_US'::character varying(6) AS ad_language,
    ol.c_order_id,
    ol.c_orderline_id,
    ol.c_tax_id,
    t.taxindicator,
    ol.c_bpartner_id,
    ol.c_bpartner_location_id,
    bp.name AS bpname,
    bpl.c_location_id,
    ol.line,
    p.m_product_id,
    po.vendorproductno,
        CASE
            WHEN ((ol.qtyordered <> (0)::numeric) OR (ol.m_product_id IS NOT NULL)) THEN ol.qtyordered
            ELSE NULL::numeric
        END AS qtyordered,
        CASE
            WHEN ((ol.qtyentered <> (0)::numeric) OR (ol.m_product_id IS NOT NULL)) THEN ol.qtyentered
            ELSE NULL::numeric
        END AS qtyentered,
        CASE
            WHEN ((ol.qtyentered <> (0)::numeric) OR (ol.m_product_id IS NOT NULL)) THEN uom.uomsymbol
            ELSE NULL::character varying
        END AS uomsymbol,
    COALESCE(p.wmv_display_precision, uom.stdprecision, (2)::numeric) AS qtyprecision,
    COALESCE(c.name, (((p.name)::text || (productattribute(ol.m_attributesetinstance_id))::text))::character varying, ol.description) AS name,
        CASE
            WHEN (COALESCE(c.name, p.name) IS NOT NULL) THEN ol.description
            ELSE NULL::character varying
        END AS description,
    p.documentnote,
    p.upc,
    p.sku,
    COALESCE(pp.vendorproductno, p.value) AS productvalue,
    ra.description AS resourcedescription,
        CASE
            WHEN ((i.isdiscountprinted = 'Y'::bpchar) AND (ol.pricelist <> (0)::numeric)) THEN ol.pricelist
            ELSE NULL::numeric
        END AS pricelist,
        CASE
            WHEN ((i.isdiscountprinted = 'Y'::bpchar) AND (ol.pricelist <> (0)::numeric) AND (ol.qtyentered <> (0)::numeric)) THEN ((ol.pricelist * ol.qtyordered) / ol.qtyentered)
            ELSE NULL::numeric
        END AS priceenteredlist,
        CASE
            WHEN ((i.isdiscountprinted = 'Y'::bpchar) AND (ol.pricelist > ol.priceactual) AND (ol.pricelist <> (0)::numeric)) THEN (((ol.pricelist - ol.priceactual) / ol.pricelist) * (100)::numeric)
            ELSE NULL::numeric
        END AS discount,
        CASE
            WHEN ((ol.priceactual <> (0)::numeric) OR (ol.m_product_id IS NOT NULL)) THEN ol.priceactual
            ELSE NULL::numeric
        END AS priceactual,
        CASE
            WHEN ((ol.priceentered <> (0)::numeric) OR (ol.m_product_id IS NOT NULL)) THEN ol.priceentered
            ELSE NULL::numeric
        END AS priceentered,
        CASE
            WHEN ((ol.linenetamt <> (0)::numeric) OR (ol.m_product_id IS NOT NULL)) THEN ol.linenetamt
            ELSE NULL::numeric
        END AS linenetamt,
    p.description AS productdescription,
    p.imageurl,
    ol.c_campaign_id,
    ol.c_project_id,
    ol.c_activity_id,
    ol.c_projectphase_id,
    ol.c_projecttask_id,
    ol.ad_orgtrx_id AS c_orderline_ad_orgtrx_id,
    ol.c_charge_id AS c_orderline_c_charge_id,
    ol.c_currency_id AS c_orderline_c_currency_id,
    COALESCE(cur.cursymbol, (cur.iso_code)::character varying) AS cursymbol,
    ol.c_uom_id,
    ol.datedelivered,
    ol.dateinvoiced,
    ol.dateordered,
    ol.datepromised AS c_orderline_datepromised,
    ol.freightamt AS c_orderline_freightamt,
    ol.isdescription,
    ol.link_orderline_id,
    ol.m_promotion_id,
    ol.m_shipper_id AS c_orderline_m_shipper_id,
    ol.m_warehouse_id AS c_orderline_m_warehouse_id,
    ol.pricecost,
    ol.pricelimit,
    ol.processed AS c_orderline_processed,
    ol.qtydelivered,
    ol.qtyinvoiced,
    ol.qtylostsales,
    ol.qtyreserved,
    ol.ref_orderline_id,
    ol.rramt,
    ol.rrstartdate,
    ol.s_resourceassignment_id,
    ol.user1_id AS c_orderline_user1_id,
    ol.user2_id AS c_orderline_user2_id,
    uom.ad_org_id AS c_uom_ad_org_id,
    uom.costingprecision,
    uom.description AS c_uom_description,
    uom.isactive AS c_uom_isactive,
    uom.isdefault,
    uom.name AS c_uom_name,
    uom.stdprecision,
    uom.uomtype,
    uom.x12de355,
    i.ad_org_id AS c_order_ad_org_id,
    i.ad_orgtrx_id AS c_order_ad_orgtrx_id,
    i.ad_user_id,
    i.amountrefunded,
    i.amounttendered,
    i.bill_bpartner_id,
    i.bill_location_id,
    i.bill_user_id,
    i.c_activity_id AS c_order_c_activity_id,
    i.c_bpartner_id AS c_order_c_bpartner_id,
    i.c_campaign_id AS c_order_c_campaign_id,
    i.c_cashline_id,
    i.c_cashplanline_id,
    i.c_charge_id AS c_order_c_charge_id,
    i.c_conversiontype_id,
    i.c_currency_id AS c_order_c_currency_id,
    i.c_doctype_id,
    i.c_doctypetarget_id,
    i.chargeamt,
    i.copyfrom,
    i.c_payment_id,
    i.c_paymentterm_id,
    i.c_pos_id,
    i.c_project_id AS c_order_c_project_id,
    i.created AS c_order_created,
    i.createdby AS c_order_createdby,
    i.dateacct,
    i.dateprinted,
    i.datepromised AS c_order_datepromised,
    i.deliveryrule,
    i.deliveryviarule,
    i.description AS c_order_description,
    i.docaction,
    i.docstatus,
    i.documentno,
    i.dropship_bpartner_id,
    i.dropship_location_id,
    i.dropship_user_id,
    i.freightamt AS c_order_freightamt,
    i.freightcostrule,
    i.grandtotal,
    i.invoicerule,
    i.isactive AS c_order_isactive,
    i.isapproved,
    i.iscreditapproved,
    i.isdelivered,
    i.isdiscountprinted AS c_order_isdiscountprinted,
    i.isdropship AS c_order_isdropship,
    i.isinvoiced,
    i.ispayschedulevalid,
    i.isprinted,
    i.isselected,
    i.isselfservice AS c_order_isselfservice,
    i.issotrx,
    i.istaxincluded,
    i.istransferred,
    i.link_order_id,
    i.m_freightcategory_id AS c_order_m_freightcategory_id,
    i.m_pricelist_id AS c_order_m_pricelist_id,
    i.m_shipper_id AS c_order_m_shipper_id,
    i.m_warehouse_id AS c_order_m_warehouse_id,
    i.ordertype,
    i.pay_bpartner_id,
    i.pay_location_id,
    i.paymentrule AS c_order_paymentrule,
    i.poreference,
    i.posted,
    i.priorityrule,
    i.processed AS c_order_processed,
    i.processedon,
    i.promotioncode,
    i.ref_order_id,
    i.salesrep_id,
    i.sendemail AS c_order_sendemail,
    i.totallines,
    i.updated AS c_order_updated,
    i.updatedby AS c_order_updatedby,
    i.user1_id AS c_order_user1_id,
    i.user2_id AS c_order_user2_id,
    i.volume AS c_order_volume,
    i.weight AS c_order_weight,
    p.ad_org_id AS m_product_ad_org_id,
    p.classification,
    p.copyfrom AS m_product_copyfrom,
    p.created AS m_product_created,
    p.createdby AS m_product_createdby,
    p.c_revenuerecognition_id,
    p.c_subscriptiontype_id,
    p.c_taxcategory_id,
    p.c_uom_id AS m_product_c_uom_id,
    p.descriptionurl,
    p.discontinued AS m_product_discontinued,
    p.discontinuedat AS m_product_discontinuedat,
    p.group1,
    p.group2,
    p.guaranteedays,
    p.guaranteedaysmin,
    p.help,
    p.isactive AS m_product_isactive,
    p.isbom,
    p.isdropship AS m_product_isdropship,
    p.isexcludeautodelivery,
    p.isinvoiceprintdetails,
    p.ispicklistprintdetails,
    p.ispurchased,
    p.isselfservice AS m_product_isselfservice,
    p.issold,
    p.isstocked,
    p.issummary AS m_product_issummary,
    p.isverified,
    p.iswebstorefeatured,
    p.lowlevel,
    p.m_attributeset_id,
    p.m_attributesetinstance_id,
    p.m_freightcategory_id AS m_product_m_freightcategory_id,
    p.m_locator_id,
    p.m_product_category_id AS m_product_product_category_id,
    p.processing AS m_product_processing,
    p.producttype,
    p.r_mailtext_id,
    p.salesrep_id AS m_product_salesrep_id,
    p.s_expensetype_id,
    p.shelfdepth,
    p.shelfheight,
    p.shelfwidth,
    p.s_resource_id,
    p.unitsperpack,
    p.unitsperpallet,
    p.updated AS m_product_updated,
    p.updatedby AS m_product_updatedby,
    p.versionno,
    p.volume AS m_product_volume,
    p.weight AS m_product_weight,
    po.ad_org_id AS m_product_po_ad_org_id,
    po.c_bpartner_id AS m_product_po_c_bpartner_id,
    po.c_currency_id AS m_product_po_c_currency_id,
    po.costperorder,
    po.created AS m_product_po_created,
    po.createdby AS m_product_po_createdby,
    po.c_uom_id AS m_product_po_c_uom_id,
    po.deliverytime_actual,
    po.deliverytime_promised,
    po.discontinued AS m_product_po_discontinued,
    po.discontinuedat AS m_product_po_discontinuedat,
    po.isactive AS m_product_po_isactive,
    po.iscurrentvendor,
    po.manufacturer AS m_product_po_manufacturer,
    po.m_product_id AS m_product_po_m_product_id,
    po.order_min,
    po.order_pack,
    po.priceeffective,
    po.pricelastinv,
    po.pricelastpo,
    po.pricelist AS m_product_po_pricelist,
    po.pricepo,
    po.qualityrating AS m_product_po_qualityrating,
    po.royaltyamt,
    po.upc AS m_product_po_upc,
    po.updated AS m_product_po_updated,
    po.updatedby AS m_product_po_updatedby,
    po.vendorcategory AS m_product_po_vendorcategory,
    ra.ad_org_id AS s_resourceassignment_ad_org_id,
    ra.assigndatefrom,
    ra.assigndateto,
    ra.created AS s_resourceassignment_created,
    ra.createdby AS s_resourceassignment_createby,
    ra.isactive AS s_resourceassignment_isactive,
    ra.isconfirmed,
    ra.name AS s_resourceassignment_name,
    ra.qty AS s_resourceassignment_qty,
    ra.s_resource_id AS s_resourceassignment_s_resour,
    ra.updated AS s_resourceassignment_updated,
    ra.updatedby AS s_resourceassignment_updatedby,
    c.ad_org_id AS c_charge_c_org_id,
    c.c_bpartner_id AS c_charge_c_bpartner_id,
    c.c_chargetype_id,
    c.chargeamt AS c_charge_chargeamt,
    c.c_taxcategory_id AS c_charge_c_taxcategory_id,
    c.description AS c_charge_description,
    c.isactive AS c_charge_isactive,
    c.issamecurrency,
    c.issametax,
    c.istaxincluded AS c_charge_istaxincluded,
    pp.ad_org_id AS c_bpartner_product_ad_org_id,
    pp.c_bpartner_id AS c_bp_product_c_bpartner_id,
    pp.created AS c_bpartner_product_created,
    pp.createdby AS c_bpartner_product_createdby,
    pp.description AS c_bpartner_product_description,
    pp.isactive AS c_bpartner_product_isactive,
    pp.ismanufacturer,
    pp.manufacturer AS c_bpartner_product_manufactur,
    pp.qualityrating AS c_bpartner_product_qualityrat,
    pp.shelflifemindays,
    pp.shelflifeminpct AS c_bpartner_product_shelflifem,
    pp.updated AS c_bpartner_product_updated,
    pp.updatedby AS c_bpartner_product_updatedby,
    pp.vendorcategory AS c_bpartner_product_vendorcate,
    bp.acqusitioncost,
    bp.actuallifetimevalue,
    bp.ad_language AS c_bpartner_ad_language,
    bp.ad_orgbp_id,
    bp.ad_org_id AS c_bpartner_ad_org_id,
    bp.bpartner_parent_id,
    bp.c_bp_group_id,
    bp.c_dunning_id,
    bp.c_greeting_id,
    bp.c_invoiceschedule_id,
    bp.c_paymentterm_id AS c_bpartner_c_paymentterm_id,
    bp.created AS c_bpartner_created,
    bp.createdby AS c_bpartner_createdby,
    bp.c_taxgroup_id AS c_bpartner_c_taxgroup_id,
    bp.deliveryrule AS c_bpartner_deliveryrule,
    bp.deliveryviarule AS c_bpartner_deliveryviarule,
    bp.description AS c_bpartner_description,
    bp.dunninggrace AS c_bpartner_dunninggrace,
    bp.duns,
    bp.firstsale AS c_bpartner_firstsale,
    bp.flatdiscount AS c_bpartner_flatdiscount,
    bp.freightcostrule AS c_bpartner_freightcostrule,
    bp.invoicerule AS c_bpartner_invoicerule,
    bp.isactive AS c_bpartner_isactive,
    bp.iscustomer,
    bp.isdiscountprinted AS c_bpartner_isdiscountprinted,
    bp.isemployee AS c_bpartner_isemployee,
    bp.ismanufacturer AS c_bpartner_ismanufacturer,
    bp.isonetime,
    bp.ispotaxexempt,
    bp.isprospect,
    bp.issalesrep,
    bp.issummary AS c_bpartner_issummary,
    bp.istaxexempt AS c_bpartner_istaxexempt,
    bp.isvendor,
    bp.logo_id,
    bp.m_discountschema_id,
    bp.m_pricelist_id AS c_bpartner_m_pricelist_id,
    bp.naics,
    bp.name AS c_bpartner_name,
    bp.name2 AS c_bpartner_name2,
    bp.numberemployees,
    bp.paymentrule AS c_bpartner_paymentrule,
    bp.paymentrulepo,
    bp.po_discountschema_id,
    bp.po_paymentterm_id,
    bp.po_pricelist_id,
    bp.poreference AS c_bpartner_poreference,
    bp.potentiallifetimevalue,
    bp.rating AS c_bpartner_rating,
    bp.referenceno AS c_bpartner_referenceno,
    bp.salesrep_id AS c_bpartner_salesrep_id,
    bp.salesvolume,
    bp.sendemail AS c_bpartner_sendemail,
    bp.shareofcustomer,
    bp.shelflifeminpct AS c_bpartner_shelflifeminpct,
    bp.so_creditlimit,
    bp.socreditstatus,
    bp.so_creditused,
    bp.so_description,
    bp.taxid AS c_bpartner_taxid,
    bp.totalopenbalance,
    bp.updated AS c_bpartner_updated,
    bp.updatedby AS c_bpartner_updatedby,
    bp.url AS c_bpartner_url,
    bp.value AS c_bpartner_value,
    bpl.ad_org_id AS c_bpartner_location_ad_org_id,
    bpl.c_bpartner_id AS c_bpartner_location_c_bpartne,
    bpl.created AS c_bpartner_location_created,
    bpl.createdby AS c_bpartner_location_createdby,
    bpl.c_salesregion_id,
    bpl.fax AS c_bpartner_location_fax,
    bpl.isactive AS c_bpartner_location_isactive,
    bpl.isbillto,
    bpl.isdn,
    bpl.ispayfrom,
    bpl.isremitto,
    bpl.isshipto,
    bpl.name AS c_bpartner_location_name,
    bpl.phone AS c_bpartner_location_phone,
    bpl.phone2 AS c_bpartner_location_phone2,
    bpl.updated AS c_bpartner_location_updated,
    bpl.updatedby AS c_bpartner_location_updatedby,
    t.ad_org_id AS c_tax_ad_org_id,
    t.ad_rule_id,
    t.c_country_id,
    t.c_region_id,
    t.c_taxcategory_id AS c_tax_c_taxcategory_id,
    t.description AS c_tax_description,
    t.isactive AS c_tax_isactive,
    t.isdefault AS c_tax_isdefault,
    t.isdocumentlevel,
    t.issalestax,
    t.issummary AS c_tax_issummary,
    t.istaxexempt AS c_tax_istaxexempt,
    t.name AS c_tax_name,
    t.parent_tax_id,
    t.rate,
    t.requirestaxcertificate,
    t.sopotype,
    t.to_country_id,
    t.to_region_id AS c_tax_to_region_id,
    t.validfrom
   FROM (((((((((((c_orderline ol
     JOIN c_uom uom ON ((ol.c_uom_id = uom.c_uom_id)))
     JOIN c_order i ON ((ol.c_order_id = i.c_order_id)))
     LEFT JOIN m_product p ON ((ol.m_product_id = p.m_product_id)))
     LEFT JOIN m_product_po po ON (((p.m_product_id = po.m_product_id) AND (i.c_bpartner_id = po.c_bpartner_id))))
     LEFT JOIN s_resourceassignment ra ON ((ol.s_resourceassignment_id = ra.s_resourceassignment_id)))
     LEFT JOIN c_charge c ON ((ol.c_charge_id = c.c_charge_id)))
     LEFT JOIN c_bpartner_product pp ON (((ol.m_product_id = pp.m_product_id) AND (i.c_bpartner_id = pp.c_bpartner_id))))
     JOIN c_bpartner bp ON ((ol.c_bpartner_id = bp.c_bpartner_id)))
     JOIN c_bpartner_location bpl ON ((ol.c_bpartner_location_id = bpl.c_bpartner_location_id)))
     LEFT JOIN c_tax t ON ((ol.c_tax_id = t.c_tax_id)))
     LEFT JOIN c_currency cur ON ((ol.c_currency_id = cur.c_currency_id)))
UNION
 SELECT ol.ad_client_id,
    ol.ad_org_id,
    ol.isactive,
    ol.created,
    ol.createdby,
    ol.updated,
    ol.updatedby,
    'en_US'::character varying(6) AS ad_language,
    ol.c_order_id,
    ol.c_orderline_id,
    ol.c_tax_id,
    NULL::character varying AS taxindicator,
    NULL::numeric AS c_bpartner_id,
    NULL::numeric AS c_bpartner_location_id,
    NULL::character varying AS bpname,
    NULL::numeric AS c_location_id,
    (ol.line + (bl.line / (100)::numeric)) AS line,
    p.m_product_id,
    po.vendorproductno,
        CASE
            WHEN (bl.isqtypercentage = 'N'::bpchar) THEN (ol.qtyordered * bl.qtybom)
            ELSE (ol.qtyordered * (bl.qtybatch / (100)::numeric))
        END AS qtyordered,
        CASE
            WHEN (bl.isqtypercentage = 'N'::bpchar) THEN (ol.qtyentered * bl.qtybom)
            ELSE (ol.qtyentered * (bl.qtybatch / (100)::numeric))
        END AS qtyentered,
    uom.uomsymbol,
    COALESCE(p.wmv_display_precision, uom.stdprecision, (2)::numeric) AS qtyprecision,
    p.name,
    bl.description,
    p.documentnote,
    p.upc,
    p.sku,
    p.value AS productvalue,
    NULL::character varying AS resourcedescription,
    NULL::numeric AS pricelist,
    NULL::numeric AS priceenteredlist,
    NULL::numeric AS discount,
    NULL::numeric AS priceactual,
    NULL::numeric AS priceentered,
    NULL::numeric AS linenetamt,
    p.description AS productdescription,
    p.imageurl,
    ol.c_campaign_id,
    ol.c_project_id,
    ol.c_activity_id,
    ol.c_projectphase_id,
    ol.c_projecttask_id,
    ol.ad_orgtrx_id AS c_orderline_ad_orgtrx_id,
    ol.c_charge_id AS c_orderline_c_charge_id,
    ol.c_currency_id AS c_orderline_c_currency_id,
    COALESCE(cur.cursymbol, (cur.iso_code)::character varying) AS cursymbol,
    ol.c_uom_id,
    ol.datedelivered,
    ol.dateinvoiced,
    ol.dateordered,
    ol.datepromised AS c_orderline_datepromised,
    ol.freightamt AS c_orderline_freightamt,
    ol.isdescription,
    ol.link_orderline_id,
    ol.m_promotion_id,
    ol.m_shipper_id AS c_orderline_m_shipper_id,
    ol.m_warehouse_id AS c_orderline_m_warehouse_id,
    ol.pricecost,
    ol.pricelimit,
    ol.processed AS c_orderline_processed,
    ol.qtydelivered,
    ol.qtyinvoiced,
    ol.qtylostsales,
    ol.qtyreserved,
    ol.ref_orderline_id,
    ol.rramt,
    ol.rrstartdate,
    ol.s_resourceassignment_id,
    ol.user1_id AS c_orderline_user1_id,
    ol.user2_id AS c_orderline_user2_id,
    uom.ad_org_id AS c_uom_ad_org_id,
    uom.costingprecision,
    uom.description AS c_uom_description,
    uom.isactive AS c_uom_isactive,
    uom.isdefault,
    uom.name AS c_uom_name,
    uom.stdprecision,
    uom.uomtype,
    uom.x12de355,
    i.ad_org_id AS c_order_ad_org_id,
    i.ad_orgtrx_id AS c_order_ad_orgtrx_id,
    i.ad_user_id,
    i.amountrefunded,
    i.amounttendered,
    i.bill_bpartner_id,
    i.bill_location_id,
    i.bill_user_id,
    i.c_activity_id AS c_order_c_activity_id,
    i.c_bpartner_id AS c_order_c_bpartner_id,
    i.c_campaign_id AS c_order_c_campaign_id,
    i.c_cashline_id,
    i.c_cashplanline_id,
    i.c_charge_id AS c_order_c_charge_id,
    i.c_conversiontype_id,
    i.c_currency_id AS c_order_c_currency_id,
    i.c_doctype_id,
    i.c_doctypetarget_id,
    i.chargeamt,
    i.copyfrom,
    i.c_payment_id,
    i.c_paymentterm_id,
    i.c_pos_id,
    i.c_project_id AS c_order_c_project_id,
    i.created AS c_order_created,
    i.createdby AS c_order_createdby,
    i.dateacct,
    i.dateprinted,
    i.datepromised AS c_order_datepromised,
    i.deliveryrule,
    i.deliveryviarule,
    i.description AS c_order_description,
    i.docaction,
    i.docstatus,
    i.documentno,
    i.dropship_bpartner_id,
    i.dropship_location_id,
    i.dropship_user_id,
    i.freightamt AS c_order_freightamt,
    i.freightcostrule,
    i.grandtotal,
    i.invoicerule,
    i.isactive AS c_order_isactive,
    i.isapproved,
    i.iscreditapproved,
    i.isdelivered,
    i.isdiscountprinted AS c_order_isdiscountprinted,
    i.isdropship AS c_order_isdropship,
    i.isinvoiced,
    i.ispayschedulevalid,
    i.isprinted,
    i.isselected,
    i.isselfservice AS c_order_isselfservice,
    i.issotrx,
    i.istaxincluded,
    i.istransferred,
    i.link_order_id,
    i.m_freightcategory_id AS c_order_m_freightcategory_id,
    i.m_pricelist_id AS c_order_m_pricelist_id,
    i.m_shipper_id AS c_order_m_shipper_id,
    i.m_warehouse_id AS c_order_m_warehouse_id,
    i.ordertype,
    i.pay_bpartner_id,
    i.pay_location_id,
    i.paymentrule AS c_order_paymentrule,
    i.poreference,
    i.posted,
    i.priorityrule,
    i.processed AS c_order_processed,
    i.processedon,
    i.promotioncode,
    i.ref_order_id,
    i.salesrep_id,
    i.sendemail AS c_order_sendemail,
    i.totallines,
    i.updated AS c_order_updated,
    i.updatedby AS c_order_updatedby,
    i.user1_id AS c_order_user1_id,
    i.user2_id AS c_order_user2_id,
    i.volume AS c_order_volume,
    i.weight AS c_order_weight,
    p.ad_org_id AS m_product_ad_org_id,
    p.classification,
    p.copyfrom AS m_product_copyfrom,
    p.created AS m_product_created,
    p.createdby AS m_product_createdby,
    p.c_revenuerecognition_id,
    p.c_subscriptiontype_id,
    p.c_taxcategory_id,
    p.c_uom_id AS m_product_c_uom_id,
    p.descriptionurl,
    p.discontinued AS m_product_discontinued,
    p.discontinuedat AS m_product_discontinuedat,
    p.group1,
    p.group2,
    p.guaranteedays,
    p.guaranteedaysmin,
    p.help,
    p.isactive AS m_product_isactive,
    p.isbom,
    p.isdropship AS m_product_isdropship,
    p.isexcludeautodelivery,
    p.isinvoiceprintdetails,
    p.ispicklistprintdetails,
    p.ispurchased,
    p.isselfservice AS m_product_isselfservice,
    p.issold,
    p.isstocked,
    p.issummary AS m_product_issummary,
    p.isverified,
    p.iswebstorefeatured,
    p.lowlevel,
    p.m_attributeset_id,
    p.m_attributesetinstance_id,
    p.m_freightcategory_id AS m_product_m_freightcategory_id,
    p.m_locator_id,
    p.m_product_category_id AS m_product_product_category_id,
    p.processing AS m_product_processing,
    p.producttype,
    p.r_mailtext_id,
    p.salesrep_id AS m_product_salesrep_id,
    p.s_expensetype_id,
    p.shelfdepth,
    p.shelfheight,
    p.shelfwidth,
    p.s_resource_id,
    p.unitsperpack,
    p.unitsperpallet,
    p.updated AS m_product_updated,
    p.updatedby AS m_product_updatedby,
    p.versionno,
    p.volume AS m_product_volume,
    p.weight AS m_product_weight,
    po.ad_org_id AS m_product_po_ad_org_id,
    po.c_bpartner_id AS m_product_po_c_bpartner_id,
    po.c_currency_id AS m_product_po_c_currency_id,
    po.costperorder,
    po.created AS m_product_po_created,
    po.createdby AS m_product_po_createdby,
    po.c_uom_id AS m_product_po_c_uom_id,
    po.deliverytime_actual,
    po.deliverytime_promised,
    po.discontinued AS m_product_po_discontinued,
    po.discontinuedat AS m_product_po_discontinuedat,
    po.isactive AS m_product_po_isactive,
    po.iscurrentvendor,
    po.manufacturer AS m_product_po_manufacturer,
    po.m_product_id AS m_product_po_m_product_id,
    po.order_min,
    po.order_pack,
    po.priceeffective,
    po.pricelastinv,
    po.pricelastpo,
    po.pricelist AS m_product_po_pricelist,
    po.pricepo,
    po.qualityrating AS m_product_po_qualityrating,
    po.royaltyamt,
    po.upc AS m_product_po_upc,
    po.updated AS m_product_po_updated,
    po.updatedby AS m_product_po_updatedby,
    po.vendorcategory AS m_product_po_vendorcategory,
    NULL::numeric AS s_resourceassignment_ad_org_id,
    NULL::timestamp without time zone AS assigndatefrom,
    NULL::timestamp without time zone AS assigndateto,
    NULL::timestamp without time zone AS s_resourceassignment_created,
    NULL::numeric AS s_resourceassignment_createby,
    NULL::bpchar AS s_resourceassignment_isactive,
    NULL::bpchar AS isconfirmed,
    NULL::character varying AS s_resourceassignment_name,
    NULL::numeric AS s_resourceassignment_qty,
    NULL::numeric AS s_resourceassignment_s_resour,
    NULL::timestamp without time zone AS s_resourceassignment_updated,
    NULL::numeric AS s_resourceassignment_updatedby,
    NULL::numeric AS c_charge_c_org_id,
    NULL::numeric AS c_charge_c_bpartner_id,
    NULL::numeric AS c_chargetype_id,
    NULL::numeric AS c_charge_chargeamt,
    NULL::numeric AS c_charge_c_taxcategory_id,
    NULL::character varying AS c_charge_description,
    NULL::bpchar AS c_charge_isactive,
    NULL::bpchar AS issamecurrency,
    NULL::bpchar AS issametax,
    NULL::bpchar AS c_charge_istaxincluded,
    NULL::numeric AS c_bpartner_product_ad_org_id,
    NULL::numeric AS c_bp_product_c_bpartner_id,
    NULL::timestamp without time zone AS c_bpartner_product_created,
    NULL::numeric AS c_bpartner_product_createdby,
    NULL::character varying AS c_bpartner_product_description,
    NULL::bpchar AS c_bpartner_product_isactive,
    NULL::bpchar AS ismanufacturer,
    NULL::character varying AS c_bpartner_product_manufactur,
    NULL::numeric AS c_bpartner_product_qualityrat,
    NULL::numeric AS shelflifemindays,
    NULL::numeric AS c_bpartner_product_shelflifem,
    NULL::timestamp without time zone AS c_bpartner_product_updated,
    NULL::numeric AS c_bpartner_product_updatedby,
    NULL::character varying AS c_bpartner_product_vendorcate,
    NULL::numeric AS acqusitioncost,
    NULL::numeric AS actuallifetimevalue,
    NULL::character varying AS c_bpartner_ad_language,
    NULL::numeric AS ad_orgbp_id,
    NULL::numeric AS c_bpartner_ad_org_id,
    NULL::numeric AS bpartner_parent_id,
    NULL::numeric AS c_bp_group_id,
    NULL::numeric AS c_dunning_id,
    NULL::numeric AS c_greeting_id,
    NULL::numeric AS c_invoiceschedule_id,
    NULL::numeric AS c_bpartner_c_paymentterm_id,
    NULL::timestamp without time zone AS c_bpartner_created,
    NULL::numeric AS c_bpartner_createdby,
    NULL::numeric AS c_bpartner_c_taxgroup_id,
    NULL::bpchar AS c_bpartner_deliveryrule,
    NULL::bpchar AS c_bpartner_deliveryviarule,
    NULL::character varying AS c_bpartner_description,
    NULL::date AS c_bpartner_dunninggrace,
    NULL::bpchar AS duns,
    NULL::timestamp without time zone AS c_bpartner_firstsale,
    NULL::numeric AS c_bpartner_flatdiscount,
    NULL::bpchar AS c_bpartner_freightcostrule,
    NULL::bpchar AS c_bpartner_invoicerule,
    NULL::bpchar AS c_bpartner_isactive,
    NULL::bpchar AS iscustomer,
    NULL::bpchar AS c_bpartner_isdiscountprinted,
    NULL::bpchar AS c_bpartner_isemployee,
    NULL::bpchar AS c_bpartner_ismanufacturer,
    NULL::bpchar AS isonetime,
    NULL::bpchar AS ispotaxexempt,
    NULL::bpchar AS isprospect,
    NULL::bpchar AS issalesrep,
    NULL::bpchar AS c_bpartner_issummary,
    NULL::bpchar AS c_bpartner_istaxexempt,
    NULL::bpchar AS isvendor,
    NULL::numeric AS logo_id,
    NULL::numeric AS m_discountschema_id,
    NULL::numeric AS c_bpartner_m_pricelist_id,
    NULL::bpchar AS naics,
    NULL::character varying AS c_bpartner_name,
    NULL::character varying AS c_bpartner_name2,
    NULL::numeric AS numberemployees,
    NULL::bpchar AS c_bpartner_paymentrule,
    NULL::bpchar AS paymentrulepo,
    NULL::numeric AS po_discountschema_id,
    NULL::numeric AS po_paymentterm_id,
    NULL::numeric AS po_pricelist_id,
    NULL::character varying AS c_bpartner_poreference,
    NULL::numeric AS potentiallifetimevalue,
    NULL::bpchar AS c_bpartner_rating,
    NULL::character varying AS c_bpartner_referenceno,
    NULL::numeric AS c_bpartner_salesrep_id,
    NULL::numeric AS salesvolume,
    NULL::bpchar AS c_bpartner_sendemail,
    NULL::numeric AS shareofcustomer,
    NULL::numeric AS c_bpartner_shelflifeminpct,
    NULL::numeric AS so_creditlimit,
    NULL::bpchar AS socreditstatus,
    NULL::numeric AS so_creditused,
    NULL::character varying AS so_description,
    NULL::character varying AS c_bpartner_taxid,
    NULL::numeric AS totalopenbalance,
    NULL::timestamp without time zone AS c_bpartner_updated,
    NULL::numeric AS c_bpartner_updatedby,
    NULL::character varying AS c_bpartner_url,
    NULL::character varying AS c_bpartner_value,
    NULL::numeric AS c_bpartner_location_ad_org_id,
    NULL::numeric AS c_bpartner_location_c_bpartne,
    NULL::timestamp without time zone AS c_bpartner_location_created,
    NULL::numeric AS c_bpartner_location_createdby,
    NULL::numeric AS c_salesregion_id,
    NULL::character varying AS c_bpartner_location_fax,
    NULL::bpchar AS c_bpartner_location_isactive,
    NULL::bpchar AS isbillto,
    NULL::character varying AS isdn,
    NULL::bpchar AS ispayfrom,
    NULL::bpchar AS isremitto,
    NULL::bpchar AS isshipto,
    NULL::character varying AS c_bpartner_location_name,
    NULL::character varying AS c_bpartner_location_phone,
    NULL::character varying AS c_bpartner_location_phone2,
    NULL::timestamp without time zone AS c_bpartner_location_updated,
    NULL::numeric AS c_bpartner_location_updatedby,
    NULL::numeric AS c_tax_ad_org_id,
    NULL::numeric AS ad_rule_id,
    NULL::numeric AS c_country_id,
    NULL::numeric AS c_region_id,
    NULL::numeric AS c_tax_c_taxcategory_id,
    NULL::character varying AS c_tax_description,
    NULL::bpchar AS c_tax_isactive,
    NULL::bpchar AS c_tax_isdefault,
    NULL::bpchar AS isdocumentlevel,
    NULL::bpchar AS issalestax,
    NULL::bpchar AS c_tax_issummary,
    NULL::bpchar AS c_tax_istaxexempt,
    NULL::character varying AS c_tax_name,
    NULL::numeric AS parent_tax_id,
    NULL::numeric AS rate,
    NULL::bpchar AS requirestaxcertificate,
    NULL::bpchar AS sopotype,
    NULL::numeric AS to_country_id,
    NULL::numeric AS c_tax_to_region_id,
    NULL::timestamp without time zone AS validfrom
   FROM ((((((((pp_product_bom b
     JOIN c_orderline ol ON ((b.m_product_id = ol.m_product_id)))
     JOIN c_order i ON ((ol.c_order_id = i.c_order_id)))
     JOIN m_product bp ON (((bp.m_product_id = ol.m_product_id) AND (bp.isbom = 'Y'::bpchar) AND (bp.isverified = 'Y'::bpchar) AND (bp.isinvoiceprintdetails = 'Y'::bpchar))))
     JOIN pp_product_bomline bl ON ((bl.pp_product_bom_id = b.pp_product_bom_id)))
     JOIN m_product p ON ((p.m_product_id = bl.m_product_id)))
     LEFT JOIN m_product_po po ON (((p.m_product_id = po.m_product_id) AND (i.c_bpartner_id = po.c_bpartner_id))))
     JOIN c_uom uom ON ((p.c_uom_id = uom.c_uom_id)))
     LEFT JOIN c_currency cur ON ((ol.c_currency_id = cur.c_currency_id)))
UNION
 SELECT i.ad_client_id,
    i.ad_org_id,
    i.isactive,
    i.created,
    i.createdby,
    i.updated,
    i.updatedby,
    'en_US'::character varying(6) AS ad_language,
    i.c_order_id,
    NULL::numeric AS c_orderline_id,
    NULL::numeric AS c_tax_id,
    NULL::character varying AS taxindicator,
    NULL::numeric AS c_bpartner_id,
    NULL::numeric AS c_bpartner_location_id,
    NULL::character varying AS bpname,
    NULL::numeric AS c_location_id,
    NULL::numeric AS line,
    NULL::numeric AS m_product_id,
    NULL::character varying AS vendorproductno,
    NULL::numeric AS qtyordered,
    NULL::numeric AS qtyentered,
    NULL::character varying AS uomsymbol,
    NULL::integer AS qtyprecision,
    NULL::character varying AS name,
    NULL::character varying AS description,
    NULL::character varying AS documentnote,
    NULL::character varying AS upc,
    NULL::character varying AS sku,
    NULL::character varying AS productvalue,
    NULL::character varying AS resourcedescription,
    NULL::numeric AS pricelist,
    NULL::numeric AS priceenteredlist,
    NULL::numeric AS discount,
    NULL::numeric AS priceactual,
    NULL::numeric AS priceentered,
    NULL::numeric AS linenetamt,
    NULL::character varying AS productdescription,
    NULL::character varying AS imageurl,
    NULL::numeric AS c_campaign_id,
    NULL::numeric AS c_project_id,
    NULL::numeric AS c_activity_id,
    NULL::numeric AS c_projectphase_id,
    NULL::numeric AS c_projecttask_id,
    NULL::numeric AS c_orderline_ad_orgtrx_id,
    NULL::numeric AS c_orderline_c_charge_id,
    NULL::numeric AS c_orderline_c_currency_id,
    NULL::character varying AS cursymbol,
    NULL::numeric AS c_uom_id,
    NULL::timestamp without time zone AS datedelivered,
    NULL::timestamp without time zone AS dateinvoiced,
    NULL::timestamp without time zone AS dateordered,
    NULL::timestamp without time zone AS c_orderline_datepromised,
    NULL::numeric AS c_orderline_freightamt,
    NULL::bpchar AS isdescription,
    NULL::numeric AS link_orderline_id,
    NULL::numeric AS m_promotion_id,
    NULL::numeric AS c_orderline_m_shipper_id,
    NULL::numeric AS c_orderline_m_warehouse_id,
    NULL::numeric AS pricecost,
    NULL::numeric AS pricelimit,
    NULL::bpchar AS c_orderline_processed,
    NULL::numeric AS qtydelivered,
    NULL::numeric AS qtyinvoiced,
    NULL::numeric AS qtylostsales,
    NULL::numeric AS qtyreserved,
    NULL::numeric AS ref_orderline_id,
    NULL::numeric AS rramt,
    NULL::timestamp without time zone AS rrstartdate,
    NULL::numeric AS s_resourceassignment_id,
    NULL::numeric AS c_orderline_user1_id,
    NULL::numeric AS c_orderline_user2_id,
    NULL::numeric AS c_uom_ad_org_id,
    NULL::numeric AS costingprecision,
    NULL::character varying AS c_uom_description,
    NULL::bpchar AS c_uom_isactive,
    NULL::bpchar AS isdefault,
    NULL::character varying AS c_uom_name,
    NULL::numeric AS stdprecision,
    NULL::character varying AS uomtype,
    NULL::character varying AS x12de355,
    NULL::numeric AS c_order_ad_org_id,
    NULL::numeric AS c_order_ad_orgtrx_id,
    NULL::numeric AS ad_user_id,
    NULL::numeric AS amountrefunded,
    NULL::numeric AS amounttendered,
    NULL::numeric AS bill_bpartner_id,
    NULL::numeric AS bill_location_id,
    NULL::numeric AS bill_user_id,
    NULL::numeric AS c_order_c_activity_id,
    NULL::numeric AS c_order_c_bpartner_id,
    NULL::numeric AS c_order_c_campaign_id,
    NULL::numeric AS c_cashline_id,
    NULL::numeric AS c_cashplanline_id,
    NULL::numeric AS c_order_c_charge_id,
    NULL::numeric AS c_conversiontype_id,
    NULL::numeric AS c_order_c_currency_id,
    NULL::numeric AS c_doctype_id,
    NULL::numeric AS c_doctypetarget_id,
    NULL::numeric AS chargeamt,
    NULL::bpchar AS copyfrom,
    NULL::numeric AS c_payment_id,
    NULL::numeric AS c_paymentterm_id,
    NULL::numeric AS c_pos_id,
    NULL::numeric AS c_order_c_project_id,
    NULL::timestamp without time zone AS c_order_created,
    NULL::numeric AS c_order_createdby,
    NULL::timestamp without time zone AS dateacct,
    NULL::timestamp without time zone AS dateprinted,
    NULL::timestamp without time zone AS c_order_datepromised,
    NULL::bpchar AS deliveryrule,
    NULL::bpchar AS deliveryviarule,
    NULL::character varying AS c_order_description,
    NULL::bpchar AS docaction,
    NULL::bpchar AS docstatus,
    NULL::character varying AS documentno,
    NULL::numeric AS dropship_bpartner_id,
    NULL::numeric AS dropship_location_id,
    NULL::numeric AS dropship_user_id,
    NULL::numeric AS c_order_freightamt,
    NULL::bpchar AS freightcostrule,
    NULL::numeric AS grandtotal,
    NULL::bpchar AS invoicerule,
    NULL::bpchar AS c_order_isactive,
    NULL::bpchar AS isapproved,
    NULL::bpchar AS iscreditapproved,
    NULL::bpchar AS isdelivered,
    NULL::bpchar AS c_order_isdiscountprinted,
    NULL::bpchar AS c_order_isdropship,
    NULL::bpchar AS isinvoiced,
    NULL::bpchar AS ispayschedulevalid,
    NULL::bpchar AS isprinted,
    NULL::bpchar AS isselected,
    NULL::bpchar AS c_order_isselfservice,
    NULL::bpchar AS issotrx,
    NULL::bpchar AS istaxincluded,
    NULL::bpchar AS istransferred,
    NULL::numeric AS link_order_id,
    NULL::numeric AS c_order_m_freightcategory_id,
    NULL::numeric AS c_order_m_pricelist_id,
    NULL::numeric AS c_order_m_shipper_id,
    NULL::numeric AS c_order_m_warehouse_id,
    NULL::character varying AS ordertype,
    NULL::numeric AS pay_bpartner_id,
    NULL::numeric AS pay_location_id,
    NULL::bpchar AS c_order_paymentrule,
    NULL::character varying AS poreference,
    NULL::bpchar AS posted,
    NULL::bpchar AS priorityrule,
    NULL::bpchar AS c_order_processed,
    NULL::numeric AS processedon,
    NULL::character varying AS promotioncode,
    NULL::numeric AS ref_order_id,
    NULL::numeric AS salesrep_id,
    NULL::bpchar AS c_order_sendemail,
    NULL::numeric AS totallines,
    NULL::timestamp without time zone AS c_order_updated,
    NULL::numeric AS c_order_updatedby,
    NULL::numeric AS c_order_user1_id,
    NULL::numeric AS c_order_user2_id,
    NULL::numeric AS c_order_volume,
    NULL::numeric AS c_order_weight,
    NULL::numeric AS m_product_ad_org_id,
    NULL::character varying AS classification,
    NULL::bpchar AS m_product_copyfrom,
    NULL::timestamp without time zone AS m_product_created,
    NULL::numeric AS m_product_createdby,
    NULL::numeric AS c_revenuerecognition_id,
    NULL::numeric AS c_subscriptiontype_id,
    NULL::numeric AS c_taxcategory_id,
    NULL::numeric AS m_product_c_uom_id,
    NULL::character varying AS descriptionurl,
    NULL::bpchar AS m_product_discontinued,
    NULL::timestamp without time zone AS m_product_discontinuedat,
    NULL::character varying AS group1,
    NULL::character varying AS group2,
    NULL::numeric AS guaranteedays,
    NULL::numeric AS guaranteedaysmin,
    NULL::character varying AS help,
    NULL::bpchar AS m_product_isactive,
    NULL::bpchar AS isbom,
    NULL::bpchar AS m_product_isdropship,
    NULL::bpchar AS isexcludeautodelivery,
    NULL::bpchar AS isinvoiceprintdetails,
    NULL::bpchar AS ispicklistprintdetails,
    NULL::bpchar AS ispurchased,
    NULL::bpchar AS m_product_isselfservice,
    NULL::bpchar AS issold,
    NULL::bpchar AS isstocked,
    NULL::bpchar AS m_product_issummary,
    NULL::bpchar AS isverified,
    NULL::bpchar AS iswebstorefeatured,
    NULL::numeric AS lowlevel,
    NULL::numeric AS m_attributeset_id,
    NULL::numeric AS m_attributesetinstance_id,
    NULL::numeric AS m_product_m_freightcategory_id,
    NULL::numeric AS m_locator_id,
    NULL::numeric AS m_product_product_category_id,
    NULL::bpchar AS m_product_processing,
    NULL::bpchar AS producttype,
    NULL::numeric AS r_mailtext_id,
    NULL::numeric AS m_product_salesrep_id,
    NULL::numeric AS s_expensetype_id,
    NULL::numeric AS shelfdepth,
    NULL::numeric AS shelfheight,
    NULL::numeric AS shelfwidth,
    NULL::numeric AS s_resource_id,
    NULL::numeric AS unitsperpack,
    NULL::numeric AS unitsperpallet,
    NULL::timestamp without time zone AS m_product_updated,
    NULL::numeric AS m_product_updatedby,
    NULL::character varying AS versionno,
    NULL::numeric AS m_product_volume,
    NULL::numeric AS m_product_weight,
    NULL::numeric AS m_product_po_ad_org_id,
    NULL::numeric AS m_product_po_c_bpartner_id,
    NULL::numeric AS m_product_po_c_currency_id,
    NULL::numeric AS costperorder,
    NULL::timestamp without time zone AS m_product_po_created,
    NULL::numeric AS m_product_po_createdby,
    NULL::numeric AS m_product_po_c_uom_id,
    NULL::numeric AS deliverytime_actual,
    NULL::numeric AS deliverytime_promised,
    NULL::bpchar AS m_product_po_discontinued,
    NULL::timestamp without time zone AS m_product_po_discontinuedat,
    NULL::bpchar AS m_product_po_isactive,
    NULL::bpchar AS iscurrentvendor,
    NULL::bpchar AS m_product_po_manufacturer,
    NULL::numeric AS m_product_po_m_product_id,
    NULL::numeric AS order_min,
    NULL::numeric AS order_pack,
    NULL::timestamp without time zone AS priceeffective,
    NULL::numeric AS pricelastinv,
    NULL::numeric AS pricelastpo,
    NULL::numeric AS m_product_po_pricelist,
    NULL::numeric AS pricepo,
    NULL::numeric AS m_product_po_qualityrating,
    NULL::numeric AS royaltyamt,
    NULL::character varying AS m_product_po_upc,
    NULL::timestamp without time zone AS m_product_po_updated,
    NULL::numeric AS m_product_po_updatedby,
    NULL::bpchar AS m_product_po_vendorcategory,
    NULL::numeric AS s_resourceassignment_ad_org_id,
    NULL::timestamp without time zone AS assigndatefrom,
    NULL::timestamp without time zone AS assigndateto,
    NULL::timestamp without time zone AS s_resourceassignment_created,
    NULL::numeric AS s_resourceassignment_createby,
    NULL::bpchar AS s_resourceassignment_isactive,
    NULL::bpchar AS isconfirmed,
    NULL::character varying AS s_resourceassignment_name,
    NULL::numeric AS s_resourceassignment_qty,
    NULL::numeric AS s_resourceassignment_s_resour,
    NULL::timestamp without time zone AS s_resourceassignment_updated,
    NULL::numeric AS s_resourceassignment_updatedby,
    NULL::numeric AS c_charge_c_org_id,
    NULL::numeric AS c_charge_c_bpartner_id,
    NULL::numeric AS c_chargetype_id,
    NULL::numeric AS c_charge_chargeamt,
    NULL::numeric AS c_charge_c_taxcategory_id,
    NULL::character varying AS c_charge_description,
    NULL::bpchar AS c_charge_isactive,
    NULL::bpchar AS issamecurrency,
    NULL::bpchar AS issametax,
    NULL::bpchar AS c_charge_istaxincluded,
    NULL::numeric AS c_bpartner_product_ad_org_id,
    NULL::numeric AS c_bp_product_c_bpartner_id,
    NULL::timestamp without time zone AS c_bpartner_product_created,
    NULL::numeric AS c_bpartner_product_createdby,
    NULL::character varying AS c_bpartner_product_description,
    NULL::bpchar AS c_bpartner_product_isactive,
    NULL::bpchar AS ismanufacturer,
    NULL::character varying AS c_bpartner_product_manufactur,
    NULL::numeric AS c_bpartner_product_qualityrat,
    NULL::numeric AS shelflifemindays,
    NULL::numeric AS c_bpartner_product_shelflifem,
    NULL::timestamp without time zone AS c_bpartner_product_updated,
    NULL::numeric AS c_bpartner_product_updatedby,
    NULL::character varying AS c_bpartner_product_vendorcate,
    NULL::numeric AS acqusitioncost,
    NULL::numeric AS actuallifetimevalue,
    NULL::character varying AS c_bpartner_ad_language,
    NULL::numeric AS ad_orgbp_id,
    NULL::numeric AS c_bpartner_ad_org_id,
    NULL::numeric AS bpartner_parent_id,
    NULL::numeric AS c_bp_group_id,
    NULL::numeric AS c_dunning_id,
    NULL::numeric AS c_greeting_id,
    NULL::numeric AS c_invoiceschedule_id,
    NULL::numeric AS c_bpartner_c_paymentterm_id,
    NULL::timestamp without time zone AS c_bpartner_created,
    NULL::numeric AS c_bpartner_createdby,
    NULL::numeric AS c_bpartner_c_taxgroup_id,
    NULL::bpchar AS c_bpartner_deliveryrule,
    NULL::bpchar AS c_bpartner_deliveryviarule,
    NULL::character varying AS c_bpartner_description,
    NULL::date AS c_bpartner_dunninggrace,
    NULL::bpchar AS duns,
    NULL::timestamp without time zone AS c_bpartner_firstsale,
    NULL::numeric AS c_bpartner_flatdiscount,
    NULL::bpchar AS c_bpartner_freightcostrule,
    NULL::bpchar AS c_bpartner_invoicerule,
    NULL::bpchar AS c_bpartner_isactive,
    NULL::bpchar AS iscustomer,
    NULL::bpchar AS c_bpartner_isdiscountprinted,
    NULL::bpchar AS c_bpartner_isemployee,
    NULL::bpchar AS c_bpartner_ismanufacturer,
    NULL::bpchar AS isonetime,
    NULL::bpchar AS ispotaxexempt,
    NULL::bpchar AS isprospect,
    NULL::bpchar AS issalesrep,
    NULL::bpchar AS c_bpartner_issummary,
    NULL::bpchar AS c_bpartner_istaxexempt,
    NULL::bpchar AS isvendor,
    NULL::numeric AS logo_id,
    NULL::numeric AS m_discountschema_id,
    NULL::numeric AS c_bpartner_m_pricelist_id,
    NULL::bpchar AS naics,
    NULL::character varying AS c_bpartner_name,
    NULL::character varying AS c_bpartner_name2,
    NULL::numeric AS numberemployees,
    NULL::bpchar AS c_bpartner_paymentrule,
    NULL::bpchar AS paymentrulepo,
    NULL::numeric AS po_discountschema_id,
    NULL::numeric AS po_paymentterm_id,
    NULL::numeric AS po_pricelist_id,
    NULL::character varying AS c_bpartner_poreference,
    NULL::numeric AS potentiallifetimevalue,
    NULL::bpchar AS c_bpartner_rating,
    NULL::character varying AS c_bpartner_referenceno,
    NULL::numeric AS c_bpartner_salesrep_id,
    NULL::numeric AS salesvolume,
    NULL::bpchar AS c_bpartner_sendemail,
    NULL::numeric AS shareofcustomer,
    NULL::numeric AS c_bpartner_shelflifeminpct,
    NULL::numeric AS so_creditlimit,
    NULL::bpchar AS socreditstatus,
    NULL::numeric AS so_creditused,
    NULL::character varying AS so_description,
    NULL::character varying AS c_bpartner_taxid,
    NULL::numeric AS totalopenbalance,
    NULL::timestamp without time zone AS c_bpartner_updated,
    NULL::numeric AS c_bpartner_updatedby,
    NULL::character varying AS c_bpartner_url,
    NULL::character varying AS c_bpartner_value,
    NULL::numeric AS c_bpartner_location_ad_org_id,
    NULL::numeric AS c_bpartner_location_c_bpartne,
    NULL::timestamp without time zone AS c_bpartner_location_created,
    NULL::numeric AS c_bpartner_location_createdby,
    NULL::numeric AS c_salesregion_id,
    NULL::character varying AS c_bpartner_location_fax,
    NULL::bpchar AS c_bpartner_location_isactive,
    NULL::bpchar AS isbillto,
    NULL::character varying AS isdn,
    NULL::bpchar AS ispayfrom,
    NULL::bpchar AS isremitto,
    NULL::bpchar AS isshipto,
    NULL::character varying AS c_bpartner_location_name,
    NULL::character varying AS c_bpartner_location_phone,
    NULL::character varying AS c_bpartner_location_phone2,
    NULL::timestamp without time zone AS c_bpartner_location_updated,
    NULL::numeric AS c_bpartner_location_updatedby,
    NULL::numeric AS c_tax_ad_org_id,
    NULL::numeric AS ad_rule_id,
    NULL::numeric AS c_country_id,
    NULL::numeric AS c_region_id,
    NULL::numeric AS c_tax_c_taxcategory_id,
    NULL::character varying AS c_tax_description,
    NULL::bpchar AS c_tax_isactive,
    NULL::bpchar AS c_tax_isdefault,
    NULL::bpchar AS isdocumentlevel,
    NULL::bpchar AS issalestax,
    NULL::bpchar AS c_tax_issummary,
    NULL::bpchar AS c_tax_istaxexempt,
    NULL::character varying AS c_tax_name,
    NULL::numeric AS parent_tax_id,
    NULL::numeric AS rate,
    NULL::bpchar AS requirestaxcertificate,
    NULL::bpchar AS sopotype,
    NULL::numeric AS to_country_id,
    NULL::numeric AS c_tax_to_region_id,
    NULL::timestamp without time zone AS validfrom
   FROM c_order i
UNION
 SELECT ot.ad_client_id,
    ot.ad_org_id,
    ot.isactive,
    ot.created,
    ot.createdby,
    ot.updated,
    ot.updatedby,
    'en_US'::character varying(6) AS ad_language,
    ot.c_order_id,
    NULL::numeric AS c_orderline_id,
    ot.c_tax_id,
    t.taxindicator,
    NULL::numeric AS c_bpartner_id,
    NULL::numeric AS c_bpartner_location_id,
    NULL::character varying AS bpname,
    NULL::numeric AS c_location_id,
    NULL::numeric AS line,
    NULL::numeric AS m_product_id,
    NULL::character varying AS vendorproductno,
    NULL::numeric AS qtyordered,
    NULL::numeric AS qtyentered,
    NULL::character varying AS uomsymbol,
    NULL::integer AS qtyprecision,
    t.name,
    NULL::character varying AS description,
    NULL::character varying AS documentnote,
    NULL::character varying AS upc,
    NULL::character varying AS sku,
    NULL::character varying AS productvalue,
    NULL::character varying AS resourcedescription,
    NULL::numeric AS pricelist,
    NULL::numeric AS priceenteredlist,
    NULL::numeric AS discount,
        CASE
            WHEN (ot.istaxincluded = 'Y'::bpchar) THEN ot.taxamt
            ELSE ot.taxbaseamt
        END AS priceactual,
        CASE
            WHEN (ot.istaxincluded = 'Y'::bpchar) THEN ot.taxamt
            ELSE ot.taxbaseamt
        END AS priceentered,
        CASE
            WHEN (ot.istaxincluded = 'Y'::bpchar) THEN NULL::numeric
            ELSE ot.taxamt
        END AS linenetamt,
    NULL::character varying AS productdescription,
    NULL::character varying AS imageurl,
    NULL::numeric AS c_campaign_id,
    NULL::numeric AS c_project_id,
    NULL::numeric AS c_activity_id,
    NULL::numeric AS c_projectphase_id,
    NULL::numeric AS c_projecttask_id,
    NULL::numeric AS c_orderline_ad_orgtrx_id,
    NULL::numeric AS c_orderline_c_charge_id,
    NULL::numeric AS c_orderline_c_currency_id,
    NULL::character varying AS cursymbol,
    NULL::numeric AS c_uom_id,
    NULL::timestamp without time zone AS datedelivered,
    NULL::timestamp without time zone AS dateinvoiced,
    NULL::timestamp without time zone AS dateordered,
    NULL::timestamp without time zone AS c_orderline_datepromised,
    NULL::numeric AS c_orderline_freightamt,
    NULL::bpchar AS isdescription,
    NULL::numeric AS link_orderline_id,
    NULL::numeric AS m_promotion_id,
    NULL::numeric AS c_orderline_m_shipper_id,
    NULL::numeric AS c_orderline_m_warehouse_id,
    NULL::numeric AS pricecost,
    NULL::numeric AS pricelimit,
    NULL::bpchar AS c_orderline_processed,
    NULL::numeric AS qtydelivered,
    NULL::numeric AS qtyinvoiced,
    NULL::numeric AS qtylostsales,
    NULL::numeric AS qtyreserved,
    NULL::numeric AS ref_orderline_id,
    NULL::numeric AS rramt,
    NULL::timestamp without time zone AS rrstartdate,
    NULL::numeric AS s_resourceassignment_id,
    NULL::numeric AS c_orderline_user1_id,
    NULL::numeric AS c_orderline_user2_id,
    NULL::numeric AS c_uom_ad_org_id,
    NULL::numeric AS costingprecision,
    NULL::character varying AS c_uom_description,
    NULL::bpchar AS c_uom_isactive,
    NULL::bpchar AS isdefault,
    NULL::character varying AS c_uom_name,
    NULL::numeric AS stdprecision,
    NULL::character varying AS uomtype,
    NULL::character varying AS x12de355,
    NULL::numeric AS c_order_ad_org_id,
    NULL::numeric AS c_order_ad_orgtrx_id,
    NULL::numeric AS ad_user_id,
    NULL::numeric AS amountrefunded,
    NULL::numeric AS amounttendered,
    NULL::numeric AS bill_bpartner_id,
    NULL::numeric AS bill_location_id,
    NULL::numeric AS bill_user_id,
    NULL::numeric AS c_order_c_activity_id,
    NULL::numeric AS c_order_c_bpartner_id,
    NULL::numeric AS c_order_c_campaign_id,
    NULL::numeric AS c_cashline_id,
    NULL::numeric AS c_cashplanline_id,
    NULL::numeric AS c_order_c_charge_id,
    NULL::numeric AS c_conversiontype_id,
    NULL::numeric AS c_order_c_currency_id,
    NULL::numeric AS c_doctype_id,
    NULL::numeric AS c_doctypetarget_id,
    NULL::numeric AS chargeamt,
    NULL::bpchar AS copyfrom,
    NULL::numeric AS c_payment_id,
    NULL::numeric AS c_paymentterm_id,
    NULL::numeric AS c_pos_id,
    NULL::numeric AS c_order_c_project_id,
    NULL::timestamp without time zone AS c_order_created,
    NULL::numeric AS c_order_createdby,
    NULL::timestamp without time zone AS dateacct,
    NULL::timestamp without time zone AS dateprinted,
    NULL::timestamp without time zone AS c_order_datepromised,
    NULL::bpchar AS deliveryrule,
    NULL::bpchar AS deliveryviarule,
    NULL::character varying AS c_order_description,
    NULL::bpchar AS docaction,
    NULL::bpchar AS docstatus,
    NULL::character varying AS documentno,
    NULL::numeric AS dropship_bpartner_id,
    NULL::numeric AS dropship_location_id,
    NULL::numeric AS dropship_user_id,
    NULL::numeric AS c_order_freightamt,
    NULL::bpchar AS freightcostrule,
    NULL::numeric AS grandtotal,
    NULL::bpchar AS invoicerule,
    NULL::bpchar AS c_order_isactive,
    NULL::bpchar AS isapproved,
    NULL::bpchar AS iscreditapproved,
    NULL::bpchar AS isdelivered,
    NULL::bpchar AS c_order_isdiscountprinted,
    NULL::bpchar AS c_order_isdropship,
    NULL::bpchar AS isinvoiced,
    NULL::bpchar AS ispayschedulevalid,
    NULL::bpchar AS isprinted,
    NULL::bpchar AS isselected,
    NULL::bpchar AS c_order_isselfservice,
    NULL::bpchar AS issotrx,
    NULL::bpchar AS istaxincluded,
    NULL::bpchar AS istransferred,
    NULL::numeric AS link_order_id,
    NULL::numeric AS c_order_m_freightcategory_id,
    NULL::numeric AS c_order_m_pricelist_id,
    NULL::numeric AS c_order_m_shipper_id,
    NULL::numeric AS c_order_m_warehouse_id,
    NULL::character varying AS ordertype,
    NULL::numeric AS pay_bpartner_id,
    NULL::numeric AS pay_location_id,
    NULL::bpchar AS c_order_paymentrule,
    NULL::character varying AS poreference,
    NULL::bpchar AS posted,
    NULL::bpchar AS priorityrule,
    NULL::bpchar AS c_order_processed,
    NULL::numeric AS processedon,
    NULL::character varying AS promotioncode,
    NULL::numeric AS ref_order_id,
    NULL::numeric AS salesrep_id,
    NULL::bpchar AS c_order_sendemail,
    NULL::numeric AS totallines,
    NULL::timestamp without time zone AS c_order_updated,
    NULL::numeric AS c_order_updatedby,
    NULL::numeric AS c_order_user1_id,
    NULL::numeric AS c_order_user2_id,
    NULL::numeric AS c_order_volume,
    NULL::numeric AS c_order_weight,
    NULL::numeric AS m_product_ad_org_id,
    NULL::character varying AS classification,
    NULL::bpchar AS m_product_copyfrom,
    NULL::timestamp without time zone AS m_product_created,
    NULL::numeric AS m_product_createdby,
    NULL::numeric AS c_revenuerecognition_id,
    NULL::numeric AS c_subscriptiontype_id,
    NULL::numeric AS c_taxcategory_id,
    NULL::numeric AS m_product_c_uom_id,
    NULL::character varying AS descriptionurl,
    NULL::bpchar AS m_product_discontinued,
    NULL::timestamp without time zone AS m_product_discontinuedat,
    NULL::character varying AS group1,
    NULL::character varying AS group2,
    NULL::numeric AS guaranteedays,
    NULL::numeric AS guaranteedaysmin,
    NULL::character varying AS help,
    NULL::bpchar AS m_product_isactive,
    NULL::bpchar AS isbom,
    NULL::bpchar AS m_product_isdropship,
    NULL::bpchar AS isexcludeautodelivery,
    NULL::bpchar AS isinvoiceprintdetails,
    NULL::bpchar AS ispicklistprintdetails,
    NULL::bpchar AS ispurchased,
    NULL::bpchar AS m_product_isselfservice,
    NULL::bpchar AS issold,
    NULL::bpchar AS isstocked,
    NULL::bpchar AS m_product_issummary,
    NULL::bpchar AS isverified,
    NULL::bpchar AS iswebstorefeatured,
    NULL::numeric AS lowlevel,
    NULL::numeric AS m_attributeset_id,
    NULL::numeric AS m_attributesetinstance_id,
    NULL::numeric AS m_product_m_freightcategory_id,
    NULL::numeric AS m_locator_id,
    NULL::numeric AS m_product_product_category_id,
    NULL::bpchar AS m_product_processing,
    NULL::bpchar AS producttype,
    NULL::numeric AS r_mailtext_id,
    NULL::numeric AS m_product_salesrep_id,
    NULL::numeric AS s_expensetype_id,
    NULL::numeric AS shelfdepth,
    NULL::numeric AS shelfheight,
    NULL::numeric AS shelfwidth,
    NULL::numeric AS s_resource_id,
    NULL::numeric AS unitsperpack,
    NULL::numeric AS unitsperpallet,
    NULL::timestamp without time zone AS m_product_updated,
    NULL::numeric AS m_product_updatedby,
    NULL::character varying AS versionno,
    NULL::numeric AS m_product_volume,
    NULL::numeric AS m_product_weight,
    NULL::numeric AS m_product_po_ad_org_id,
    NULL::numeric AS m_product_po_c_bpartner_id,
    NULL::numeric AS m_product_po_c_currency_id,
    NULL::numeric AS costperorder,
    NULL::timestamp without time zone AS m_product_po_created,
    NULL::numeric AS m_product_po_createdby,
    NULL::numeric AS m_product_po_c_uom_id,
    NULL::numeric AS deliverytime_actual,
    NULL::numeric AS deliverytime_promised,
    NULL::bpchar AS m_product_po_discontinued,
    NULL::timestamp without time zone AS m_product_po_discontinuedat,
    NULL::bpchar AS m_product_po_isactive,
    NULL::bpchar AS iscurrentvendor,
    NULL::bpchar AS m_product_po_manufacturer,
    NULL::numeric AS m_product_po_m_product_id,
    NULL::numeric AS order_min,
    NULL::numeric AS order_pack,
    NULL::timestamp without time zone AS priceeffective,
    NULL::numeric AS pricelastinv,
    NULL::numeric AS pricelastpo,
    NULL::numeric AS m_product_po_pricelist,
    NULL::numeric AS pricepo,
    NULL::numeric AS m_product_po_qualityrating,
    NULL::numeric AS royaltyamt,
    NULL::character varying AS m_product_po_upc,
    NULL::timestamp without time zone AS m_product_po_updated,
    NULL::numeric AS m_product_po_updatedby,
    NULL::bpchar AS m_product_po_vendorcategory,
    NULL::numeric AS s_resourceassignment_ad_org_id,
    NULL::timestamp without time zone AS assigndatefrom,
    NULL::timestamp without time zone AS assigndateto,
    NULL::timestamp without time zone AS s_resourceassignment_created,
    NULL::numeric AS s_resourceassignment_createby,
    NULL::bpchar AS s_resourceassignment_isactive,
    NULL::bpchar AS isconfirmed,
    NULL::character varying AS s_resourceassignment_name,
    NULL::numeric AS s_resourceassignment_qty,
    NULL::numeric AS s_resourceassignment_s_resour,
    NULL::timestamp without time zone AS s_resourceassignment_updated,
    NULL::numeric AS s_resourceassignment_updatedby,
    NULL::numeric AS c_charge_c_org_id,
    NULL::numeric AS c_charge_c_bpartner_id,
    NULL::numeric AS c_chargetype_id,
    NULL::numeric AS c_charge_chargeamt,
    NULL::numeric AS c_charge_c_taxcategory_id,
    NULL::character varying AS c_charge_description,
    NULL::bpchar AS c_charge_isactive,
    NULL::bpchar AS issamecurrency,
    NULL::bpchar AS issametax,
    NULL::bpchar AS c_charge_istaxincluded,
    NULL::numeric AS c_bpartner_product_ad_org_id,
    NULL::numeric AS c_bp_product_c_bpartner_id,
    NULL::timestamp without time zone AS c_bpartner_product_created,
    NULL::numeric AS c_bpartner_product_createdby,
    NULL::character varying AS c_bpartner_product_description,
    NULL::bpchar AS c_bpartner_product_isactive,
    NULL::bpchar AS ismanufacturer,
    NULL::character varying AS c_bpartner_product_manufactur,
    NULL::numeric AS c_bpartner_product_qualityrat,
    NULL::numeric AS shelflifemindays,
    NULL::numeric AS c_bpartner_product_shelflifem,
    NULL::timestamp without time zone AS c_bpartner_product_updated,
    NULL::numeric AS c_bpartner_product_updatedby,
    NULL::character varying AS c_bpartner_product_vendorcate,
    NULL::numeric AS acqusitioncost,
    NULL::numeric AS actuallifetimevalue,
    NULL::character varying AS c_bpartner_ad_language,
    NULL::numeric AS ad_orgbp_id,
    NULL::numeric AS c_bpartner_ad_org_id,
    NULL::numeric AS bpartner_parent_id,
    NULL::numeric AS c_bp_group_id,
    NULL::numeric AS c_dunning_id,
    NULL::numeric AS c_greeting_id,
    NULL::numeric AS c_invoiceschedule_id,
    NULL::numeric AS c_bpartner_c_paymentterm_id,
    NULL::timestamp without time zone AS c_bpartner_created,
    NULL::numeric AS c_bpartner_createdby,
    NULL::numeric AS c_bpartner_c_taxgroup_id,
    NULL::bpchar AS c_bpartner_deliveryrule,
    NULL::bpchar AS c_bpartner_deliveryviarule,
    NULL::character varying AS c_bpartner_description,
    NULL::date AS c_bpartner_dunninggrace,
    NULL::bpchar AS duns,
    NULL::timestamp without time zone AS c_bpartner_firstsale,
    NULL::numeric AS c_bpartner_flatdiscount,
    NULL::bpchar AS c_bpartner_freightcostrule,
    NULL::bpchar AS c_bpartner_invoicerule,
    NULL::bpchar AS c_bpartner_isactive,
    NULL::bpchar AS iscustomer,
    NULL::bpchar AS c_bpartner_isdiscountprinted,
    NULL::bpchar AS c_bpartner_isemployee,
    NULL::bpchar AS c_bpartner_ismanufacturer,
    NULL::bpchar AS isonetime,
    NULL::bpchar AS ispotaxexempt,
    NULL::bpchar AS isprospect,
    NULL::bpchar AS issalesrep,
    NULL::bpchar AS c_bpartner_issummary,
    NULL::bpchar AS c_bpartner_istaxexempt,
    NULL::bpchar AS isvendor,
    NULL::numeric AS logo_id,
    NULL::numeric AS m_discountschema_id,
    NULL::numeric AS c_bpartner_m_pricelist_id,
    NULL::bpchar AS naics,
    NULL::character varying AS c_bpartner_name,
    NULL::character varying AS c_bpartner_name2,
    NULL::numeric AS numberemployees,
    NULL::bpchar AS c_bpartner_paymentrule,
    NULL::bpchar AS paymentrulepo,
    NULL::numeric AS po_discountschema_id,
    NULL::numeric AS po_paymentterm_id,
    NULL::numeric AS po_pricelist_id,
    NULL::character varying AS c_bpartner_poreference,
    NULL::numeric AS potentiallifetimevalue,
    NULL::bpchar AS c_bpartner_rating,
    NULL::character varying AS c_bpartner_referenceno,
    NULL::numeric AS c_bpartner_salesrep_id,
    NULL::numeric AS salesvolume,
    NULL::bpchar AS c_bpartner_sendemail,
    NULL::numeric AS shareofcustomer,
    NULL::numeric AS c_bpartner_shelflifeminpct,
    NULL::numeric AS so_creditlimit,
    NULL::bpchar AS socreditstatus,
    NULL::numeric AS so_creditused,
    NULL::character varying AS so_description,
    NULL::character varying AS c_bpartner_taxid,
    NULL::numeric AS totalopenbalance,
    NULL::timestamp without time zone AS c_bpartner_updated,
    NULL::numeric AS c_bpartner_updatedby,
    NULL::character varying AS c_bpartner_url,
    NULL::character varying AS c_bpartner_value,
    NULL::numeric AS c_bpartner_location_ad_org_id,
    NULL::numeric AS c_bpartner_location_c_bpartne,
    NULL::timestamp without time zone AS c_bpartner_location_created,
    NULL::numeric AS c_bpartner_location_createdby,
    NULL::numeric AS c_salesregion_id,
    NULL::character varying AS c_bpartner_location_fax,
    NULL::bpchar AS c_bpartner_location_isactive,
    NULL::bpchar AS isbillto,
    NULL::character varying AS isdn,
    NULL::bpchar AS ispayfrom,
    NULL::bpchar AS isremitto,
    NULL::bpchar AS isshipto,
    NULL::character varying AS c_bpartner_location_name,
    NULL::character varying AS c_bpartner_location_phone,
    NULL::character varying AS c_bpartner_location_phone2,
    NULL::timestamp without time zone AS c_bpartner_location_updated,
    NULL::numeric AS c_bpartner_location_updatedby,
    t.ad_org_id AS c_tax_ad_org_id,
    t.ad_rule_id,
    t.c_country_id,
    t.c_region_id,
    t.c_taxcategory_id AS c_tax_c_taxcategory_id,
    t.description AS c_tax_description,
    t.isactive AS c_tax_isactive,
    t.isdefault AS c_tax_isdefault,
    t.isdocumentlevel,
    t.issalestax,
    t.issummary AS c_tax_issummary,
    t.istaxexempt AS c_tax_istaxexempt,
    t.name AS c_tax_name,
    t.parent_tax_id,
    t.rate,
    t.requirestaxcertificate,
    t.sopotype,
    t.to_country_id,
    t.to_region_id AS c_tax_to_region_id,
    t.validfrom
   FROM (c_ordertax ot
     JOIN c_tax t ON ((ot.c_tax_id = t.c_tax_id)));
--
-- create view  wmv_ghg_certified_shipments_v
--
CREATE OR REPLACE VIEW wmv_ghg_certified_shipments_v AS
 SELECT io.ad_client_id,
    io.ad_org_id,
    bp.name AS bp_name,
    io.issotrx,
    p.name AS prod_name,
    io.documentno AS doc_num,
    COALESCE(iol.wmv_containernumber, iol.description) AS wmv_containernumber,
    io.movementdate,
    COALESCE(crt.wmv_ghgcertificate, aud.wmv_ghgauditnumber) AS certificate_num,
        CASE
            WHEN (io.issotrx = 'Y'::bpchar) THEN iol.movementqty
            ELSE (iol.movementqty * ('-1'::integer)::numeric)
        END AS qty,
    uom.uomsymbol,
        CASE
            WHEN (io.issotrx = 'Y'::bpchar) THEN (iol.movementqty * wmv_uomconvert(uom.uomsymbol, 'MT'::character varying, p.m_product_id))
            ELSE ((iol.movementqty * wmv_uomconvert(uom.uomsymbol, 'MT'::character varying, p.m_product_id)) * ('-1'::integer)::numeric)
        END AS qty_mt
   FROM ((((((((m_inoutline iol
     JOIN m_product p ON ((p.m_product_id = iol.m_product_id)))
     JOIN m_product_category pc ON ((pc.m_product_category_id = p.m_product_category_id)))
     JOIN c_uom uom ON ((p.c_uom_id = uom.c_uom_id)))
     JOIN m_inout io ON ((io.m_inout_id = iol.m_inout_id)))
     JOIN c_doctype dt ON ((io.c_doctype_id = dt.c_doctype_id)))
     JOIN c_bpartner bp ON ((io.c_bpartner_id = bp.c_bpartner_id)))
     LEFT JOIN wmv_ghgcertificate crt ON ((crt.wmv_ghgcertificate_id = io.wmv_ghgcertificate_id)))
     LEFT JOIN wmv_ghgaudit aud ON ((aud.wmv_ghgaudit_id = io.wmv_ghgaudit_id)))
  WHERE ((pc.name)::text = 'GHG Certified'::text);
--
-- create view  wmv_invoice_header_v
--
CREATE OR REPLACE VIEW wmv_invoice_header_v AS
 SELECT i.incoterm,
    i.isusingfactoring,
    wmv_textblock('factoring_note'::character varying, i.isusingfactoring) AS factoringtext,
    wmv_textblock('bankverbindung'::character varying, i.isusingfactoring, true) AS bankverbindung,
    wmv_textblock('companyinfo'::character varying) AS companyinfo,
    i.wmv_product_id AS m_product_id,
    lf.name AS lineformat,
    p.description AS productdescription,
    paymenttermduedate(i.c_paymentterm_id, (i.dateinvoiced)::timestamp with time zone) AS paydueday,
    i.ad_client_id,
    i.ad_org_id,
    i.isactive,
    i.created,
    i.createdby,
    i.updated,
    i.updatedby,
    'en_US'::character varying(6) AS ad_language,
    i.c_invoice_id,
    i.issotrx,
    i.documentno,
    i.docstatus,
    i.c_doctype_id,
    i.c_bpartner_id,
    bp.value AS bpvalue,
    bp.taxid AS bptaxid,
    bp.naics,
    bp.duns,
    oi.c_location_id AS org_location_id,
    org.name AS org_name,
    ol.address1 AS org_address1,
    ol.address2 AS org_address2,
    ol.address3 AS org_address3,
    ol.address4 AS org_address4,
    ol.c_country_id AS org_country_id,
    oc.name AS org_country,
    oc.countrycode AS org_countrycode,
    ol.city AS org_city,
    concat((ol.postal)::text, (ol.postal_add)::text) AS org_postal,
    oi.taxid,
    dt.printname AS documenttype,
    dt.documentnote AS documenttypenote,
    i.c_order_id,
    o.documentno AS order_no,
    i.salesrep_id,
    COALESCE(ubp.name, u.name) AS salesrep_name,
    i.dateinvoiced,
    bpg.greeting AS bpgreeting,
    bp.name,
    bp.name2,
    bpcg.greeting AS bpcontactgreeting,
    bpc.title,
    bpc.phone,
    NULLIF((bpc.name)::text, (bp.name)::text) AS contactname,
    bpl.c_location_id,
    bp.referenceno,
    concat((l.postal)::text, (l.postal_add)::text) AS postal,
    i.description,
    i.poreference,
    i.dateordered,
    i.c_currency_id,
    pt.name AS paymentterm,
    pt.documentnote AS paymenttermnote,
    i.c_charge_id,
    i.chargeamt,
    i.totallines,
    i.grandtotal,
    i.grandtotal AS amtinwords,
    i.m_pricelist_id,
    i.istaxincluded,
    i.c_campaign_id,
    i.c_project_id,
    i.c_activity_id,
    i.ispaid,
    COALESCE(oi.logo_id, ci.logo_id) AS logo_id,
    i.ad_orgtrx_id AS c_invoice_ad_orgtrx_id,
    i.ad_user_id,
    i.c_bpartner_location_id,
    i.c_conversiontype_id,
    i.c_doctypetarget_id,
    i.c_dunninglevel_id,
    i.c_payment_id,
    i.dateacct,
    i.dateprinted,
    i.docaction,
    i.dunninggrace,
    i.generateto,
    i.invoicecollectiontype,
    i.isapproved,
    i.isdiscountprinted,
    i.isindispute,
    i.ispayschedulevalid,
    i.isprinted,
    i.isselfservice AS c_invoice_isselfservice,
    i.istransferred,
    i.m_rma_id,
    i.paymentrule,
    i.posted,
    i.processedon,
    i.processing,
    i.ref_invoice_id,
    i.reversal_id,
    i.sendemail,
    i.user1_id,
    i.user2_id,
    pt.ad_org_id AS c_paymentterm_ad_org_id,
    pt.afterdelivery,
    pt.c_paymentterm_id,
    pt.description AS c_paymentterm_description,
    pt.discount,
    pt.discount2,
    pt.discountdays,
    pt.discountdays2,
    pt.fixmonthcutoff,
    pt.fixmonthday,
    pt.fixmonthoffset,
    pt.gracedays,
    pt.isactive AS c_paymentterm_isactive,
    pt.isdefault,
    pt.isduefixed,
    pt.isnextbusinessday,
    pt.isvalid,
    pt.netday,
    pt.netdays,
    pt.paymenttermusage,
    pt.value AS c_paymentterm_value,
    bp.acqusitioncost AS bp_acqusitioncost,
    bp.actuallifetimevalue AS bp_actuallifetimevalue,
    bp.ad_language AS bp_ad_language,
    bp.ad_orgbp_id AS bp_ad_orgbp_id,
    bp.ad_org_id AS bp_ad_org_id,
    bp.bpartner_parent_id AS bp_bpartner_parent_id,
    bp.c_bp_group_id AS bp_c_bp_group_id,
    bp.c_dunning_id AS bp_c_dunning_id,
    bp.c_greeting_id AS bp_c_greeting_id,
    bp.c_invoiceschedule_id AS bp_c_invoiceschedule_id,
    bp.c_paymentterm_id AS bp_c_paymentterm_id,
    bp.created AS bp_created,
    bp.createdby AS bp_createdby,
    bp.c_taxgroup_id AS bp_c_taxgroup_id,
    bp.deliveryrule AS bp_deliveryrule,
    bp.deliveryviarule AS bp_deliveryviarule,
    bp.description AS bp_description,
    bp.dunninggrace AS bp_dunninggrace,
    bp.firstsale AS bp_firstsale,
    bp.flatdiscount AS bp_flatdiscount,
    bp.freightcostrule AS bp_freightcostrule,
    bp.invoicerule AS bp_invoicerule,
    bp.isactive AS bp_isactive,
    bp.iscustomer AS bp_iscustomer,
    bp.isdiscountprinted AS bp_isdiscountprinted,
    bp.isemployee AS bp_isemployee,
    bp.ismanufacturer AS bp_ismanufacturer,
    bp.isonetime AS bp_isonetime,
    bp.ispotaxexempt AS bp_ispotaxexempt,
    bp.isprospect AS bp_isprospect,
    bp.issalesrep AS bp_issalesrep,
    bp.issummary AS bp_issummary,
    bp.istaxexempt AS bp_istaxexempt,
    bp.isvendor AS bp_isvendor,
    bp.logo_id AS bp_logo_id,
    bp.m_discountschema_id AS bp_m_discountschema_id,
    bp.m_pricelist_id AS bp_m_pricelist_id,
    bp.naics AS bp_naics,
    bp.numberemployees AS bp_numberemployees,
    bp.paymentrule AS bp_paymentrule,
    bp.paymentrulepo AS bp_paymentrulepo,
    bp.po_discountschema_id AS bp_po_discountschema_id,
    bp.po_paymentterm_id AS bp_po_paymentterm_id,
    bp.po_pricelist_id AS bp_po_pricelist_id,
    bp.poreference AS bp_poreference,
    bp.potentiallifetimevalue AS bp_potentiallifetimevalue,
    bp.rating AS bp_rating,
    bp.salesrep_id AS bp_salesrep_id,
    bp.salesvolume AS bp_salesvolume,
    bp.sendemail AS bp_sendemail,
    bp.shareofcustomer AS bp_shareofcustomer,
    bp.shelflifeminpct AS bp_shelflifeminpct,
    bp.so_creditlimit AS bp_so_creditlimit,
    bp.socreditstatus AS bp_socreditstatus,
    bp.so_creditused AS bp_so_creditused,
    bp.so_description AS bp_so_description,
    bp.totalopenbalance AS bp_totalopenbalance,
    bp.updated AS bp_updated,
    bp.updatedby AS bp_updatedby,
    bp.url AS bp_url,
    bpg.isactive AS c_greeting_isactive,
    bpg.isfirstnameonly,
    bpg.name AS c_greeting_name,
    bpl.ad_org_id AS bp_location_ad_org_id,
    bpl.c_bpartner_id AS bp_location_c_bpartner_id,
    bpl.created AS bp_location_created,
    bpl.createdby AS bp_location_createdby,
    bpl.c_salesregion_id,
    bpl.fax AS bp_location_fax,
    bpl.isactive AS bp_location_isactive,
    bpl.isbillto,
    bpl.isdn,
    bpl.ispayfrom,
    bpl.isremitto,
    bpl.isshipto,
    bpl.name AS bp_location_name,
    bpl.phone AS bp_location_phone,
    bpl.phone2 AS bp_location_phone2,
    bpl.updated AS bp_location_updated,
    bpl.updatedby AS bp_location_updatedby,
    l.address1,
    l.address2,
    l.address3,
    l.address4,
    l.ad_org_id AS c_location_ad_org_id,
    l.c_city_id,
    l.c_country_id,
    bpcountry.name AS country,
    l.city,
    l.created AS c_location_created,
    l.createdby AS c_location_createdby,
    l.c_region_id,
    l.isactive AS c_location_isactive,
    l.regionname,
    l.updated AS c_location_updated,
    l.updatedby AS c_location_updatedby,
    bpc.ad_org_id AS ad_user_ad_org_id,
    bpc.ad_orgtrx_id AS ad_user_ad_ad_orgtrx_id,
    bpc.birthday AS ad_user_ad_birthday,
    bpc.c_bpartner_id AS ad_user_c_bpartner_id,
    bpc.c_bpartner_location_id AS ad_user_c_bpartner_location_id,
    bpc.c_greeting_id AS ad_user_c_greeting_id,
    bpc.comments AS ad_user_comments,
    bpc.created AS ad_user_created,
    bpc.createdby AS ad_user_createdby,
    bpc.description AS ad_user_description,
    bpc.email AS ad_user_email,
    bpc.fax AS ad_user_fax,
    bpc.isactive AS ad_user_isactive,
    bpc.lastcontact AS ad_user_lastcontact,
    bpc.lastresult AS ad_user_lastresult,
    bpc.phone2 AS ad_user_phone2,
    bpc.supervisor_id AS ad_user_supervisor_id,
    bpc.updated AS ad_user_updated,
    bpc.updatedby AS ad_user_updatedby,
    bpc.value AS ad_user_value,
    bpcg.isactive AS user_greeting_isactive,
    bpcg.isfirstnameonly AS user_greeting_isfirstnameonly,
    bpcg.name AS user_greeting_name,
    oi.ad_org_id AS ad_orginfo_ad_org_id,
    oi.ad_orgtype_id,
    oi.c_calendar_id,
    oi.created AS ad_orginfo_created,
    oi.createdby AS ad_orginfo_createdby,
    oi.dropship_warehouse_id,
    oi.duns AS ad_orginfo_duns,
    oi.email AS ad_orginfo_email,
    oi.fax AS ad_orginfo_fax,
    oi.isactive AS ad_orginfo_isactive,
    oi.m_warehouse_id,
    oi.parent_org_id,
    oi.phone AS ad_orginfo_phone,
    oi.phone2 AS ad_orginfo_phone2,
    oi.receiptfootermsg,
    oi.supervisor_id,
    oi.updated AS ad_orginfo_updated,
    oi.updatedby AS ad_orginfo_updatedby,
    u.ad_org_id AS salesrep_ad_org_id,
    u.ad_orgtrx_id AS salesrep_ad_ad_orgtrx_id,
    u.birthday AS salesrep_ad_birthday,
    u.c_bpartner_id AS salesrep_c_bpartner_id,
    u.c_bpartner_location_id AS salesrep_c_bp_location_id,
    u.c_greeting_id AS salesrep_c_greeting_id,
    u.comments AS salesrep_comments,
    u.created AS salesrep_created,
    u.createdby AS salesrep_createdby,
    u.description AS salesrep_description,
    u.email AS salesrep_email,
    u.fax AS salesrep_fax,
    u.isactive AS salesrep_isactive,
    u.lastcontact AS salesrep_lastcontact,
    u.lastresult AS salesrep_lastresult,
    u.phone AS salesrep_phone,
    u.phone2 AS salesrep_phone2,
    u.supervisor_id AS salesrep_supervisor_id,
    u.title AS salesrep_title,
    u.updated AS salesrep_updated,
    u.updatedby AS salesrep_updatedby,
    u.value AS salesrep_value,
    ubp.acqusitioncost AS bpartner_acqusitioncost,
    ubp.actuallifetimevalue AS bpartner_actuallifetimevalue,
    ubp.ad_language AS bpartner_ad_language,
    ubp.ad_orgbp_id AS bpartner_ad_orgbp_id,
    ubp.ad_org_id AS bpartner_ad_org_id,
    ubp.bpartner_parent_id AS bpartner_bpartner_parent_id,
    ubp.c_bp_group_id AS bpartner_c_bp_group_id,
    ubp.c_dunning_id AS bpartner_c_dunning_id,
    ubp.c_greeting_id AS bpartner_c_greeting_id,
    ubp.c_invoiceschedule_id AS bpartner_c_invoiceschedule_id,
    ubp.c_paymentterm_id AS bpartner_c_paymentterm_id,
    ubp.created AS bpartner_created,
    ubp.createdby AS bpartner_createdby,
    ubp.c_taxgroup_id AS bpartner_c_taxgroup_id,
    ubp.deliveryrule AS bpartner_deliveryrule,
    ubp.deliveryviarule AS bpartner_deliveryviarule,
    ubp.description AS bpartner_description,
    ubp.dunninggrace AS bpartner_dunninggrace,
    ubp.duns AS bpartner_duns,
    ubp.firstsale AS bpartner_firstsale,
    ubp.flatdiscount AS bpartner_flatdiscount,
    ubp.freightcostrule AS bpartner_freightcostrule,
    ubp.invoicerule AS bpartner_invoicerule,
    ubp.isactive AS bpartner_isactive,
    ubp.iscustomer AS bpartner_iscustomer,
    ubp.isdiscountprinted AS bpartner_isdiscountprinted,
    ubp.isemployee AS bpartner_isemployee,
    ubp.ismanufacturer AS bpartner_ismanufacturer,
    ubp.isonetime AS bpartner_isonetime,
    ubp.ispotaxexempt AS bpartner_ispotaxexempt,
    ubp.isprospect AS bpartner_isprospect,
    ubp.issalesrep AS bpartner_issalesrep,
    ubp.issummary AS bpartner_issummary,
    ubp.istaxexempt AS bpartner_istaxexempt,
    ubp.isvendor AS bpartner_isvendor,
    ubp.logo_id AS bpartner_logo_id,
    ubp.m_discountschema_id AS bpartner_m_discountschema_id,
    ubp.m_pricelist_id AS bpartner_m_pricelist_id,
    ubp.naics AS bpartner_naics,
    ubp.name2 AS bpartner_name2,
    ubp.numberemployees AS bpartner_numberemployees,
    ubp.paymentrule AS bpartner_paymentrule,
    ubp.paymentrulepo AS bpartner_paymentrulepo,
    ubp.po_discountschema_id AS bpartner_po_discountschema_id,
    ubp.po_paymentterm_id AS bpartner_po_paymentterm_id,
    ubp.po_pricelist_id AS bpartner_po_pricelist_id,
    ubp.poreference AS bpartner_poreference,
    ubp.potentiallifetimevalue AS bpartner_potentiallifetimeval,
    ubp.rating AS bpartner_rating,
    ubp.referenceno AS bpartner_referenceno,
    ubp.salesrep_id AS bpartner_salesrep_id,
    ubp.salesvolume AS bpartner_salesvolume,
    ubp.sendemail AS bpartner_sendemail,
    ubp.shareofcustomer AS bpartner_shareofcustomer,
    ubp.shelflifeminpct AS bpartner_shelflifeminpct,
    ubp.so_creditlimit AS bpartner_so_creditlimit,
    ubp.socreditstatus AS bpartner_socreditstatus,
    ubp.so_creditused AS bpartner_so_creditused,
    ubp.so_description AS bpartner_so_description,
    ubp.taxid AS bpartner_taxid,
    ubp.totalopenbalance AS bpartner_totalopenbalance,
    ubp.updated AS bpartner_updated,
    ubp.updatedby AS bpartner_updatedby,
    ubp.url AS bpartner_url,
    ubp.value AS bpartner_value,
    cur.cursymbol,
    cur.description AS cur_description
   FROM ((((((((((((((((((((c_invoice i
     JOIN c_doctype dt ON ((i.c_doctype_id = dt.c_doctype_id)))
     JOIN c_paymentterm pt ON ((i.c_paymentterm_id = pt.c_paymentterm_id)))
     JOIN c_bpartner bp ON ((i.c_bpartner_id = bp.c_bpartner_id)))
     LEFT JOIN c_greeting bpg ON ((bp.c_greeting_id = bpg.c_greeting_id)))
     JOIN c_bpartner_location bpl ON ((i.c_bpartner_location_id = bpl.c_bpartner_location_id)))
     JOIN c_location l ON ((bpl.c_location_id = l.c_location_id)))
     LEFT JOIN ad_user bpc ON ((i.ad_user_id = bpc.ad_user_id)))
     LEFT JOIN c_greeting bpcg ON ((bpc.c_greeting_id = bpcg.c_greeting_id)))
     JOIN ad_orginfo oi ON ((i.ad_org_id = oi.ad_org_id)))
     JOIN ad_clientinfo ci ON ((i.ad_client_id = ci.ad_client_id)))
     LEFT JOIN ad_user u ON ((i.salesrep_id = u.ad_user_id)))
     LEFT JOIN c_bpartner ubp ON ((u.c_bpartner_id = ubp.c_bpartner_id)))
     LEFT JOIN c_currency cur ON ((i.c_currency_id = cur.c_currency_id)))
     JOIN c_location ol ON ((oi.c_location_id = ol.c_location_id)))
     JOIN ad_org org ON ((org.ad_org_id = i.ad_org_id)))
     JOIN c_country oc ON ((oc.c_country_id = ol.c_country_id)))
     JOIN c_country bpcountry ON ((bpcountry.c_country_id = l.c_country_id)))
     LEFT JOIN c_order o ON ((o.c_order_id = i.c_order_id)))
     LEFT JOIN m_product p ON ((p.m_product_id = i.wmv_product_id)))
     LEFT JOIN wmv_lineformat lf ON ((lf.wmv_lineformat_id = p.wmv_lineformat_id)));
--
-- create view  wmv_inout_line_v
--
CREATE OR REPLACE VIEW wmv_inout_line_v AS
 SELECT iol.ad_client_id,
    iol.ad_org_id,
    iol.isactive,
    iol.created,
    iol.createdby,
    iol.updated,
    iol.updatedby,
    'en_US'::character varying(6) AS ad_language,
    iol.m_inout_id,
    iol.m_inoutline_id,
    iol.line,
    p.m_product_id,
        CASE
            WHEN ((iol.movementqty <> (0)::numeric) OR (iol.m_product_id IS NOT NULL)) THEN iol.movementqty
            ELSE NULL::numeric
        END AS movementqty,
        CASE
            WHEN ((iol.qtyentered <> (0)::numeric) OR (iol.m_product_id IS NOT NULL)) THEN iol.qtyentered
            ELSE NULL::numeric
        END AS qtyentered,
        CASE
            WHEN ((iol.movementqty <> (0)::numeric) OR (iol.m_product_id IS NOT NULL)) THEN uom.uomsymbol
            ELSE NULL::character varying
        END AS uomsymbol,
    ol.qtyordered,
    ol.qtydelivered,
        CASE
            WHEN ((iol.movementqty <> (0)::numeric) OR (iol.m_product_id IS NOT NULL)) THEN (ol.qtyordered - ol.qtydelivered)
            ELSE NULL::numeric
        END AS qtybackordered,
    COALESCE(((p.name)::text || (productattribute(iol.m_attributesetinstance_id))::text), (c.name)::text, (iol.description)::text) AS name,
        CASE
            WHEN (COALESCE(c.name, p.name) IS NOT NULL) THEN iol.description
            ELSE NULL::character varying
        END AS description,
    p.documentnote,
    p.upc,
    p.sku,
    p.value AS productvalue,
    iol.m_locator_id,
    l.m_warehouse_id,
    l.x,
    l.y,
    l.z,
    iol.m_attributesetinstance_id,
    asi.m_attributeset_id,
    asi.serno,
    asi.lot,
    asi.m_lot_id,
    asi.guaranteedate,
    p.description AS productdescription,
    p.imageurl,
    iol.c_campaign_id,
    iol.c_project_id,
    iol.c_activity_id,
    iol.c_projectphase_id,
    iol.c_projecttask_id,
    iol.ad_orgtrx_id,
    iol.c_charge_id,
    iol.confirmedqty,
    iol.c_orderline_id,
    iol.c_uom_id AS m_inoutline_c_uom_id,
    iol.isdescription AS m_inoutline_isdescription,
    iol.isinvoiced,
    iol.m_rmaline_id,
    iol.pickedqty,
    iol.processed AS m_inoutline_processed,
    iol.ref_inoutline_id,
    iol.reversalline_id,
    iol.scrappedqty,
    iol.targetqty,
    iol.user1_id AS m_inoutline_user1_id,
    iol.user2_id AS m_inoutline_user2_id,
    p.ad_org_id AS m_product_ad_org_id,
    p.classification,
    p.copyfrom AS m_product_copyfrom,
    p.created AS m_product_created,
    p.createdby AS m_product_createdby,
    p.c_revenuerecognition_id,
    p.c_subscriptiontype_id,
    p.c_taxcategory_id AS m_product_c_taxcategory_id,
    p.c_uom_id AS m_product_c_uom_id,
    p.descriptionurl,
    p.discontinued,
    p.discontinuedat,
    p.group1,
    p.group2,
    p.guaranteedays,
    p.guaranteedaysmin,
    p.help,
    p.isactive AS m_product_isactive,
    p.isbom,
    p.isdropship,
    p.isexcludeautodelivery,
    p.isinvoiceprintdetails,
    p.ispicklistprintdetails,
    p.ispurchased,
    p.isselfservice AS m_product_isselfservice,
    p.issold,
    p.isstocked,
    p.issummary AS m_product_issummary,
    p.isverified,
    p.iswebstorefeatured,
    p.lowlevel,
    p.m_attributeset_id AS m_product_m_attributeset_id,
    p.m_attributesetinstance_id AS m_product_m_asi_id,
    p.m_freightcategory_id,
    p.m_locator_id AS m_product_m_locator_id,
    p.m_product_category_id AS m_product_m_prod_category_id,
    p.processing AS m_product_processing,
    p.producttype,
    p.r_mailtext_id,
    p.salesrep_id AS m_product_salesrep_id,
    p.s_expensetype_id,
    p.shelfdepth,
    p.shelfheight,
    p.shelfwidth,
    p.s_resource_id AS m_product_s_resource_id,
    p.unitsperpack,
    p.unitsperpallet,
    p.updated AS m_product_updated,
    p.updatedby AS m_product_updatedby,
    p.versionno,
    p.volume,
    p.weight,
    uom.ad_org_id AS c_uom_ad_org_id,
    uom.costingprecision,
    uom.description AS c_uom_description,
    uom.isactive AS c_uom_isactive,
    uom.isdefault AS c_uom_isdefault,
    uom.name AS c_uom_name,
    uom.stdprecision,
    uom.uomtype,
    uom.x12de355,
    asi.ad_org_id AS m_asi_ad_org_id,
    asi.created AS m_asi_created,
    asi.createdby AS m_asi_createdby,
    asi.description AS m_asi_description,
    asi.isactive AS m_asi_isactive,
    asi.updated AS m_asi_updated,
    asi.updatedby AS m_asi_updatedby,
    l.ad_org_id AS m_locator_ad_org_id,
    l.isactive AS m_locator_isactive,
    l.isdefault,
    l.priorityno,
    l.value AS m_locator_value,
    ol.ad_org_id AS c_orderline_ad_org_id,
    ol.ad_orgtrx_id AS c_orderline_ad_orgtrx_id,
    ol.c_activity_id AS c_orderline_c_activity_id,
    ol.c_bpartner_id AS c_orderline_c_bpartner_id,
    ol.c_bpartner_location_id AS c_orderline_c_bp_location_id,
    ol.c_charge_id AS c_orderline_c_charge_id,
    ol.c_currency_id AS c_orderline_c_currency_id,
    ol.c_order_id,
    ol.c_project_id AS c_orderline_c_project_id,
    ol.c_projectphase_id AS c_orderline_c_projectphase_id,
    ol.c_projecttask_id AS c_orderline_c_projecttask_id,
    ol.created AS c_orderline_created,
    ol.createdby AS c_orderline_createdby,
    ol.c_tax_id AS c_orderline_c_tax_id,
    ol.c_uom_id AS c_orderline_c_uom_id,
    ol.datedelivered,
    ol.dateinvoiced,
    ol.dateordered,
    ol.datepromised AS c_orderline_datepromised,
    ol.description AS c_orderline_description,
    ol.discount,
    ol.freightamt AS c_orderline_freightamt,
    ol.isactive AS c_orderline_isactive,
    ol.isdescription AS c_orderline_isdescription,
    ol.line AS c_orderline_line,
    ol.linenetamt,
    ol.link_orderline_id,
    ol.m_attributesetinstance_id AS c_orderline_m_asi_id,
    ol.m_product_id AS c_orderline_m_product_id,
    ol.m_promotion_id,
    ol.m_shipper_id AS c_orderline_m_shipper_id,
    ol.m_warehouse_id AS c_orderline_warehouse_id,
    ol.priceactual,
    ol.pricecost,
    ol.priceentered,
    ol.pricelimit,
    ol.pricelist,
    ol.processed AS c_orderline_processed,
    ol.qtyentered AS c_orderline_qtyentered,
    ol.qtyinvoiced,
    ol.qtylostsales,
    ol.qtyreserved,
    ol.ref_orderline_id,
    ol.rramt,
    ol.rrstartdate,
    ol.s_resourceassignment_id,
    ol.updated AS c_orderline_updated,
    ol.updatedby AS c_orderline_updatedby,
    ol.user1_id AS c_orderline_user1_id,
    ol.user2_id AS c_orderline_user2_id,
    c.ad_org_id AS c_charge_c_org_id,
    c.c_bpartner_id AS c_charge_c_bpartner_id,
    c.c_chargetype_id,
    c.chargeamt AS c_charge_chargeamt,
    c.c_taxcategory_id AS c_charge_c_taxcategory_id,
    c.description AS c_charge_description,
    c.isactive AS c_charge_isactive,
    c.issamecurrency,
    c.issametax,
    c.istaxincluded AS c_charge_istaxincluded
   FROM ((((((m_inoutline iol
     JOIN c_uom uom ON ((iol.c_uom_id = uom.c_uom_id)))
     LEFT JOIN m_product p ON ((iol.m_product_id = p.m_product_id)))
     LEFT JOIN m_attributesetinstance asi ON ((iol.m_attributesetinstance_id = asi.m_attributesetinstance_id)))
     LEFT JOIN m_locator l ON ((iol.m_locator_id = l.m_locator_id)))
     LEFT JOIN c_orderline ol ON ((iol.c_orderline_id = ol.c_orderline_id)))
     LEFT JOIN c_charge c ON ((iol.c_charge_id = c.c_charge_id)))
UNION
 SELECT iol.ad_client_id,
    iol.ad_org_id,
    iol.isactive,
    iol.created,
    iol.createdby,
    iol.updated,
    iol.updatedby,
    'en_US'::character varying(6) AS ad_language,
    iol.m_inout_id,
    iol.m_inoutline_id,
    (iol.line + (bl.line / (100)::numeric)) AS line,
    p.m_product_id,
        CASE
            WHEN (bl.isqtypercentage = 'N'::bpchar) THEN (iol.movementqty * bl.qtybom)
            ELSE (iol.movementqty * (bl.qtybatch / (100)::numeric))
        END AS movementqty,
        CASE
            WHEN (bl.isqtypercentage = 'N'::bpchar) THEN (iol.qtyentered * bl.qtybom)
            ELSE (iol.qtyentered * (bl.qtybatch / (100)::numeric))
        END AS qtyentered,
    uom.uomsymbol,
    NULL::numeric AS qtyordered,
    NULL::numeric AS qtydelivered,
    NULL::numeric AS qtybackordered,
    p.name,
    b.description,
    p.documentnote,
    p.upc,
    p.sku,
    p.value AS productvalue,
    iol.m_locator_id,
    l.m_warehouse_id,
    l.x,
    l.y,
    l.z,
    iol.m_attributesetinstance_id,
    asi.m_attributeset_id,
    asi.serno,
    asi.lot,
    asi.m_lot_id,
    asi.guaranteedate,
    p.description AS productdescription,
    p.imageurl,
    iol.c_campaign_id,
    iol.c_project_id,
    iol.c_activity_id,
    iol.c_projectphase_id,
    iol.c_projecttask_id,
    iol.ad_orgtrx_id,
    iol.c_charge_id,
    iol.confirmedqty,
    iol.c_orderline_id,
    iol.c_uom_id AS m_inoutline_c_uom_id,
    iol.isdescription AS m_inoutline_isdescription,
    iol.isinvoiced,
    iol.m_rmaline_id,
    iol.pickedqty,
    iol.processed AS m_inoutline_processed,
    iol.ref_inoutline_id,
    iol.reversalline_id,
    iol.scrappedqty,
    iol.targetqty,
    iol.user1_id AS m_inoutline_user1_id,
    iol.user2_id AS m_inoutline_user2_id,
    p.ad_org_id AS m_product_ad_org_id,
    p.classification,
    p.copyfrom AS m_product_copyfrom,
    p.created AS m_product_created,
    p.createdby AS m_product_createdby,
    p.c_revenuerecognition_id,
    p.c_subscriptiontype_id,
    p.c_taxcategory_id AS m_product_c_taxcategory_id,
    p.c_uom_id AS m_product_c_uom_id,
    p.descriptionurl,
    p.discontinued,
    p.discontinuedat,
    p.group1,
    p.group2,
    p.guaranteedays,
    p.guaranteedaysmin,
    p.help,
    p.isactive AS m_product_isactive,
    p.isbom,
    p.isdropship,
    p.isexcludeautodelivery,
    p.isinvoiceprintdetails,
    p.ispicklistprintdetails,
    p.ispurchased,
    p.isselfservice AS m_product_isselfservice,
    p.issold,
    p.isstocked,
    p.issummary AS m_product_issummary,
    p.isverified,
    p.iswebstorefeatured,
    p.lowlevel,
    p.m_attributeset_id AS m_product_m_attributeset_id,
    p.m_attributesetinstance_id AS m_product_m_asi_id,
    p.m_freightcategory_id,
    p.m_locator_id AS m_product_m_locator_id,
    p.m_product_category_id AS m_product_m_prod_category_id,
    p.processing AS m_product_processing,
    p.producttype,
    p.r_mailtext_id,
    p.salesrep_id AS m_product_salesrep_id,
    p.s_expensetype_id,
    p.shelfdepth,
    p.shelfheight,
    p.shelfwidth,
    p.s_resource_id AS m_product_s_resource_id,
    p.unitsperpack,
    p.unitsperpallet,
    p.updated AS m_product_updated,
    p.updatedby AS m_product_updatedby,
    p.versionno,
    p.volume,
    p.weight,
    uom.ad_org_id AS c_uom_ad_org_id,
    uom.costingprecision,
    uom.description AS c_uom_description,
    uom.isactive AS c_uom_isactive,
    uom.isdefault AS c_uom_isdefault,
    uom.name AS c_uom_name,
    uom.stdprecision,
    uom.uomtype,
    uom.x12de355,
    asi.ad_org_id AS m_asi_ad_org_id,
    asi.created AS m_asi_created,
    asi.createdby AS m_asi_createdby,
    asi.description AS m_asi_description,
    asi.isactive AS m_asi_isactive,
    asi.updated AS m_asi_updated,
    asi.updatedby AS m_asi_updatedby,
    l.ad_org_id AS m_locator_ad_org_id,
    l.isactive AS m_locator_isactive,
    l.isdefault,
    l.priorityno,
    l.value AS m_locator_value,
    NULL::numeric AS c_orderline_ad_org_id,
    NULL::numeric AS c_orderline_ad_orgtrx_id,
    NULL::numeric AS c_orderline_c_activity_id,
    NULL::numeric AS c_orderline_c_bpartner_id,
    NULL::numeric AS c_orderline_c_bp_location_id,
    NULL::numeric AS c_orderline_c_charge_id,
    NULL::numeric AS c_orderline_c_currency_id,
    NULL::numeric AS c_order_id,
    NULL::numeric AS c_orderline_c_project_id,
    NULL::numeric AS c_orderline_c_projectphase_id,
    NULL::numeric AS c_orderline_c_projecttask_id,
    NULL::timestamp without time zone AS c_orderline_created,
    NULL::numeric AS c_orderline_createdby,
    NULL::numeric AS c_orderline_c_tax_id,
    NULL::numeric AS c_orderline_c_uom_id,
    NULL::timestamp without time zone AS datedelivered,
    NULL::timestamp without time zone AS dateinvoiced,
    NULL::timestamp without time zone AS dateordered,
    NULL::timestamp without time zone AS c_orderline_datepromised,
    NULL::character varying AS c_orderline_description,
    NULL::numeric AS discount,
    NULL::numeric AS c_orderline_freightamt,
    NULL::bpchar AS c_orderline_isactive,
    NULL::bpchar AS c_orderline_isdescription,
    NULL::numeric AS c_orderline_line,
    NULL::numeric AS linenetamt,
    NULL::numeric AS link_orderline_id,
    NULL::numeric AS c_orderline_m_asi_id,
    NULL::numeric AS c_orderline_m_product_id,
    NULL::numeric AS m_promotion_id,
    NULL::numeric AS c_orderline_m_shipper_id,
    NULL::numeric AS c_orderline_warehouse_id,
    NULL::numeric AS priceactual,
    NULL::numeric AS pricecost,
    NULL::numeric AS priceentered,
    NULL::numeric AS pricelimit,
    NULL::numeric AS pricelist,
    NULL::bpchar AS c_orderline_processed,
    NULL::numeric AS c_orderline_qtyentered,
    NULL::numeric AS qtyinvoiced,
    NULL::numeric AS qtylostsales,
    NULL::numeric AS qtyreserved,
    NULL::numeric AS ref_orderline_id,
    NULL::numeric AS rramt,
    NULL::timestamp without time zone AS rrstartdate,
    NULL::numeric AS s_resourceassignment_id,
    NULL::timestamp without time zone AS c_orderline_updated,
    NULL::numeric AS c_orderline_updatedby,
    NULL::numeric AS c_orderline_user1_id,
    NULL::numeric AS c_orderline_user2_id,
    NULL::numeric AS c_charge_c_org_id,
    NULL::numeric AS c_charge_c_bpartner_id,
    NULL::numeric AS c_chargetype_id,
    NULL::numeric AS c_charge_chargeamt,
    NULL::numeric AS c_charge_c_taxcategory_id,
    NULL::character varying AS c_charge_description,
    NULL::bpchar AS c_charge_isactive,
    NULL::bpchar AS issamecurrency,
    NULL::bpchar AS issametax,
    NULL::bpchar AS c_charge_istaxincluded
   FROM (((((((pp_product_bom b
     JOIN m_inoutline iol ON ((b.m_product_id = iol.m_product_id)))
     JOIN m_product bp ON (((bp.m_product_id = iol.m_product_id) AND (bp.isbom = 'Y'::bpchar) AND (bp.isverified = 'Y'::bpchar) AND (bp.ispicklistprintdetails = 'Y'::bpchar))))
     JOIN pp_product_bomline bl ON ((bl.pp_product_bom_id = b.pp_product_bom_id)))
     JOIN m_product p ON ((bl.m_product_id = p.m_product_id)))
     JOIN c_uom uom ON ((p.c_uom_id = uom.c_uom_id)))
     LEFT JOIN m_attributesetinstance asi ON ((iol.m_attributesetinstance_id = asi.m_attributesetinstance_id)))
     LEFT JOIN m_locator l ON ((iol.m_locator_id = l.m_locator_id)));
--
-- create view  wmv_invoice_linetax_v
--
CREATE OR REPLACE VIEW wmv_invoice_linetax_v AS
 SELECT il.ad_client_id,
    il.ad_org_id,
    il.isactive,
    il.created,
    il.createdby,
    il.updated,
    il.updatedby,
    'en_US'::character varying(6) AS ad_language,
    il.c_invoice_id,
    il.c_invoiceline_id,
    il.c_tax_id,
    il.taxamt,
    il.linetotalamt,
    t.taxindicator,
    il.line,
    p.m_product_id,
        CASE
            WHEN ((il.qtyinvoiced <> (0)::numeric) OR (il.m_product_id IS NOT NULL)) THEN il.qtyinvoiced
            ELSE NULL::numeric
        END AS qtyinvoiced,
        CASE
            WHEN ((il.qtyentered <> (0)::numeric) OR (il.m_product_id IS NOT NULL)) THEN il.qtyentered
            ELSE NULL::numeric
        END AS qtyentered,
        CASE
            WHEN ((il.qtyentered <> (0)::numeric) OR (il.m_product_id IS NOT NULL)) THEN uom.uomsymbol
            ELSE NULL::character varying
        END AS uomsymbol,
    COALESCE(p.wmv_display_precision, uom.stdprecision, (2)::numeric) AS qtyprecision,
    COALESCE(c.name, (((p.name)::text || (COALESCE(productattribute(il.m_attributesetinstance_id), ''::character varying))::text))::character varying, il.description) AS name,
        CASE
            WHEN (COALESCE(c.name, p.name) IS NOT NULL) THEN il.description
            ELSE NULL::character varying
        END AS description,
    p.documentnote,
    p.upc,
    p.sku,
    COALESCE(pp.vendorproductno, p.value) AS productvalue,
    ra.description AS resourcedescription,
        CASE
            WHEN ((i.isdiscountprinted = 'Y'::bpchar) AND (il.pricelist <> (0)::numeric)) THEN il.pricelist
            ELSE NULL::numeric
        END AS pricelist,
        CASE
            WHEN ((i.isdiscountprinted = 'Y'::bpchar) AND (il.pricelist <> (0)::numeric) AND (il.qtyentered <> (0)::numeric)) THEN ((il.pricelist * il.qtyinvoiced) / il.qtyentered)
            ELSE NULL::numeric
        END AS priceenteredlist,
        CASE
            WHEN ((i.isdiscountprinted = 'Y'::bpchar) AND (il.pricelist > il.priceactual) AND (il.pricelist <> (0)::numeric)) THEN (((il.pricelist - il.priceactual) / il.pricelist) * (100)::numeric)
            ELSE NULL::numeric
        END AS discount,
        CASE
            WHEN ((il.priceactual <> (0)::numeric) OR (il.m_product_id IS NOT NULL)) THEN il.priceactual
            ELSE NULL::numeric
        END AS priceactual,
        CASE
            WHEN ((il.priceentered <> (0)::numeric) OR (il.m_product_id IS NOT NULL)) THEN il.priceentered
            ELSE NULL::numeric
        END AS priceentered,
        CASE
            WHEN ((il.linenetamt <> (0)::numeric) OR (il.m_product_id IS NOT NULL)) THEN il.linenetamt
            ELSE NULL::numeric
        END AS linenetamt,
    il.m_attributesetinstance_id,
    asi.m_attributeset_id,
    asi.serno,
    asi.lot,
    asi.m_lot_id,
    asi.guaranteedate,
    p.description AS productdescription,
    p.imageurl,
    il.c_campaign_id,
    il.c_project_id,
    il.c_activity_id,
    il.c_projectphase_id,
    il.c_projecttask_id,
    il.ad_orgtrx_id AS c_invoiceline_ad_orgtrx_id,
    il.a_processed,
    il.c_charge_id,
    il.c_orderline_id,
    il.c_uom_id,
    il.isdescription,
    il.isprinted AS c_invoiceline_isprinted,
    il.m_inoutline_id,
    il.m_rmaline_id,
    il.pricelimit,
    il.processed AS c_invoiceline_processed,
    il.ref_invoiceline_id,
    il.rramt,
    il.rrstartdate,
    il.s_resourceassignment_id,
    il.user1_id AS c_invoiceline_user1_id,
    il.user2_id AS c_invoiceline_user2_id,
    uom.ad_org_id AS c_uom_ad_org_id,
    uom.costingprecision,
    uom.description AS c_uom_description,
    uom.isactive AS c_uom_isactive,
    uom.isdefault AS c_uom_isdefault,
    uom.name AS c_uom_name,
    uom.stdprecision,
    uom.uomtype,
    uom.x12de355,
    i.ad_org_id AS c_invoice_ad_org_id,
    i.ad_orgtrx_id AS c_invoice_ad_orgtrx_id,
    i.ad_user_id AS c_invoice_ad_user_id,
    i.c_activity_id AS c_invoice_c_activity_id,
    i.c_bpartner_id AS c_invoice_c_bpartner_id,
    i.c_bpartner_location_id,
    i.c_campaign_id AS c_invoice_c_campaign_id,
    i.c_charge_id AS c_invoice_c_charge_id,
    i.c_conversiontype_id,
    i.c_currency_id,
    COALESCE(cur.cursymbol, (cur.iso_code)::character varying) AS cursymbol,
    i.c_doctype_id,
    i.c_doctypetarget_id,
    i.c_dunninglevel_id,
    i.chargeamt AS c_invoice_chargeamt,
    i.c_order_id,
    i.c_payment_id,
    i.c_paymentterm_id,
    i.c_project_id AS c_invoice_c_project_id,
    i.created AS c_invoice_created,
    i.createdby AS c_invoice_createdby,
    i.dateacct,
    i.dateinvoiced,
    i.dateordered,
    i.dateprinted,
    i.description AS c_invoice_description,
    i.docaction,
    i.docstatus,
    i.documentno,
    i.dunninggrace,
    i.generateto,
    i.grandtotal,
    i.invoicecollectiontype,
    i.isactive AS c_invoice_isactive,
    i.isapproved,
    i.isdiscountprinted,
    i.isindispute,
    i.ispaid,
    i.ispayschedulevalid,
    i.isprinted AS c_invoice_isprinted,
    i.isselfservice AS c_invoice_isselfservice,
    i.issotrx,
    i.istaxincluded AS c_invoice_istaxincluded,
    i.istransferred,
    i.m_pricelist_id,
    i.m_rma_id,
    i.paymentrule,
    i.poreference,
    i.posted,
    i.processedon,
    i.processing,
    i.ref_invoice_id,
    i.reversal_id,
    i.salesrep_id,
    i.sendemail,
    i.totallines,
    i.updated AS c_invoice_updated,
    i.updatedby AS c_invoice_updatedby,
    i.user1_id AS c_invoice_user1_id,
    i.user2_id AS c_invoice_user2_id,
    t.ad_org_id AS c_tax_ad_org_id,
    t.ad_rule_id,
    t.c_country_id,
    t.c_region_id,
    t.c_taxcategory_id AS c_tax_c_taxcategory_id,
    t.description AS c_tax_description,
    t.isactive AS c_tax_isactive,
    t.isdefault AS c_tax_isdefault,
    t.isdocumentlevel,
    t.issalestax,
    t.issummary AS c_tax_issummary,
    t.istaxexempt,
    t.name AS c_tax_name,
    t.parent_tax_id,
    t.rate,
    t.requirestaxcertificate,
    t.sopotype,
    t.to_country_id,
    t.to_region_id,
    t.validfrom,
    p.ad_org_id AS m_product_ad_org_id,
    p.classification,
    p.copyfrom AS m_product_copyfrom,
    p.created AS m_product_created,
    p.createdby AS m_product_createdby,
    p.c_revenuerecognition_id,
    p.c_subscriptiontype_id,
    p.c_taxcategory_id AS m_product_c_taxcategory_id,
    p.descriptionurl,
    p.discontinued,
    p.discontinuedat,
    p.group1,
    p.group2,
    p.guaranteedays,
    p.guaranteedaysmin,
    p.help,
    p.isactive AS m_product_isactive,
    p.isbom,
    p.isdropship,
    p.isexcludeautodelivery,
    p.isinvoiceprintdetails,
    p.ispicklistprintdetails,
    p.ispurchased,
    p.isselfservice AS m_product_isselfservice,
    p.issold,
    p.isstocked,
    p.issummary AS m_product_issummary,
    p.isverified,
    p.iswebstorefeatured,
    p.lowlevel,
    p.m_attributeset_id AS m_product_m_attributeset_id,
    p.m_attributesetinstance_id AS m_product_m_asi_id,
    p.m_freightcategory_id,
    p.m_locator_id,
    p.m_product_category_id AS m_product_m_prod_category_id,
    p.processing AS m_product_processing,
    p.producttype,
    p.r_mailtext_id,
    p.salesrep_id AS m_product_salesrep_id,
    p.s_expensetype_id,
    p.shelfdepth,
    p.shelfheight,
    p.shelfwidth,
    p.s_resource_id AS m_product_s_resource_id,
    p.unitsperpack,
    p.unitsperpallet,
    p.updated AS m_product_updated,
    p.updatedby AS m_product_updatedby,
    p.versionno,
    p.volume,
    p.weight,
    c.ad_org_id AS c_charge_ad_org_id,
    c.c_bpartner_id AS c_charge_c_bpartner_id,
    c.c_chargetype_id,
    c.chargeamt AS c_charge_chargeamt,
    c.c_taxcategory_id AS c_charge_c_taxcategory_id,
    c.description AS c_charge_description,
    c.isactive AS c_charge_isactive,
    c.issamecurrency,
    c.issametax,
    c.istaxincluded AS c_charge_istaxincluded,
    pp.ad_org_id AS c_bp_product_ad_org_id,
    pp.c_bpartner_id AS c_bp_product_c_bpartner_id,
    pp.created AS c_bp_product_created,
    pp.createdby AS c_bp_product_createdby,
    pp.description AS c_bp_product_description,
    pp.isactive AS c_bp_product_isactive,
    pp.ismanufacturer,
    pp.manufacturer,
    pp.qualityrating,
    pp.shelflifemindays,
    pp.shelflifeminpct,
    pp.updated AS c_bp_product_updated,
    pp.updatedby AS c_bp_product_updatedby,
    pp.vendorcategory,
    ra.ad_org_id AS s_rassignment_ad_org_id,
    ra.assigndatefrom,
    ra.assigndateto,
    ra.created AS s_rassignment_created,
    ra.createdby AS s_rassignment_createby,
    ra.isactive AS s_rassignment_isactive,
    ra.isconfirmed,
    ra.name AS s_rassignment_name,
    ra.qty AS s_rassignment_qty,
    ra.s_resource_id AS s_rassignment_s_resource_id,
    ra.updated AS s_rassignment_updated,
    ra.updatedby AS s_rassignment_updatedby,
    asi.ad_org_id AS m_asi_ad_org_id,
    asi.created AS m_asi_created,
    asi.createdby AS m_asi_createdby,
    asi.description AS m_asi_description,
    asi.isactive AS m_asi_isactive,
    asi.updated AS m_asi_updated,
    asi.updatedby AS m_asi_updatedby
   FROM (((((((((c_invoiceline il
     JOIN c_uom uom ON ((il.c_uom_id = uom.c_uom_id)))
     JOIN c_invoice i ON ((il.c_invoice_id = i.c_invoice_id)))
     LEFT JOIN c_tax t ON ((il.c_tax_id = t.c_tax_id)))
     LEFT JOIN m_product p ON ((il.m_product_id = p.m_product_id)))
     LEFT JOIN c_charge c ON ((il.c_charge_id = c.c_charge_id)))
     LEFT JOIN c_bpartner_product pp ON (((il.m_product_id = pp.m_product_id) AND (i.c_bpartner_id = pp.c_bpartner_id))))
     LEFT JOIN s_resourceassignment ra ON ((il.s_resourceassignment_id = ra.s_resourceassignment_id)))
     LEFT JOIN m_attributesetinstance asi ON ((il.m_attributesetinstance_id = asi.m_attributesetinstance_id)))
     LEFT JOIN c_currency cur ON ((i.c_currency_id = cur.c_currency_id)))
UNION
 SELECT il.ad_client_id,
    il.ad_org_id,
    il.isactive,
    il.created,
    il.createdby,
    il.updated,
    il.updatedby,
    'en_US'::character varying(6) AS ad_language,
    il.c_invoice_id,
    il.c_invoiceline_id,
    il.c_tax_id,
    il.taxamt,
    il.linetotalamt,
    t.taxindicator,
    (il.line + (bl.line / (100)::numeric)) AS line,
    p.m_product_id,
        CASE
            WHEN (bl.isqtypercentage = 'N'::bpchar) THEN (il.qtyinvoiced * bl.qtybom)
            ELSE (il.qtyinvoiced * (bl.qtybatch / (100)::numeric))
        END AS qtyinvoiced,
        CASE
            WHEN (bl.isqtypercentage = 'N'::bpchar) THEN (il.qtyentered * bl.qtybom)
            ELSE (il.qtyentered * (bl.qtybatch / (100)::numeric))
        END AS qtyentered,
    uom.uomsymbol,
    COALESCE(p.wmv_display_precision, uom.stdprecision, (2)::numeric) AS qtyprecision,
    p.name,
    b.description,
    p.documentnote,
    p.upc,
    p.sku,
    p.value AS productvalue,
    NULL::character varying AS resourcedescription,
    NULL::numeric AS pricelist,
    NULL::numeric AS priceenteredlist,
    NULL::numeric AS discount,
    NULL::numeric AS priceactual,
    NULL::numeric AS priceentered,
    NULL::numeric AS linenetamt,
    il.m_attributesetinstance_id,
    asi.m_attributeset_id,
    asi.serno,
    asi.lot,
    asi.m_lot_id,
    asi.guaranteedate,
    p.description AS productdescription,
    p.imageurl,
    il.c_campaign_id,
    il.c_project_id,
    il.c_activity_id,
    il.c_projectphase_id,
    il.c_projecttask_id,
    il.ad_orgtrx_id AS c_invoiceline_ad_orgtrx_id,
    il.a_processed,
    il.c_charge_id,
    il.c_orderline_id,
    il.c_uom_id,
    il.isdescription,
    il.isprinted AS c_invoiceline_isprinted,
    il.m_inoutline_id,
    il.m_rmaline_id,
    il.pricelimit,
    il.processed AS c_invoiceline_processed,
    il.ref_invoiceline_id,
    il.rramt,
    il.rrstartdate,
    il.s_resourceassignment_id,
    il.user1_id AS c_invoiceline_user1_id,
    il.user2_id AS c_invoiceline_user2_id,
    uom.ad_org_id AS c_uom_ad_org_id,
    uom.costingprecision,
    uom.description AS c_uom_description,
    uom.isactive AS c_uom_isactive,
    uom.isdefault AS c_uom_isdefault,
    uom.name AS c_uom_name,
    uom.stdprecision,
    uom.uomtype,
    uom.x12de355,
    NULL::numeric AS c_invoice_ad_org_id,
    NULL::numeric AS c_invoice_ad_orgtrx_id,
    NULL::numeric AS c_invoice_ad_user_id,
    NULL::numeric AS c_invoice_c_activity_id,
    NULL::numeric AS c_invoice_c_bpartner_id,
    NULL::numeric AS c_bpartner_location_id,
    NULL::numeric AS c_invoice_c_campaign_id,
    NULL::numeric AS c_invoice_c_charge_id,
    NULL::numeric AS c_conversiontype_id,
    NULL::numeric AS c_currency_id,
    NULL::character varying AS cursymbol,
    NULL::numeric AS c_doctype_id,
    NULL::numeric AS c_doctypetarget_id,
    NULL::numeric AS c_dunninglevel_id,
    NULL::numeric AS c_invoice_chargeamt,
    NULL::numeric AS c_order_id,
    NULL::numeric AS c_payment_id,
    NULL::numeric AS c_paymentterm_id,
    NULL::numeric AS c_invoice_c_project_id,
    NULL::timestamp without time zone AS c_invoice_created,
    NULL::numeric AS c_invoice_createdby,
    NULL::timestamp without time zone AS dateacct,
    NULL::timestamp without time zone AS dateinvoiced,
    NULL::timestamp without time zone AS dateordered,
    NULL::timestamp without time zone AS dateprinted,
    NULL::character varying AS c_invoice_description,
    NULL::bpchar AS docaction,
    NULL::bpchar AS docstatus,
    NULL::character varying AS documentno,
    NULL::date AS dunninggrace,
    NULL::bpchar AS generateto,
    NULL::numeric AS grandtotal,
    NULL::bpchar AS invoicecollectiontype,
    NULL::bpchar AS c_invoice_isactive,
    NULL::bpchar AS isapproved,
    NULL::bpchar AS isdiscountprinted,
    NULL::bpchar AS isindispute,
    NULL::bpchar AS ispaid,
    NULL::bpchar AS ispayschedulevalid,
    NULL::bpchar AS c_invoice_isprinted,
    NULL::bpchar AS c_invoice_isselfservice,
    NULL::bpchar AS issotrx,
    NULL::bpchar AS c_invoice_istaxincluded,
    NULL::bpchar AS istransferred,
    NULL::numeric AS m_pricelist_id,
    NULL::numeric AS m_rma_id,
    NULL::bpchar AS paymentrule,
    NULL::character varying AS poreference,
    NULL::bpchar AS posted,
    NULL::numeric AS processedon,
    NULL::bpchar AS processing,
    NULL::numeric AS ref_invoice_id,
    NULL::numeric AS reversal_id,
    NULL::numeric AS salesrep_id,
    NULL::bpchar AS sendemail,
    NULL::numeric AS totallines,
    NULL::timestamp without time zone AS c_invoice_updated,
    NULL::numeric AS c_invoice_updatedby,
    NULL::numeric AS c_invoice_user1_id,
    NULL::numeric AS c_invoice_user2_id,
    t.ad_org_id AS c_tax_ad_org_id,
    t.ad_rule_id,
    t.c_country_id,
    t.c_region_id,
    t.c_taxcategory_id AS c_tax_c_taxcategory_id,
    t.description AS c_tax_description,
    t.isactive AS c_tax_isactive,
    t.isdefault AS c_tax_isdefault,
    t.isdocumentlevel,
    t.issalestax,
    t.issummary AS c_tax_issummary,
    t.istaxexempt,
    t.name AS c_tax_name,
    t.parent_tax_id,
    t.rate,
    t.requirestaxcertificate,
    t.sopotype,
    t.to_country_id,
    t.to_region_id,
    t.validfrom,
    p.ad_org_id AS m_product_ad_org_id,
    p.classification,
    p.copyfrom AS m_product_copyfrom,
    p.created AS m_product_created,
    p.createdby AS m_product_createdby,
    p.c_revenuerecognition_id,
    p.c_subscriptiontype_id,
    p.c_taxcategory_id AS m_product_c_taxcategory_id,
    p.descriptionurl,
    p.discontinued,
    p.discontinuedat,
    p.group1,
    p.group2,
    p.guaranteedays,
    p.guaranteedaysmin,
    p.help,
    p.isactive AS m_product_isactive,
    p.isbom,
    p.isdropship,
    p.isexcludeautodelivery,
    p.isinvoiceprintdetails,
    p.ispicklistprintdetails,
    p.ispurchased,
    p.isselfservice AS m_product_isselfservice,
    p.issold,
    p.isstocked,
    p.issummary AS m_product_issummary,
    p.isverified,
    p.iswebstorefeatured,
    p.lowlevel,
    p.m_attributeset_id AS m_product_m_attributeset_id,
    p.m_attributesetinstance_id AS m_product_m_asi_id,
    p.m_freightcategory_id,
    p.m_locator_id,
    p.m_product_category_id AS m_product_m_prod_category_id,
    p.processing AS m_product_processing,
    p.producttype,
    p.r_mailtext_id,
    p.salesrep_id AS m_product_salesrep_id,
    p.s_expensetype_id,
    p.shelfdepth,
    p.shelfheight,
    p.shelfwidth,
    p.s_resource_id AS m_product_s_resource_id,
    p.unitsperpack,
    p.unitsperpallet,
    p.updated AS m_product_updated,
    p.updatedby AS m_product_updatedby,
    p.versionno,
    p.volume,
    p.weight,
    NULL::numeric AS c_charge_ad_org_id,
    NULL::numeric AS c_charge_c_bpartner_id,
    NULL::numeric AS c_chargetype_id,
    NULL::numeric AS c_charge_chargeamt,
    NULL::numeric AS c_charge_c_taxcategory_id,
    NULL::character varying AS c_charge_description,
    NULL::bpchar AS c_charge_isactive,
    NULL::bpchar AS issamecurrency,
    NULL::bpchar AS issametax,
    NULL::bpchar AS c_charge_istaxincluded,
    NULL::numeric AS c_bp_product_ad_org_id,
    NULL::numeric AS c_bp_product_c_bpartner_id,
    NULL::timestamp without time zone AS c_bp_product_created,
    NULL::numeric AS c_bp_product_createdby,
    NULL::character varying AS c_bp_product_description,
    NULL::bpchar AS c_bp_product_isactive,
    NULL::bpchar AS ismanufacturer,
    NULL::character varying AS manufacturer,
    NULL::numeric AS qualityrating,
    NULL::numeric AS shelflifemindays,
    NULL::numeric AS shelflifeminpct,
    NULL::timestamp without time zone AS c_bp_product_updated,
    NULL::numeric AS c_bp_product_updatedby,
    NULL::character varying AS vendorcategory,
    NULL::numeric AS s_rassignment_ad_org_id,
    NULL::timestamp without time zone AS assigndatefrom,
    NULL::timestamp without time zone AS assigndateto,
    NULL::timestamp without time zone AS s_rassignment_created,
    NULL::numeric AS s_rassignment_createby,
    NULL::bpchar AS s_rassignment_isactive,
    NULL::bpchar AS isconfirmed,
    NULL::character varying AS s_rassignment_name,
    NULL::numeric AS s_rassignment_qty,
    NULL::numeric AS s_rassignment_s_resource_id,
    NULL::timestamp without time zone AS s_rassignment_updated,
    NULL::numeric AS s_rassignment_updatedby,
    asi.ad_org_id AS m_asi_ad_org_id,
    asi.created AS m_asi_created,
    asi.createdby AS m_asi_createdby,
    asi.description AS m_asi_description,
    asi.isactive AS m_asi_isactive,
    asi.updated AS m_asi_updated,
    asi.updatedby AS m_asi_updatedby
   FROM (((((((pp_product_bom b
     JOIN c_invoiceline il ON ((b.m_product_id = il.m_product_id)))
     JOIN m_product bp ON (((bp.m_product_id = il.m_product_id) AND (bp.isbom = 'Y'::bpchar) AND (bp.isverified = 'Y'::bpchar) AND (bp.isinvoiceprintdetails = 'Y'::bpchar))))
     JOIN pp_product_bomline bl ON ((bl.pp_product_bom_id = b.pp_product_bom_id)))
     JOIN m_product p ON ((bl.m_product_id = p.m_product_id)))
     JOIN c_uom uom ON ((p.c_uom_id = uom.c_uom_id)))
     LEFT JOIN c_tax t ON ((il.c_tax_id = t.c_tax_id)))
     LEFT JOIN m_attributesetinstance asi ON ((il.m_attributesetinstance_id = asi.m_attributesetinstance_id)))
UNION
 SELECT il.ad_client_id,
    il.ad_org_id,
    il.isactive,
    il.created,
    il.createdby,
    il.updated,
    il.updatedby,
    'en_US'::character varying(6) AS ad_language,
    il.c_invoice_id,
    il.c_invoiceline_id,
    NULL::numeric AS c_tax_id,
    NULL::numeric AS taxamt,
    NULL::numeric AS linetotalamt,
    NULL::character varying AS taxindicator,
    il.line,
    NULL::numeric AS m_product_id,
    NULL::numeric AS qtyinvoiced,
    NULL::numeric AS qtyentered,
    NULL::character varying AS uomsymbol,
    NULL::integer AS qtyprecision,
    il.description AS name,
    NULL::character varying AS description,
    NULL::character varying AS documentnote,
    NULL::character varying AS upc,
    NULL::character varying AS sku,
    NULL::character varying AS productvalue,
    NULL::character varying AS resourcedescription,
    NULL::numeric AS pricelist,
    NULL::numeric AS priceenteredlist,
    NULL::numeric AS discount,
    NULL::numeric AS priceactual,
    NULL::numeric AS priceentered,
    NULL::numeric AS linenetamt,
    NULL::numeric AS m_attributesetinstance_id,
    NULL::numeric AS m_attributeset_id,
    NULL::character varying AS serno,
    NULL::character varying AS lot,
    NULL::numeric AS m_lot_id,
    NULL::timestamp without time zone AS guaranteedate,
    NULL::character varying AS productdescription,
    NULL::character varying AS imageurl,
    NULL::numeric AS c_campaign_id,
    NULL::numeric AS c_project_id,
    NULL::numeric AS c_activity_id,
    NULL::numeric AS c_projectphase_id,
    NULL::numeric AS c_projecttask_id,
    NULL::numeric AS c_invoiceline_ad_orgtrx_id,
    NULL::bpchar AS a_processed,
    NULL::numeric AS c_charge_id,
    NULL::numeric AS c_orderline_id,
    NULL::numeric AS c_uom_id,
    NULL::bpchar AS isdescription,
    NULL::bpchar AS c_invoiceline_isprinted,
    NULL::numeric AS m_inoutline_id,
    NULL::numeric AS m_rmaline_id,
    NULL::numeric AS pricelimit,
    NULL::bpchar AS c_invoiceline_processed,
    NULL::numeric AS ref_invoiceline_id,
    NULL::numeric AS rramt,
    NULL::timestamp without time zone AS rrstartdate,
    NULL::numeric AS s_resourceassignment_id,
    NULL::numeric AS c_invoiceline_user1_id,
    NULL::numeric AS c_invoiceline_user2_id,
    NULL::numeric AS c_uom_ad_org_id,
    NULL::numeric AS costingprecision,
    NULL::character varying AS c_uom_description,
    NULL::bpchar AS c_uom_isactive,
    NULL::bpchar AS c_uom_isdefault,
    NULL::character varying AS c_uom_name,
    NULL::numeric AS stdprecision,
    NULL::character varying AS uomtype,
    NULL::character varying AS x12de355,
    NULL::numeric AS c_invoice_ad_org_id,
    NULL::numeric AS c_invoice_ad_orgtrx_id,
    NULL::numeric AS c_invoice_ad_user_id,
    NULL::numeric AS c_invoice_c_activity_id,
    NULL::numeric AS c_invoice_c_bpartner_id,
    NULL::numeric AS c_bpartner_location_id,
    NULL::numeric AS c_invoice_c_campaign_id,
    NULL::numeric AS c_invoice_c_charge_id,
    NULL::numeric AS c_conversiontype_id,
    NULL::numeric AS c_currency_id,
    NULL::character varying AS cursymbol,
    NULL::numeric AS c_doctype_id,
    NULL::numeric AS c_doctypetarget_id,
    NULL::numeric AS c_dunninglevel_id,
    NULL::numeric AS c_invoice_chargeamt,
    NULL::numeric AS c_order_id,
    NULL::numeric AS c_payment_id,
    NULL::numeric AS c_paymentterm_id,
    NULL::numeric AS c_invoice_c_project_id,
    NULL::timestamp without time zone AS c_invoice_created,
    NULL::numeric AS c_invoice_createdby,
    NULL::timestamp without time zone AS dateacct,
    NULL::timestamp without time zone AS dateinvoiced,
    NULL::timestamp without time zone AS dateordered,
    NULL::timestamp without time zone AS dateprinted,
    NULL::character varying AS c_invoice_description,
    NULL::bpchar AS docaction,
    NULL::bpchar AS docstatus,
    NULL::character varying AS documentno,
    NULL::date AS dunninggrace,
    NULL::bpchar AS generateto,
    NULL::numeric AS grandtotal,
    NULL::bpchar AS invoicecollectiontype,
    NULL::bpchar AS c_invoice_isactive,
    NULL::bpchar AS isapproved,
    NULL::bpchar AS isdiscountprinted,
    NULL::bpchar AS isindispute,
    NULL::bpchar AS ispaid,
    NULL::bpchar AS ispayschedulevalid,
    NULL::bpchar AS c_invoice_isprinted,
    NULL::bpchar AS c_invoice_isselfservice,
    NULL::bpchar AS issotrx,
    NULL::bpchar AS c_invoice_istaxincluded,
    NULL::bpchar AS istransferred,
    NULL::numeric AS m_pricelist_id,
    NULL::numeric AS m_rma_id,
    NULL::bpchar AS paymentrule,
    NULL::character varying AS poreference,
    NULL::bpchar AS posted,
    NULL::numeric AS processedon,
    NULL::bpchar AS processing,
    NULL::numeric AS ref_invoice_id,
    NULL::numeric AS reversal_id,
    NULL::numeric AS salesrep_id,
    NULL::bpchar AS sendemail,
    NULL::numeric AS totallines,
    NULL::timestamp without time zone AS c_invoice_updated,
    NULL::numeric AS c_invoice_updatedby,
    NULL::numeric AS c_invoice_user1_id,
    NULL::numeric AS c_invoice_user2_id,
    NULL::numeric AS c_tax_ad_org_id,
    NULL::numeric AS ad_rule_id,
    NULL::numeric AS c_country_id,
    NULL::numeric AS c_region_id,
    NULL::numeric AS c_tax_c_taxcategory_id,
    NULL::character varying AS c_tax_description,
    NULL::bpchar AS c_tax_isactive,
    NULL::bpchar AS c_tax_isdefault,
    NULL::bpchar AS isdocumentlevel,
    NULL::bpchar AS issalestax,
    NULL::bpchar AS c_tax_issummary,
    NULL::bpchar AS istaxexempt,
    NULL::character varying AS c_tax_name,
    NULL::numeric AS parent_tax_id,
    NULL::numeric AS rate,
    NULL::bpchar AS requirestaxcertificate,
    NULL::bpchar AS sopotype,
    NULL::numeric AS to_country_id,
    NULL::numeric AS to_region_id,
    NULL::timestamp without time zone AS validfrom,
    NULL::numeric AS m_product_ad_org_id,
    NULL::character varying AS classification,
    NULL::bpchar AS m_product_copyfrom,
    NULL::timestamp without time zone AS m_product_created,
    NULL::numeric AS m_product_createdby,
    NULL::numeric AS c_revenuerecognition_id,
    NULL::numeric AS c_subscriptiontype_id,
    NULL::numeric AS m_product_c_taxcategory_id,
    NULL::character varying AS descriptionurl,
    NULL::bpchar AS discontinued,
    NULL::timestamp without time zone AS discontinuedat,
    NULL::character varying AS group1,
    NULL::character varying AS group2,
    NULL::numeric AS guaranteedays,
    NULL::numeric AS guaranteedaysmin,
    NULL::character varying AS help,
    NULL::bpchar AS m_product_isactive,
    NULL::bpchar AS isbom,
    NULL::bpchar AS isdropship,
    NULL::bpchar AS isexcludeautodelivery,
    NULL::bpchar AS isinvoiceprintdetails,
    NULL::bpchar AS ispicklistprintdetails,
    NULL::bpchar AS ispurchased,
    NULL::bpchar AS m_product_isselfservice,
    NULL::bpchar AS issold,
    NULL::bpchar AS isstocked,
    NULL::bpchar AS m_product_issummary,
    NULL::bpchar AS isverified,
    NULL::bpchar AS iswebstorefeatured,
    NULL::numeric AS lowlevel,
    NULL::numeric AS m_product_m_attributeset_id,
    NULL::numeric AS m_product_m_asi_id,
    NULL::numeric AS m_freightcategory_id,
    NULL::numeric AS m_locator_id,
    NULL::numeric AS m_product_m_prod_category_id,
    NULL::bpchar AS m_product_processing,
    NULL::bpchar AS producttype,
    NULL::numeric AS r_mailtext_id,
    NULL::numeric AS m_product_salesrep_id,
    NULL::numeric AS s_expensetype_id,
    NULL::numeric AS shelfdepth,
    NULL::numeric AS shelfheight,
    NULL::numeric AS shelfwidth,
    NULL::numeric AS m_product_s_resource_id,
    NULL::numeric AS unitsperpack,
    NULL::numeric AS unitsperpallet,
    NULL::timestamp without time zone AS m_product_updated,
    NULL::numeric AS m_product_updatedby,
    NULL::character varying AS versionno,
    NULL::numeric AS volume,
    NULL::numeric AS weight,
    NULL::numeric AS c_charge_ad_org_id,
    NULL::numeric AS c_charge_c_bpartner_id,
    NULL::numeric AS c_chargetype_id,
    NULL::numeric AS c_charge_chargeamt,
    NULL::numeric AS c_charge_c_taxcategory_id,
    NULL::character varying AS c_charge_description,
    NULL::bpchar AS c_charge_isactive,
    NULL::bpchar AS issamecurrency,
    NULL::bpchar AS issametax,
    NULL::bpchar AS c_charge_istaxincluded,
    NULL::numeric AS c_bp_product_ad_org_id,
    NULL::numeric AS c_bp_product_c_bpartner_id,
    NULL::timestamp without time zone AS c_bp_product_created,
    NULL::numeric AS c_bp_product_createdby,
    NULL::character varying AS c_bp_product_description,
    NULL::bpchar AS c_bp_product_isactive,
    NULL::bpchar AS ismanufacturer,
    NULL::character varying AS manufacturer,
    NULL::numeric AS qualityrating,
    NULL::numeric AS shelflifemindays,
    NULL::numeric AS shelflifeminpct,
    NULL::timestamp without time zone AS c_bp_product_updated,
    NULL::numeric AS c_bp_product_updatedby,
    NULL::character varying AS vendorcategory,
    NULL::numeric AS s_rassignment_ad_org_id,
    NULL::timestamp without time zone AS assigndatefrom,
    NULL::timestamp without time zone AS assigndateto,
    NULL::timestamp without time zone AS s_rassignment_created,
    NULL::numeric AS s_rassignment_createby,
    NULL::bpchar AS s_rassignment_isactive,
    NULL::bpchar AS isconfirmed,
    NULL::character varying AS s_rassignment_name,
    NULL::numeric AS s_rassignment_qty,
    NULL::numeric AS s_rassignment_s_resource_id,
    NULL::timestamp without time zone AS s_rassignment_updated,
    NULL::numeric AS s_rassignment_updatedby,
    NULL::numeric AS m_asi_ad_org_id,
    NULL::timestamp without time zone AS m_asi_created,
    NULL::numeric AS m_asi_createdby,
    NULL::character varying AS m_asi_description,
    NULL::bpchar AS m_asi_isactive,
    NULL::timestamp without time zone AS m_asi_updated,
    NULL::numeric AS m_asi_updatedby
   FROM c_invoiceline il
  WHERE (il.c_uom_id IS NULL)
UNION
 SELECT i.ad_client_id,
    i.ad_org_id,
    i.isactive,
    i.created,
    i.createdby,
    i.updated,
    i.updatedby,
    'en_US'::character varying(6) AS ad_language,
    i.c_invoice_id,
    NULL::numeric AS c_invoiceline_id,
    NULL::numeric AS c_tax_id,
    NULL::numeric AS taxamt,
    NULL::numeric AS linetotalamt,
    NULL::character varying AS taxindicator,
    999998 AS line,
    NULL::numeric AS m_product_id,
    NULL::numeric AS qtyinvoiced,
    NULL::numeric AS qtyentered,
    NULL::character varying AS uomsymbol,
    NULL::integer AS qtyprecision,
    NULL::character varying AS name,
    NULL::character varying AS description,
    NULL::character varying AS documentnote,
    NULL::character varying AS upc,
    NULL::character varying AS sku,
    NULL::character varying AS productvalue,
    NULL::character varying AS resourcedescription,
    NULL::numeric AS pricelist,
    NULL::numeric AS priceenteredlist,
    NULL::numeric AS discount,
    NULL::numeric AS priceactual,
    NULL::numeric AS priceentered,
    NULL::numeric AS linenetamt,
    NULL::numeric AS m_attributesetinstance_id,
    NULL::numeric AS m_attributeset_id,
    NULL::character varying AS serno,
    NULL::character varying AS lot,
    NULL::numeric AS m_lot_id,
    NULL::timestamp without time zone AS guaranteedate,
    NULL::character varying AS productdescription,
    NULL::character varying AS imageurl,
    NULL::numeric AS c_campaign_id,
    NULL::numeric AS c_project_id,
    NULL::numeric AS c_activity_id,
    NULL::numeric AS c_projectphase_id,
    NULL::numeric AS c_projecttask_id,
    NULL::numeric AS c_invoiceline_ad_orgtrx_id,
    NULL::bpchar AS a_processed,
    NULL::numeric AS c_charge_id,
    NULL::numeric AS c_orderline_id,
    NULL::numeric AS c_uom_id,
    NULL::bpchar AS isdescription,
    NULL::bpchar AS c_invoiceline_isprinted,
    NULL::numeric AS m_inoutline_id,
    NULL::numeric AS m_rmaline_id,
    NULL::numeric AS pricelimit,
    NULL::bpchar AS c_invoiceline_processed,
    NULL::numeric AS ref_invoiceline_id,
    NULL::numeric AS rramt,
    NULL::timestamp without time zone AS rrstartdate,
    NULL::numeric AS s_resourceassignment_id,
    NULL::numeric AS c_invoiceline_user1_id,
    NULL::numeric AS c_invoiceline_user2_id,
    NULL::numeric AS c_uom_ad_org_id,
    NULL::numeric AS costingprecision,
    NULL::character varying AS c_uom_description,
    NULL::bpchar AS c_uom_isactive,
    NULL::bpchar AS c_uom_isdefault,
    NULL::character varying AS c_uom_name,
    NULL::numeric AS stdprecision,
    NULL::character varying AS uomtype,
    NULL::character varying AS x12de355,
    NULL::numeric AS c_invoice_ad_org_id,
    NULL::numeric AS c_invoice_ad_orgtrx_id,
    NULL::numeric AS c_invoice_ad_user_id,
    NULL::numeric AS c_invoice_c_activity_id,
    NULL::numeric AS c_invoice_c_bpartner_id,
    NULL::numeric AS c_bpartner_location_id,
    NULL::numeric AS c_invoice_c_campaign_id,
    NULL::numeric AS c_invoice_c_charge_id,
    NULL::numeric AS c_conversiontype_id,
    NULL::numeric AS c_currency_id,
    NULL::character varying AS cursymbol,
    NULL::numeric AS c_doctype_id,
    NULL::numeric AS c_doctypetarget_id,
    NULL::numeric AS c_dunninglevel_id,
    NULL::numeric AS c_invoice_chargeamt,
    NULL::numeric AS c_order_id,
    NULL::numeric AS c_payment_id,
    NULL::numeric AS c_paymentterm_id,
    NULL::numeric AS c_invoice_c_project_id,
    NULL::timestamp without time zone AS c_invoice_created,
    NULL::numeric AS c_invoice_createdby,
    NULL::timestamp without time zone AS dateacct,
    NULL::timestamp without time zone AS dateinvoiced,
    NULL::timestamp without time zone AS dateordered,
    NULL::timestamp without time zone AS dateprinted,
    NULL::character varying AS c_invoice_description,
    NULL::bpchar AS docaction,
    NULL::bpchar AS docstatus,
    NULL::character varying AS documentno,
    NULL::date AS dunninggrace,
    NULL::bpchar AS generateto,
    NULL::numeric AS grandtotal,
    NULL::bpchar AS invoicecollectiontype,
    NULL::bpchar AS c_invoice_isactive,
    NULL::bpchar AS isapproved,
    NULL::bpchar AS isdiscountprinted,
    NULL::bpchar AS isindispute,
    NULL::bpchar AS ispaid,
    NULL::bpchar AS ispayschedulevalid,
    NULL::bpchar AS c_invoice_isprinted,
    NULL::bpchar AS c_invoice_isselfservice,
    NULL::bpchar AS issotrx,
    NULL::bpchar AS c_invoice_istaxincluded,
    NULL::bpchar AS istransferred,
    NULL::numeric AS m_pricelist_id,
    NULL::numeric AS m_rma_id,
    NULL::bpchar AS paymentrule,
    NULL::character varying AS poreference,
    NULL::bpchar AS posted,
    NULL::numeric AS processedon,
    NULL::bpchar AS processing,
    NULL::numeric AS ref_invoice_id,
    NULL::numeric AS reversal_id,
    NULL::numeric AS salesrep_id,
    NULL::bpchar AS sendemail,
    NULL::numeric AS totallines,
    NULL::timestamp without time zone AS c_invoice_updated,
    NULL::numeric AS c_invoice_updatedby,
    NULL::numeric AS c_invoice_user1_id,
    NULL::numeric AS c_invoice_user2_id,
    NULL::numeric AS c_tax_ad_org_id,
    NULL::numeric AS ad_rule_id,
    NULL::numeric AS c_country_id,
    NULL::numeric AS c_region_id,
    NULL::numeric AS c_tax_c_taxcategory_id,
    NULL::character varying AS c_tax_description,
    NULL::bpchar AS c_tax_isactive,
    NULL::bpchar AS c_tax_isdefault,
    NULL::bpchar AS isdocumentlevel,
    NULL::bpchar AS issalestax,
    NULL::bpchar AS c_tax_issummary,
    NULL::bpchar AS istaxexempt,
    NULL::character varying AS c_tax_name,
    NULL::numeric AS parent_tax_id,
    NULL::numeric AS rate,
    NULL::bpchar AS requirestaxcertificate,
    NULL::bpchar AS sopotype,
    NULL::numeric AS to_country_id,
    NULL::numeric AS to_region_id,
    NULL::timestamp without time zone AS validfrom,
    NULL::numeric AS m_product_ad_org_id,
    NULL::character varying AS classification,
    NULL::bpchar AS m_product_copyfrom,
    NULL::timestamp without time zone AS m_product_created,
    NULL::numeric AS m_product_createdby,
    NULL::numeric AS c_revenuerecognition_id,
    NULL::numeric AS c_subscriptiontype_id,
    NULL::numeric AS m_product_c_taxcategory_id,
    NULL::character varying AS descriptionurl,
    NULL::bpchar AS discontinued,
    NULL::timestamp without time zone AS discontinuedat,
    NULL::character varying AS group1,
    NULL::character varying AS group2,
    NULL::numeric AS guaranteedays,
    NULL::numeric AS guaranteedaysmin,
    NULL::character varying AS help,
    NULL::bpchar AS m_product_isactive,
    NULL::bpchar AS isbom,
    NULL::bpchar AS isdropship,
    NULL::bpchar AS isexcludeautodelivery,
    NULL::bpchar AS isinvoiceprintdetails,
    NULL::bpchar AS ispicklistprintdetails,
    NULL::bpchar AS ispurchased,
    NULL::bpchar AS m_product_isselfservice,
    NULL::bpchar AS issold,
    NULL::bpchar AS isstocked,
    NULL::bpchar AS m_product_issummary,
    NULL::bpchar AS isverified,
    NULL::bpchar AS iswebstorefeatured,
    NULL::numeric AS lowlevel,
    NULL::numeric AS m_product_m_attributeset_id,
    NULL::numeric AS m_product_m_asi_id,
    NULL::numeric AS m_freightcategory_id,
    NULL::numeric AS m_locator_id,
    NULL::numeric AS m_product_m_prod_category_id,
    NULL::bpchar AS m_product_processing,
    NULL::bpchar AS producttype,
    NULL::numeric AS r_mailtext_id,
    NULL::numeric AS m_product_salesrep_id,
    NULL::numeric AS s_expensetype_id,
    NULL::numeric AS shelfdepth,
    NULL::numeric AS shelfheight,
    NULL::numeric AS shelfwidth,
    NULL::numeric AS m_product_s_resource_id,
    NULL::numeric AS unitsperpack,
    NULL::numeric AS unitsperpallet,
    NULL::timestamp without time zone AS m_product_updated,
    NULL::numeric AS m_product_updatedby,
    NULL::character varying AS versionno,
    NULL::numeric AS volume,
    NULL::numeric AS weight,
    NULL::numeric AS c_charge_ad_org_id,
    NULL::numeric AS c_charge_c_bpartner_id,
    NULL::numeric AS c_chargetype_id,
    NULL::numeric AS c_charge_chargeamt,
    NULL::numeric AS c_charge_c_taxcategory_id,
    NULL::character varying AS c_charge_description,
    NULL::bpchar AS c_charge_isactive,
    NULL::bpchar AS issamecurrency,
    NULL::bpchar AS issametax,
    NULL::bpchar AS c_charge_istaxincluded,
    NULL::numeric AS c_bp_product_ad_org_id,
    NULL::numeric AS c_bp_product_c_bpartner_id,
    NULL::timestamp without time zone AS c_bp_product_created,
    NULL::numeric AS c_bp_product_createdby,
    NULL::character varying AS c_bp_product_description,
    NULL::bpchar AS c_bp_product_isactive,
    NULL::bpchar AS ismanufacturer,
    NULL::character varying AS manufacturer,
    NULL::numeric AS qualityrating,
    NULL::numeric AS shelflifemindays,
    NULL::numeric AS shelflifeminpct,
    NULL::timestamp without time zone AS c_bp_product_updated,
    NULL::numeric AS c_bp_product_updatedby,
    NULL::character varying AS vendorcategory,
    NULL::numeric AS s_rassignment_ad_org_id,
    NULL::timestamp without time zone AS assigndatefrom,
    NULL::timestamp without time zone AS assigndateto,
    NULL::timestamp without time zone AS s_rassignment_created,
    NULL::numeric AS s_rassignment_createby,
    NULL::bpchar AS s_rassignment_isactive,
    NULL::bpchar AS isconfirmed,
    NULL::character varying AS s_rassignment_name,
    NULL::numeric AS s_rassignment_qty,
    NULL::numeric AS s_rassignment_s_resource_id,
    NULL::timestamp without time zone AS s_rassignment_updated,
    NULL::numeric AS s_rassignment_updatedby,
    NULL::numeric AS m_asi_ad_org_id,
    NULL::timestamp without time zone AS m_asi_created,
    NULL::numeric AS m_asi_createdby,
    NULL::character varying AS m_asi_description,
    NULL::bpchar AS m_asi_isactive,
    NULL::timestamp without time zone AS m_asi_updated,
    NULL::numeric AS m_asi_updatedby
   FROM c_invoice i
UNION
 SELECT it.ad_client_id,
    it.ad_org_id,
    it.isactive,
    it.created,
    it.createdby,
    it.updated,
    it.updatedby,
    'en_US'::character varying(6) AS ad_language,
    it.c_invoice_id,
    NULL::numeric AS c_invoiceline_id,
    it.c_tax_id,
    NULL::numeric AS taxamt,
    NULL::numeric AS linetotalamt,
    t.taxindicator,
    999999 AS line,
    NULL::numeric AS m_product_id,
    NULL::numeric AS qtyinvoiced,
    NULL::numeric AS qtyentered,
    NULL::character varying AS uomsymbol,
    NULL::integer AS qtyprecision,
    t.name,
    NULL::character varying AS description,
    NULL::character varying AS documentnote,
    NULL::character varying AS upc,
    NULL::character varying AS sku,
    NULL::character varying AS productvalue,
    NULL::character varying AS resourcedescription,
    NULL::numeric AS pricelist,
    NULL::numeric AS priceenteredlist,
    NULL::numeric AS discount,
        CASE
            WHEN (it.istaxincluded = 'Y'::bpchar) THEN it.taxamt
            ELSE it.taxbaseamt
        END AS priceactual,
        CASE
            WHEN (it.istaxincluded = 'Y'::bpchar) THEN it.taxamt
            ELSE it.taxbaseamt
        END AS priceentered,
        CASE
            WHEN (it.istaxincluded = 'Y'::bpchar) THEN NULL::numeric
            ELSE it.taxamt
        END AS linenetamt,
    NULL::numeric AS m_attributesetinstance_id,
    NULL::numeric AS m_attributeset_id,
    NULL::character varying AS serno,
    NULL::character varying AS lot,
    NULL::numeric AS m_lot_id,
    NULL::timestamp without time zone AS guaranteedate,
    NULL::character varying AS productdescription,
    NULL::character varying AS imageurl,
    NULL::numeric AS c_campaign_id,
    NULL::numeric AS c_project_id,
    NULL::numeric AS c_activity_id,
    NULL::numeric AS c_projectphase_id,
    NULL::numeric AS c_projecttask_id,
    NULL::numeric AS c_invoiceline_ad_orgtrx_id,
    NULL::bpchar AS a_processed,
    NULL::numeric AS c_charge_id,
    NULL::numeric AS c_orderline_id,
    NULL::numeric AS c_uom_id,
    NULL::bpchar AS isdescription,
    NULL::bpchar AS c_invoiceline_isprinted,
    NULL::numeric AS m_inoutline_id,
    NULL::numeric AS m_rmaline_id,
    NULL::numeric AS pricelimit,
    NULL::bpchar AS c_invoiceline_processed,
    NULL::numeric AS ref_invoiceline_id,
    NULL::numeric AS rramt,
    NULL::timestamp without time zone AS rrstartdate,
    NULL::numeric AS s_resourceassignment_id,
    NULL::numeric AS c_invoiceline_user1_id,
    NULL::numeric AS c_invoiceline_user2_id,
    NULL::numeric AS c_uom_ad_org_id,
    NULL::numeric AS costingprecision,
    NULL::character varying AS c_uom_description,
    NULL::bpchar AS c_uom_isactive,
    NULL::bpchar AS c_uom_isdefault,
    NULL::character varying AS c_uom_name,
    NULL::numeric AS stdprecision,
    NULL::character varying AS uomtype,
    NULL::character varying AS x12de355,
    NULL::numeric AS c_invoice_ad_org_id,
    NULL::numeric AS c_invoice_ad_orgtrx_id,
    NULL::numeric AS c_invoice_ad_user_id,
    NULL::numeric AS c_invoice_c_activity_id,
    NULL::numeric AS c_invoice_c_bpartner_id,
    NULL::numeric AS c_bpartner_location_id,
    NULL::numeric AS c_invoice_c_campaign_id,
    NULL::numeric AS c_invoice_c_charge_id,
    NULL::numeric AS c_conversiontype_id,
    NULL::numeric AS c_currency_id,
    NULL::character varying AS cursymbol,
    NULL::numeric AS c_doctype_id,
    NULL::numeric AS c_doctypetarget_id,
    NULL::numeric AS c_dunninglevel_id,
    NULL::numeric AS c_invoice_chargeamt,
    NULL::numeric AS c_order_id,
    NULL::numeric AS c_payment_id,
    NULL::numeric AS c_paymentterm_id,
    NULL::numeric AS c_invoice_c_project_id,
    NULL::timestamp without time zone AS c_invoice_created,
    NULL::numeric AS c_invoice_createdby,
    NULL::timestamp without time zone AS dateacct,
    NULL::timestamp without time zone AS dateinvoiced,
    NULL::timestamp without time zone AS dateordered,
    NULL::timestamp without time zone AS dateprinted,
    NULL::character varying AS c_invoice_description,
    NULL::bpchar AS docaction,
    NULL::bpchar AS docstatus,
    NULL::character varying AS documentno,
    NULL::date AS dunninggrace,
    NULL::bpchar AS generateto,
    NULL::numeric AS grandtotal,
    NULL::bpchar AS invoicecollectiontype,
    NULL::bpchar AS c_invoice_isactive,
    NULL::bpchar AS isapproved,
    NULL::bpchar AS isdiscountprinted,
    NULL::bpchar AS isindispute,
    NULL::bpchar AS ispaid,
    NULL::bpchar AS ispayschedulevalid,
    NULL::bpchar AS c_invoice_isprinted,
    NULL::bpchar AS c_invoice_isselfservice,
    NULL::bpchar AS issotrx,
    NULL::bpchar AS c_invoice_istaxincluded,
    NULL::bpchar AS istransferred,
    NULL::numeric AS m_pricelist_id,
    NULL::numeric AS m_rma_id,
    NULL::bpchar AS paymentrule,
    NULL::character varying AS poreference,
    NULL::bpchar AS posted,
    NULL::numeric AS processedon,
    NULL::bpchar AS processing,
    NULL::numeric AS ref_invoice_id,
    NULL::numeric AS reversal_id,
    NULL::numeric AS salesrep_id,
    NULL::bpchar AS sendemail,
    NULL::numeric AS totallines,
    NULL::timestamp without time zone AS c_invoice_updated,
    NULL::numeric AS c_invoice_updatedby,
    NULL::numeric AS c_invoice_user1_id,
    NULL::numeric AS c_invoice_user2_id,
    NULL::numeric AS c_tax_ad_org_id,
    NULL::numeric AS ad_rule_id,
    NULL::numeric AS c_country_id,
    NULL::numeric AS c_region_id,
    NULL::numeric AS c_tax_c_taxcategory_id,
    NULL::character varying AS c_tax_description,
    NULL::bpchar AS c_tax_isactive,
    NULL::bpchar AS c_tax_isdefault,
    NULL::bpchar AS isdocumentlevel,
    NULL::bpchar AS issalestax,
    NULL::bpchar AS c_tax_issummary,
    NULL::bpchar AS istaxexempt,
    NULL::character varying AS c_tax_name,
    NULL::numeric AS parent_tax_id,
    NULL::numeric AS rate,
    NULL::bpchar AS requirestaxcertificate,
    NULL::bpchar AS sopotype,
    NULL::numeric AS to_country_id,
    NULL::numeric AS to_region_id,
    NULL::timestamp without time zone AS validfrom,
    NULL::numeric AS m_product_ad_org_id,
    NULL::character varying AS classification,
    NULL::bpchar AS m_product_copyfrom,
    NULL::timestamp without time zone AS m_product_created,
    NULL::numeric AS m_product_createdby,
    NULL::numeric AS c_revenuerecognition_id,
    NULL::numeric AS c_subscriptiontype_id,
    NULL::numeric AS m_product_c_taxcategory_id,
    NULL::character varying AS descriptionurl,
    NULL::bpchar AS discontinued,
    NULL::timestamp without time zone AS discontinuedat,
    NULL::character varying AS group1,
    NULL::character varying AS group2,
    NULL::numeric AS guaranteedays,
    NULL::numeric AS guaranteedaysmin,
    NULL::character varying AS help,
    NULL::bpchar AS m_product_isactive,
    NULL::bpchar AS isbom,
    NULL::bpchar AS isdropship,
    NULL::bpchar AS isexcludeautodelivery,
    NULL::bpchar AS isinvoiceprintdetails,
    NULL::bpchar AS ispicklistprintdetails,
    NULL::bpchar AS ispurchased,
    NULL::bpchar AS m_product_isselfservice,
    NULL::bpchar AS issold,
    NULL::bpchar AS isstocked,
    NULL::bpchar AS m_product_issummary,
    NULL::bpchar AS isverified,
    NULL::bpchar AS iswebstorefeatured,
    NULL::numeric AS lowlevel,
    NULL::numeric AS m_product_m_attributeset_id,
    NULL::numeric AS m_product_m_asi_id,
    NULL::numeric AS m_freightcategory_id,
    NULL::numeric AS m_locator_id,
    NULL::numeric AS m_product_m_prod_category_id,
    NULL::bpchar AS m_product_processing,
    NULL::bpchar AS producttype,
    NULL::numeric AS r_mailtext_id,
    NULL::numeric AS m_product_salesrep_id,
    NULL::numeric AS s_expensetype_id,
    NULL::numeric AS shelfdepth,
    NULL::numeric AS shelfheight,
    NULL::numeric AS shelfwidth,
    NULL::numeric AS m_product_s_resource_id,
    NULL::numeric AS unitsperpack,
    NULL::numeric AS unitsperpallet,
    NULL::timestamp without time zone AS m_product_updated,
    NULL::numeric AS m_product_updatedby,
    NULL::character varying AS versionno,
    NULL::numeric AS volume,
    NULL::numeric AS weight,
    NULL::numeric AS c_charge_ad_org_id,
    NULL::numeric AS c_charge_c_bpartner_id,
    NULL::numeric AS c_chargetype_id,
    NULL::numeric AS c_charge_chargeamt,
    NULL::numeric AS c_charge_c_taxcategory_id,
    NULL::character varying AS c_charge_description,
    NULL::bpchar AS c_charge_isactive,
    NULL::bpchar AS issamecurrency,
    NULL::bpchar AS issametax,
    NULL::bpchar AS c_charge_istaxincluded,
    NULL::numeric AS c_bp_product_ad_org_id,
    NULL::numeric AS c_bp_product_c_bpartner_id,
    NULL::timestamp without time zone AS c_bp_product_created,
    NULL::numeric AS c_bp_product_createdby,
    NULL::character varying AS c_bp_product_description,
    NULL::bpchar AS c_bp_product_isactive,
    NULL::bpchar AS ismanufacturer,
    NULL::character varying AS manufacturer,
    NULL::numeric AS qualityrating,
    NULL::numeric AS shelflifemindays,
    NULL::numeric AS shelflifeminpct,
    NULL::timestamp without time zone AS c_bp_product_updated,
    NULL::numeric AS c_bp_product_updatedby,
    NULL::character varying AS vendorcategory,
    NULL::numeric AS s_rassignment_ad_org_id,
    NULL::timestamp without time zone AS assigndatefrom,
    NULL::timestamp without time zone AS assigndateto,
    NULL::timestamp without time zone AS s_rassignment_created,
    NULL::numeric AS s_rassignment_createby,
    NULL::bpchar AS s_rassignment_isactive,
    NULL::bpchar AS isconfirmed,
    NULL::character varying AS s_rassignment_name,
    NULL::numeric AS s_rassignment_qty,
    NULL::numeric AS s_rassignment_s_resource_id,
    NULL::timestamp without time zone AS s_rassignment_updated,
    NULL::numeric AS s_rassignment_updatedby,
    NULL::numeric AS m_asi_ad_org_id,
    NULL::timestamp without time zone AS m_asi_created,
    NULL::numeric AS m_asi_createdby,
    NULL::character varying AS m_asi_description,
    NULL::bpchar AS m_asi_isactive,
    NULL::timestamp without time zone AS m_asi_updated,
    NULL::numeric AS m_asi_updatedby
   FROM (c_invoicetax it
     JOIN c_tax t ON ((it.c_tax_id = t.c_tax_id)));
--
-- create view  wmv_inout_candidate_v
--
CREATE OR REPLACE VIEW wmv_inout_candidate_v AS
 SELECT o.ad_client_id,
    o.ad_org_id,
    o.c_bpartner_id,
    o.c_order_id,
    o.documentno,
    o.dateordered,
    o.c_doctype_id,
    o.poreference,
    o.description,
    o.salesrep_id,
    l.m_warehouse_id,
    sum(((l.qtyordered - l.qtydelivered) * l.priceactual)) AS totallines,
    o.wmv_ghgcertificate_id,
    o.wmv_product_id
   FROM (c_order o
     JOIN c_orderline l ON ((o.c_order_id = l.c_order_id)))
  WHERE ((o.docstatus = 'CO'::bpchar) AND (o.isdelivered = 'N'::bpchar) AND (o.c_doctype_id IN ( SELECT c_doctype.c_doctype_id
           FROM c_doctype
          WHERE ((c_doctype.docbasetype = 'SOO'::bpchar) AND (c_doctype.docsubtypeso <> ALL (ARRAY['ON'::bpchar, 'OB'::bpchar, 'WR'::bpchar]))))) AND (o.deliveryrule <> 'M'::bpchar) AND ((l.m_product_id IS NULL) OR (EXISTS ( SELECT p.m_product_id,
            p.ad_client_id,
            p.ad_org_id,
            p.isactive,
            p.created,
            p.createdby,
            p.updated,
            p.updatedby,
            p.value,
            p.name,
            p.description,
            p.documentnote,
            p.help,
            p.upc,
            p.sku,
            p.c_uom_id,
            p.salesrep_id,
            p.issummary,
            p.isstocked,
            p.ispurchased,
            p.issold,
            p.isbom,
            p.isinvoiceprintdetails,
            p.ispicklistprintdetails,
            p.isverified,
            p.c_revenuerecognition_id,
            p.m_product_category_id,
            p.classification,
            p.volume,
            p.weight,
            p.shelfwidth,
            p.shelfheight,
            p.shelfdepth,
            p.unitsperpallet,
            p.c_taxcategory_id,
            p.s_resource_id,
            p.discontinued,
            p.discontinuedby,
            p.processing,
            p.s_expensetype_id,
            p.producttype,
            p.imageurl,
            p.descriptionurl,
            p.guaranteedays,
            p.r_mailtext_id,
            p.versionno,
            p.m_attributeset_id,
            p.m_attributesetinstance_id,
            p.downloadurl,
            p.m_freightcategory_id,
            p.m_locator_id,
            p.guaranteedaysmin,
            p.iswebstorefeatured,
            p.isselfservice,
            p.c_subscriptiontype_id,
            p.isdropship,
            p.isexcludeautodelivery,
            p.group1,
            p.group2,
            p.istoformule,
            p.lowlevel,
            p.unitsperpack,
            p.discontinuedat,
            p.copyfrom,
            p.m_product_uu,
            p.m_parttype_id,
            p.iskanban,
            p.ismanufactured,
            p.isphantom,
            p.isownbox
           FROM m_product p
          WHERE ((l.m_product_id = p.m_product_id) AND (p.isexcludeautodelivery = 'N'::bpchar))))) AND (l.qtyordered <> l.qtydelivered) AND (o.isdropship = 'N'::bpchar) AND ((l.m_product_id IS NOT NULL) OR (l.c_charge_id IS NOT NULL)) AND (NOT (EXISTS ( SELECT iol.m_inoutline_id,
            iol.ad_client_id,
            iol.ad_org_id,
            iol.isactive,
            iol.created,
            iol.createdby,
            iol.updated,
            iol.updatedby,
            iol.line,
            iol.description,
            iol.m_inout_id,
            iol.c_orderline_id,
            iol.m_locator_id,
            iol.m_product_id,
            iol.c_uom_id,
            iol.movementqty,
            iol.isinvoiced,
            iol.m_attributesetinstance_id,
            iol.isdescription,
            iol.confirmedqty,
            iol.pickedqty,
            iol.scrappedqty,
            iol.targetqty,
            iol.ref_inoutline_id,
            iol.processed,
            iol.qtyentered,
            iol.c_charge_id,
            iol.c_project_id,
            iol.c_projectphase_id,
            iol.c_projecttask_id,
            iol.c_campaign_id,
            iol.c_activity_id,
            iol.user1_id,
            iol.user2_id,
            iol.ad_orgtrx_id,
            iol.m_rmaline_id,
            iol.reversalline_id,
            iol.m_inoutline_uu,
            iol.qtyoverreceipt,
            io.m_inout_id,
            io.ad_client_id,
            io.ad_org_id,
            io.isactive,
            io.created,
            io.createdby,
            io.updated,
            io.updatedby,
            io.issotrx,
            io.documentno,
            io.docaction,
            io.docstatus,
            io.posted,
            io.processing,
            io.processed,
            io.c_doctype_id,
            io.description,
            io.c_order_id,
            io.dateordered,
            io.isprinted,
            io.movementtype,
            io.movementdate,
            io.dateacct,
            io.c_bpartner_id,
            io.c_bpartner_location_id,
            io.m_warehouse_id,
            io.poreference,
            io.deliveryrule,
            io.freightcostrule,
            io.freightamt,
            io.deliveryviarule,
            io.m_shipper_id,
            io.c_charge_id,
            io.chargeamt,
            io.priorityrule,
            io.dateprinted,
            io.c_invoice_id,
            io.createfrom,
            io.generateto,
            io.sendemail,
            io.ad_user_id,
            io.salesrep_id,
            io.nopackages,
            io.pickdate,
            io.shipdate,
            io.trackingno,
            io.ad_orgtrx_id,
            io.c_project_id,
            io.c_campaign_id,
            io.c_activity_id,
            io.user1_id,
            io.user2_id,
            io.datereceived,
            io.isintransit,
            io.ref_inout_id,
            io.createconfirm,
            io.createpackage,
            io.isapproved,
            io.isindispute,
            io.volume,
            io.weight,
            io.m_rma_id,
            io.reversal_id,
            io.isdropship,
            io.dropship_bpartner_id,
            io.dropship_location_id,
            io.dropship_user_id,
            io.processedon,
            io.m_inout_uu,
            io.freightcharges,
            io.shipperaccount,
            io.insurance,
            io.fob,
            io.isalternatereturnaddress,
            io.returnbpartner_id,
            io.returnlocation_id,
            io.returnuser_id
           FROM (m_inoutline iol
             JOIN m_inout io ON ((iol.m_inout_id = io.m_inout_id)))
          WHERE ((iol.c_orderline_id = l.c_orderline_id) AND (io.docstatus = ANY (ARRAY['DR'::bpchar, 'IN'::bpchar, 'IP'::bpchar, 'WC'::bpchar])))))))
  GROUP BY o.ad_client_id, o.ad_org_id, o.c_bpartner_id, o.c_order_id, o.documentno, o.dateordered, o.c_doctype_id, o.poreference, o.description, o.salesrep_id, l.m_warehouse_id;
--
-- create view  wmv_invoice_linetax_vt
--
CREATE OR REPLACE VIEW wmv_invoice_linetax_vt AS
 SELECT il.ad_client_id,
    il.ad_org_id,
    il.isactive,
    il.created,
    il.createdby,
    il.updated,
    il.updatedby,
    uomt.ad_language,
    il.c_invoice_id,
    il.c_invoiceline_id,
    il.c_tax_id,
    il.taxamt,
    il.linetotalamt,
    tt.taxindicator,
    il.line,
    pt.m_product_id,
        CASE
            WHEN ((il.qtyinvoiced <> (0)::numeric) OR (il.m_product_id IS NOT NULL)) THEN il.qtyinvoiced
            ELSE NULL::numeric
        END AS qtyinvoiced,
        CASE
            WHEN ((il.qtyentered <> (0)::numeric) OR (il.m_product_id IS NOT NULL)) THEN il.qtyentered
            ELSE NULL::numeric
        END AS qtyentered,
        CASE
            WHEN ((il.qtyentered <> (0)::numeric) OR (il.m_product_id IS NOT NULL)) THEN uomt.uomsymbol
            ELSE NULL::character varying
        END AS uomsymbol,
    COALESCE(p.wmv_display_precision, uom.stdprecision, (2)::numeric) AS qtyprecision,
    COALESCE(ct.name, (((pt.name)::text || (COALESCE(productattribute(il.m_attributesetinstance_id), ''::character varying))::text))::character varying, il.description) AS name,
        CASE
            WHEN (COALESCE(ct.name, pt.name) IS NOT NULL) THEN il.description
            ELSE NULL::character varying
        END AS description,
    pt.documentnote,
    p.upc,
    p.sku,
    COALESCE(pp.vendorproductno, p.value) AS productvalue,
    ra.description AS resourcedescription,
        CASE
            WHEN ((i.isdiscountprinted = 'Y'::bpchar) AND (il.pricelist <> (0)::numeric)) THEN il.pricelist
            ELSE NULL::numeric
        END AS pricelist,
        CASE
            WHEN ((i.isdiscountprinted = 'Y'::bpchar) AND (il.pricelist <> (0)::numeric) AND (il.qtyentered <> (0)::numeric)) THEN ((il.pricelist * il.qtyinvoiced) / il.qtyentered)
            ELSE NULL::numeric
        END AS priceenteredlist,
        CASE
            WHEN ((i.isdiscountprinted = 'Y'::bpchar) AND (il.pricelist > il.priceactual) AND (il.pricelist <> (0)::numeric)) THEN (((il.pricelist - il.priceactual) / il.pricelist) * (100)::numeric)
            ELSE NULL::numeric
        END AS discount,
        CASE
            WHEN ((il.priceactual <> (0)::numeric) OR (il.m_product_id IS NOT NULL)) THEN il.priceactual
            ELSE NULL::numeric
        END AS priceactual,
        CASE
            WHEN ((il.priceentered <> (0)::numeric) OR (il.m_product_id IS NOT NULL)) THEN il.priceentered
            ELSE NULL::numeric
        END AS priceentered,
        CASE
            WHEN ((il.linenetamt <> (0)::numeric) OR (il.m_product_id IS NOT NULL)) THEN il.linenetamt
            ELSE NULL::numeric
        END AS linenetamt,
    il.m_attributesetinstance_id,
    asi.m_attributeset_id,
    asi.serno,
    asi.lot,
    asi.m_lot_id,
    asi.guaranteedate,
    pt.description AS productdescription,
    p.imageurl,
    il.c_campaign_id,
    il.c_project_id,
    il.c_activity_id,
    il.c_projectphase_id,
    il.c_projecttask_id,
    il.ad_orgtrx_id AS c_invoiceline_ad_orgtrx_id,
    il.a_processed,
    il.c_charge_id,
    il.c_orderline_id,
    il.c_uom_id,
    il.isdescription,
    il.isprinted AS c_invoiceline_isprinted,
    il.m_inoutline_id,
    il.m_rmaline_id,
    il.pricelimit,
    il.processed AS c_invoiceline_processed,
    il.ref_invoiceline_id,
    il.rramt,
    il.rrstartdate,
    il.s_resourceassignment_id,
    il.user1_id AS c_invoiceline_user1_id,
    il.user2_id AS c_invoiceline_user2_id,
    uomt.ad_org_id AS c_uom_ad_org_id,
    uom.costingprecision,
    uomt.description AS c_uom_description,
    uomt.isactive AS c_uom_isactive,
    uom.isdefault AS c_uom_isdefault,
    uomt.name AS c_uom_name,
    uom.stdprecision,
    uom.uomtype,
    uom.x12de355,
    i.ad_org_id AS c_invoice_ad_org_id,
    i.ad_orgtrx_id AS c_invoice_ad_orgtrx_id,
    i.ad_user_id AS c_invoice_ad_user_id,
    i.c_activity_id AS c_invoice_c_activity_id,
    i.c_bpartner_id AS c_invoice_c_bpartner_id,
    i.c_bpartner_location_id,
    i.c_campaign_id AS c_invoice_c_campaign_id,
    i.c_charge_id AS c_invoice_c_charge_id,
    i.c_conversiontype_id,
    i.c_currency_id,
    COALESCE(cur.cursymbol, (cur.iso_code)::character varying) AS cursymbol,
    i.c_doctype_id,
    i.c_doctypetarget_id,
    i.c_dunninglevel_id,
    i.chargeamt AS c_invoice_chargeamt,
    i.c_order_id,
    i.c_payment_id,
    i.c_paymentterm_id,
    i.c_project_id AS c_invoice_c_project_id,
    i.created AS c_invoice_created,
    i.createdby AS c_invoice_createdby,
    i.dateacct,
    i.dateinvoiced,
    i.dateordered,
    i.dateprinted,
    i.description AS c_invoice_description,
    i.docaction,
    i.docstatus,
    i.documentno,
    i.dunninggrace,
    i.generateto,
    i.grandtotal,
    i.invoicecollectiontype,
    i.isactive AS c_invoice_isactive,
    i.isapproved,
    i.isdiscountprinted,
    i.isindispute,
    i.ispaid,
    i.ispayschedulevalid,
    i.isprinted AS c_invoice_isprinted,
    i.isselfservice AS c_invoice_isselfservice,
    i.issotrx,
    i.istaxincluded AS c_invoice_istaxincluded,
    i.istransferred,
    i.m_pricelist_id,
    i.m_rma_id,
    i.paymentrule,
    i.poreference,
    i.posted,
    i.processedon,
    i.processing,
    i.ref_invoice_id,
    i.reversal_id,
    i.salesrep_id,
    i.sendemail,
    i.totallines,
    i.updated AS c_invoice_updated,
    i.updatedby AS c_invoice_updatedby,
    i.user1_id AS c_invoice_user1_id,
    i.user2_id AS c_invoice_user2_id,
    tt.ad_org_id AS c_tax_ad_org_id,
    t.ad_rule_id,
    t.c_country_id,
    t.c_region_id,
    t.c_taxcategory_id AS c_tax_c_taxcategory_id,
    tt.description AS c_tax_description,
    tt.isactive AS c_tax_isactive,
    t.isdefault AS c_tax_isdefault,
    t.isdocumentlevel,
    t.issalestax,
    t.issummary AS c_tax_issummary,
    t.istaxexempt,
    tt.name AS c_tax_name,
    t.parent_tax_id,
    t.rate,
    t.requirestaxcertificate,
    t.sopotype,
    t.to_country_id,
    t.to_region_id,
    t.validfrom,
    pt.ad_org_id AS m_product_ad_org_id,
    p.classification,
    p.copyfrom AS m_product_copyfrom,
    pt.created AS m_product_created,
    pt.createdby AS m_product_createdby,
    p.c_revenuerecognition_id,
    p.c_subscriptiontype_id,
    p.c_taxcategory_id AS m_product_c_taxcategory_id,
    p.descriptionurl,
    p.discontinued,
    p.discontinuedat,
    p.group1,
    p.group2,
    p.guaranteedays,
    p.guaranteedaysmin,
    p.help,
    pt.isactive AS m_product_isactive,
    p.isbom,
    p.isdropship,
    p.isexcludeautodelivery,
    p.isinvoiceprintdetails,
    p.ispicklistprintdetails,
    p.ispurchased,
    p.isselfservice AS m_product_isselfservice,
    p.issold,
    p.isstocked,
    p.issummary AS m_product_issummary,
    p.isverified,
    p.iswebstorefeatured,
    p.lowlevel,
    p.m_attributeset_id AS m_product_m_attributeset_id,
    p.m_attributesetinstance_id AS m_product_m_asi_id,
    p.m_freightcategory_id,
    p.m_locator_id,
    p.m_product_category_id AS m_product_m_prod_category_id,
    p.processing AS m_product_processing,
    p.producttype,
    p.r_mailtext_id,
    p.salesrep_id AS m_product_salesrep_id,
    p.s_expensetype_id,
    p.shelfdepth,
    p.shelfheight,
    p.shelfwidth,
    p.s_resource_id AS m_product_s_resource_id,
    p.unitsperpack,
    p.unitsperpallet,
    pt.updated AS m_product_updated,
    pt.updatedby AS m_product_updatedby,
    p.versionno,
    p.volume,
    p.weight,
    ct.ad_org_id AS c_charge_ad_org_id,
    c.c_bpartner_id AS c_charge_c_bpartner_id,
    c.c_chargetype_id,
    c.chargeamt AS c_charge_chargeamt,
    c.c_taxcategory_id AS c_charge_c_taxcategory_id,
    ct.description AS c_charge_description,
    ct.isactive AS c_charge_isactive,
    c.issamecurrency,
    c.issametax,
    c.istaxincluded AS c_charge_istaxincluded,
    pp.ad_org_id AS c_bp_product_ad_org_id,
    pp.c_bpartner_id AS c_bp_product_c_bpartner_id,
    pp.created AS c_bp_product_created,
    pp.createdby AS c_bp_product_createdby,
    pp.description AS c_bp_product_description,
    pp.isactive AS c_bp_product_isactive,
    pp.ismanufacturer,
    pp.manufacturer,
    pp.qualityrating,
    pp.shelflifemindays,
    pp.shelflifeminpct,
    pp.updated AS c_bp_product_updated,
    pp.updatedby AS c_bp_product_updatedby,
    pp.vendorcategory,
    ra.ad_org_id AS s_rassignment_ad_org_id,
    ra.assigndatefrom,
    ra.assigndateto,
    ra.created AS s_rassignment_created,
    ra.createdby AS s_rassignment_createby,
    ra.isactive AS s_rassignment_isactive,
    ra.isconfirmed,
    ra.name AS s_rassignment_name,
    ra.qty AS s_rassignment_qty,
    ra.s_resource_id AS s_rassignment_s_resource_id,
    ra.updated AS s_rassignment_updated,
    ra.updatedby AS s_rassignment_updatedby,
    asi.ad_org_id AS m_asi_ad_org_id,
    asi.created AS m_asi_created,
    asi.createdby AS m_asi_createdby,
    asi.description AS m_asi_description,
    asi.isactive AS m_asi_isactive,
    asi.updated AS m_asi_updated,
    asi.updatedby AS m_asi_updatedby
   FROM (((((((((((((c_invoiceline il
     JOIN c_uom uom ON ((il.c_uom_id = uom.c_uom_id)))
     JOIN c_uom_trl uomt ON ((il.c_uom_id = uomt.c_uom_id)))
     JOIN c_invoice i ON ((il.c_invoice_id = i.c_invoice_id)))
     LEFT JOIN c_tax t ON ((il.c_tax_id = t.c_tax_id)))
     LEFT JOIN c_tax_trl tt ON (((il.c_tax_id = tt.c_tax_id) AND ((uomt.ad_language)::text = (tt.ad_language)::text))))
     LEFT JOIN m_product p ON ((il.m_product_id = p.m_product_id)))
     LEFT JOIN c_charge c ON ((il.c_charge_id = c.c_charge_id)))
     LEFT JOIN c_charge_trl ct ON (((il.c_charge_id = ct.c_charge_id) AND ((uomt.ad_language)::text = (ct.ad_language)::text))))
     LEFT JOIN c_bpartner_product pp ON (((il.m_product_id = pp.m_product_id) AND (i.c_bpartner_id = pp.c_bpartner_id))))
     LEFT JOIN m_product_trl pt ON (((il.m_product_id = pt.m_product_id) AND ((uomt.ad_language)::text = (pt.ad_language)::text))))
     LEFT JOIN s_resourceassignment ra ON ((il.s_resourceassignment_id = ra.s_resourceassignment_id)))
     LEFT JOIN m_attributesetinstance asi ON ((il.m_attributesetinstance_id = asi.m_attributesetinstance_id)))
     LEFT JOIN c_currency cur ON ((i.c_currency_id = cur.c_currency_id)))
UNION
 SELECT il.ad_client_id,
    il.ad_org_id,
    il.isactive,
    il.created,
    il.createdby,
    il.updated,
    il.updatedby,
    uomt.ad_language,
    il.c_invoice_id,
    il.c_invoiceline_id,
    il.c_tax_id,
    il.taxamt,
    il.linetotalamt,
    tt.taxindicator,
    (il.line + (bl.line / (100)::numeric)) AS line,
    pt.m_product_id,
        CASE
            WHEN (bl.isqtypercentage = 'N'::bpchar) THEN (il.qtyinvoiced * bl.qtybom)
            ELSE (il.qtyinvoiced * (bl.qtybatch / (100)::numeric))
        END AS qtyinvoiced,
        CASE
            WHEN (bl.isqtypercentage = 'N'::bpchar) THEN (il.qtyentered * bl.qtybom)
            ELSE (il.qtyentered * (bl.qtybatch / (100)::numeric))
        END AS qtyentered,
    uomt.uomsymbol,
    COALESCE(p.wmv_display_precision, uom.stdprecision, (2)::numeric) AS qtyprecision,
    COALESCE(pt.name, p.name) AS name,
    b.description,
    COALESCE(pt.documentnote, p.documentnote) AS documentnote,
    p.upc,
    p.sku,
    p.value AS productvalue,
    NULL::character varying AS resourcedescription,
    NULL::numeric AS pricelist,
    NULL::numeric AS priceenteredlist,
    NULL::numeric AS discount,
    NULL::numeric AS priceactual,
    NULL::numeric AS priceentered,
    NULL::numeric AS linenetamt,
    il.m_attributesetinstance_id,
    asi.m_attributeset_id,
    asi.serno,
    asi.lot,
    asi.m_lot_id,
    asi.guaranteedate,
    pt.description AS productdescription,
    p.imageurl,
    il.c_campaign_id,
    il.c_project_id,
    il.c_activity_id,
    il.c_projectphase_id,
    il.c_projecttask_id,
    il.ad_orgtrx_id AS c_invoiceline_ad_orgtrx_id,
    il.a_processed,
    il.c_charge_id,
    il.c_orderline_id,
    il.c_uom_id,
    il.isdescription,
    il.isprinted AS c_invoiceline_isprinted,
    il.m_inoutline_id,
    il.m_rmaline_id,
    il.pricelimit,
    il.processed AS c_invoiceline_processed,
    il.ref_invoiceline_id,
    il.rramt,
    il.rrstartdate,
    il.s_resourceassignment_id,
    il.user1_id AS c_invoiceline_user1_id,
    il.user2_id AS c_invoiceline_user2_id,
    uomt.ad_org_id AS c_uom_ad_org_id,
    uom.costingprecision,
    uomt.description AS c_uom_description,
    uomt.isactive AS c_uom_isactive,
    uom.isdefault AS c_uom_isdefault,
    uomt.name AS c_uom_name,
    uom.stdprecision,
    uom.uomtype,
    uom.x12de355,
    NULL::numeric AS c_invoice_ad_org_id,
    NULL::numeric AS c_invoice_ad_orgtrx_id,
    NULL::numeric AS c_invoice_ad_user_id,
    NULL::numeric AS c_invoice_c_activity_id,
    NULL::numeric AS c_invoice_c_bpartner_id,
    NULL::numeric AS c_bpartner_location_id,
    NULL::numeric AS c_invoice_c_campaign_id,
    NULL::numeric AS c_invoice_c_charge_id,
    NULL::numeric AS c_conversiontype_id,
    NULL::numeric AS c_currency_id,
    NULL::character varying AS cursymbol,
    NULL::numeric AS c_doctype_id,
    NULL::numeric AS c_doctypetarget_id,
    NULL::numeric AS c_dunninglevel_id,
    NULL::numeric AS c_invoice_chargeamt,
    NULL::numeric AS c_order_id,
    NULL::numeric AS c_payment_id,
    NULL::numeric AS c_paymentterm_id,
    NULL::numeric AS c_invoice_c_project_id,
    NULL::timestamp without time zone AS c_invoice_created,
    NULL::numeric AS c_invoice_createdby,
    NULL::timestamp without time zone AS dateacct,
    NULL::timestamp without time zone AS dateinvoiced,
    NULL::timestamp without time zone AS dateordered,
    NULL::timestamp without time zone AS dateprinted,
    NULL::character varying AS c_invoice_description,
    NULL::bpchar AS docaction,
    NULL::bpchar AS docstatus,
    NULL::character varying AS documentno,
    NULL::date AS dunninggrace,
    NULL::bpchar AS generateto,
    NULL::numeric AS grandtotal,
    NULL::bpchar AS invoicecollectiontype,
    NULL::bpchar AS c_invoice_isactive,
    NULL::bpchar AS isapproved,
    NULL::bpchar AS isdiscountprinted,
    NULL::bpchar AS isindispute,
    NULL::bpchar AS ispaid,
    NULL::bpchar AS ispayschedulevalid,
    NULL::bpchar AS c_invoice_isprinted,
    NULL::bpchar AS c_invoice_isselfservice,
    NULL::bpchar AS issotrx,
    NULL::bpchar AS c_invoice_istaxincluded,
    NULL::bpchar AS istransferred,
    NULL::numeric AS m_pricelist_id,
    NULL::numeric AS m_rma_id,
    NULL::bpchar AS paymentrule,
    NULL::character varying AS poreference,
    NULL::bpchar AS posted,
    NULL::numeric AS processedon,
    NULL::bpchar AS processing,
    NULL::numeric AS ref_invoice_id,
    NULL::numeric AS reversal_id,
    NULL::numeric AS salesrep_id,
    NULL::bpchar AS sendemail,
    NULL::numeric AS totallines,
    NULL::timestamp without time zone AS c_invoice_updated,
    NULL::numeric AS c_invoice_updatedby,
    NULL::numeric AS c_invoice_user1_id,
    NULL::numeric AS c_invoice_user2_id,
    tt.ad_org_id AS c_tax_ad_org_id,
    t.ad_rule_id,
    t.c_country_id,
    t.c_region_id,
    t.c_taxcategory_id AS c_tax_c_taxcategory_id,
    tt.description AS c_tax_description,
    tt.isactive AS c_tax_isactive,
    t.isdefault AS c_tax_isdefault,
    t.isdocumentlevel,
    t.issalestax,
    t.issummary AS c_tax_issummary,
    t.istaxexempt,
    tt.name AS c_tax_name,
    t.parent_tax_id,
    t.rate,
    t.requirestaxcertificate,
    t.sopotype,
    t.to_country_id,
    t.to_region_id,
    t.validfrom,
    pt.ad_org_id AS m_product_ad_org_id,
    p.classification,
    p.copyfrom AS m_product_copyfrom,
    pt.created AS m_product_created,
    pt.createdby AS m_product_createdby,
    p.c_revenuerecognition_id,
    p.c_subscriptiontype_id,
    p.c_taxcategory_id AS m_product_c_taxcategory_id,
    p.descriptionurl,
    p.discontinued,
    p.discontinuedat,
    p.group1,
    p.group2,
    p.guaranteedays,
    p.guaranteedaysmin,
    p.help,
    pt.isactive AS m_product_isactive,
    p.isbom,
    p.isdropship,
    p.isexcludeautodelivery,
    p.isinvoiceprintdetails,
    p.ispicklistprintdetails,
    p.ispurchased,
    p.isselfservice AS m_product_isselfservice,
    p.issold,
    p.isstocked,
    p.issummary AS m_product_issummary,
    p.isverified,
    p.iswebstorefeatured,
    p.lowlevel,
    p.m_attributeset_id AS m_product_m_attributeset_id,
    p.m_attributesetinstance_id AS m_product_m_asi_id,
    p.m_freightcategory_id,
    p.m_locator_id,
    p.m_product_category_id AS m_product_m_prod_category_id,
    p.processing AS m_product_processing,
    p.producttype,
    p.r_mailtext_id,
    p.salesrep_id AS m_product_salesrep_id,
    p.s_expensetype_id,
    p.shelfdepth,
    p.shelfheight,
    p.shelfwidth,
    p.s_resource_id AS m_product_s_resource_id,
    p.unitsperpack,
    p.unitsperpallet,
    p.updated AS m_product_updated,
    p.updatedby AS m_product_updatedby,
    p.versionno,
    p.volume,
    p.weight,
    NULL::numeric AS c_charge_ad_org_id,
    NULL::numeric AS c_charge_c_bpartner_id,
    NULL::numeric AS c_chargetype_id,
    NULL::numeric AS c_charge_chargeamt,
    NULL::numeric AS c_charge_c_taxcategory_id,
    NULL::character varying AS c_charge_description,
    NULL::bpchar AS c_charge_isactive,
    NULL::bpchar AS issamecurrency,
    NULL::bpchar AS issametax,
    NULL::bpchar AS c_charge_istaxincluded,
    NULL::numeric AS c_bp_product_ad_org_id,
    NULL::numeric AS c_bp_product_c_bpartner_id,
    NULL::timestamp without time zone AS c_bp_product_created,
    NULL::numeric AS c_bp_product_createdby,
    NULL::character varying AS c_bp_product_description,
    NULL::bpchar AS c_bp_product_isactive,
    NULL::bpchar AS ismanufacturer,
    NULL::character varying AS manufacturer,
    NULL::numeric AS qualityrating,
    NULL::numeric AS shelflifemindays,
    NULL::numeric AS shelflifeminpct,
    NULL::timestamp without time zone AS c_bp_product_updated,
    NULL::numeric AS c_bp_product_updatedby,
    NULL::character varying AS vendorcategory,
    NULL::numeric AS s_rassignment_ad_org_id,
    NULL::timestamp without time zone AS assigndatefrom,
    NULL::timestamp without time zone AS assigndateto,
    NULL::timestamp without time zone AS s_rassignment_created,
    NULL::numeric AS s_rassignment_createby,
    NULL::bpchar AS s_rassignment_isactive,
    NULL::bpchar AS isconfirmed,
    NULL::character varying AS s_rassignment_name,
    NULL::numeric AS s_rassignment_qty,
    NULL::numeric AS s_rassignment_s_resource_id,
    NULL::timestamp without time zone AS s_rassignment_updated,
    NULL::numeric AS s_rassignment_updatedby,
    asi.ad_org_id AS m_asi_ad_org_id,
    asi.created AS m_asi_created,
    asi.createdby AS m_asi_createdby,
    asi.description AS m_asi_description,
    asi.isactive AS m_asi_isactive,
    asi.updated AS m_asi_updated,
    asi.updatedby AS m_asi_updatedby
   FROM ((((((((((pp_product_bom b
     JOIN c_invoiceline il ON ((b.m_product_id = il.m_product_id)))
     JOIN m_product bp ON (((bp.m_product_id = il.m_product_id) AND (bp.isbom = 'Y'::bpchar) AND (bp.isverified = 'Y'::bpchar) AND (bp.isinvoiceprintdetails = 'Y'::bpchar))))
     JOIN pp_product_bomline bl ON ((bl.pp_product_bom_id = b.pp_product_bom_id)))
     JOIN m_product p ON ((bl.m_product_id = p.m_product_id)))
     JOIN c_uom uom ON ((p.c_uom_id = uom.c_uom_id)))
     JOIN c_uom_trl uomt ON ((p.c_uom_id = uomt.c_uom_id)))
     JOIN m_product_trl pt ON (((bl.m_product_id = pt.m_product_id) AND ((uomt.ad_language)::text = (pt.ad_language)::text))))
     LEFT JOIN c_tax t ON ((il.c_tax_id = t.c_tax_id)))
     LEFT JOIN c_tax_trl tt ON (((il.c_tax_id = tt.c_tax_id) AND ((uomt.ad_language)::text = (tt.ad_language)::text))))
     LEFT JOIN m_attributesetinstance asi ON ((il.m_attributesetinstance_id = asi.m_attributesetinstance_id)))
UNION
 SELECT il.ad_client_id,
    il.ad_org_id,
    il.isactive,
    il.created,
    il.createdby,
    il.updated,
    il.updatedby,
    l.ad_language,
    il.c_invoice_id,
    il.c_invoiceline_id,
    NULL::numeric AS c_tax_id,
    NULL::numeric AS taxamt,
    NULL::numeric AS linetotalamt,
    NULL::character varying AS taxindicator,
    il.line,
    NULL::numeric AS m_product_id,
    NULL::numeric AS qtyinvoiced,
    NULL::numeric AS qtyentered,
    NULL::character varying AS uomsymbol,
    NULL::integer AS qtyprecision,
    il.description AS name,
    NULL::character varying AS description,
    NULL::character varying AS documentnote,
    NULL::character varying AS upc,
    NULL::character varying AS sku,
    NULL::character varying AS productvalue,
    NULL::character varying AS resourcedescription,
    NULL::numeric AS pricelist,
    NULL::numeric AS priceenteredlist,
    NULL::numeric AS discount,
    NULL::numeric AS priceactual,
    NULL::numeric AS priceentered,
    NULL::numeric AS linenetamt,
    NULL::numeric AS m_attributesetinstance_id,
    NULL::numeric AS m_attributeset_id,
    NULL::character varying AS serno,
    NULL::character varying AS lot,
    NULL::numeric AS m_lot_id,
    NULL::timestamp without time zone AS guaranteedate,
    NULL::character varying AS productdescription,
    NULL::character varying AS imageurl,
    NULL::numeric AS c_campaign_id,
    NULL::numeric AS c_project_id,
    NULL::numeric AS c_activity_id,
    NULL::numeric AS c_projectphase_id,
    NULL::numeric AS c_projecttask_id,
    NULL::numeric AS c_invoiceline_ad_orgtrx_id,
    NULL::bpchar AS a_processed,
    NULL::numeric AS c_charge_id,
    NULL::numeric AS c_orderline_id,
    NULL::numeric AS c_uom_id,
    NULL::bpchar AS isdescription,
    NULL::bpchar AS c_invoiceline_isprinted,
    NULL::numeric AS m_inoutline_id,
    NULL::numeric AS m_rmaline_id,
    NULL::numeric AS pricelimit,
    NULL::bpchar AS c_invoiceline_processed,
    NULL::numeric AS ref_invoiceline_id,
    NULL::numeric AS rramt,
    NULL::timestamp without time zone AS rrstartdate,
    NULL::numeric AS s_resourceassignment_id,
    NULL::numeric AS c_invoiceline_user1_id,
    NULL::numeric AS c_invoiceline_user2_id,
    NULL::numeric AS c_uom_ad_org_id,
    NULL::numeric AS costingprecision,
    NULL::character varying AS c_uom_description,
    NULL::bpchar AS c_uom_isactive,
    NULL::bpchar AS c_uom_isdefault,
    NULL::character varying AS c_uom_name,
    NULL::numeric AS stdprecision,
    NULL::character varying AS uomtype,
    NULL::character varying AS x12de355,
    NULL::numeric AS c_invoice_ad_org_id,
    NULL::numeric AS c_invoice_ad_orgtrx_id,
    NULL::numeric AS c_invoice_ad_user_id,
    NULL::numeric AS c_invoice_c_activity_id,
    NULL::numeric AS c_invoice_c_bpartner_id,
    NULL::numeric AS c_bpartner_location_id,
    NULL::numeric AS c_invoice_c_campaign_id,
    NULL::numeric AS c_invoice_c_charge_id,
    NULL::numeric AS c_conversiontype_id,
    NULL::numeric AS c_currency_id,
    NULL::character varying AS cursymbol,
    NULL::numeric AS c_doctype_id,
    NULL::numeric AS c_doctypetarget_id,
    NULL::numeric AS c_dunninglevel_id,
    NULL::numeric AS c_invoice_chargeamt,
    NULL::numeric AS c_order_id,
    NULL::numeric AS c_payment_id,
    NULL::numeric AS c_paymentterm_id,
    NULL::numeric AS c_invoice_c_project_id,
    NULL::timestamp without time zone AS c_invoice_created,
    NULL::numeric AS c_invoice_createdby,
    NULL::timestamp without time zone AS dateacct,
    NULL::timestamp without time zone AS dateinvoiced,
    NULL::timestamp without time zone AS dateordered,
    NULL::timestamp without time zone AS dateprinted,
    NULL::character varying AS c_invoice_description,
    NULL::bpchar AS docaction,
    NULL::bpchar AS docstatus,
    NULL::character varying AS documentno,
    NULL::date AS dunninggrace,
    NULL::bpchar AS generateto,
    NULL::numeric AS grandtotal,
    NULL::bpchar AS invoicecollectiontype,
    NULL::bpchar AS c_invoice_isactive,
    NULL::bpchar AS isapproved,
    NULL::bpchar AS isdiscountprinted,
    NULL::bpchar AS isindispute,
    NULL::bpchar AS ispaid,
    NULL::bpchar AS ispayschedulevalid,
    NULL::bpchar AS c_invoice_isprinted,
    NULL::bpchar AS c_invoice_isselfservice,
    NULL::bpchar AS issotrx,
    NULL::bpchar AS c_invoice_istaxincluded,
    NULL::bpchar AS istransferred,
    NULL::numeric AS m_pricelist_id,
    NULL::numeric AS m_rma_id,
    NULL::bpchar AS paymentrule,
    NULL::character varying AS poreference,
    NULL::bpchar AS posted,
    NULL::numeric AS processedon,
    NULL::bpchar AS processing,
    NULL::numeric AS ref_invoice_id,
    NULL::numeric AS reversal_id,
    NULL::numeric AS salesrep_id,
    NULL::bpchar AS sendemail,
    NULL::numeric AS totallines,
    NULL::timestamp without time zone AS c_invoice_updated,
    NULL::numeric AS c_invoice_updatedby,
    NULL::numeric AS c_invoice_user1_id,
    NULL::numeric AS c_invoice_user2_id,
    NULL::numeric AS c_tax_ad_org_id,
    NULL::numeric AS ad_rule_id,
    NULL::numeric AS c_country_id,
    NULL::numeric AS c_region_id,
    NULL::numeric AS c_tax_c_taxcategory_id,
    NULL::character varying AS c_tax_description,
    NULL::bpchar AS c_tax_isactive,
    NULL::bpchar AS c_tax_isdefault,
    NULL::bpchar AS isdocumentlevel,
    NULL::bpchar AS issalestax,
    NULL::bpchar AS c_tax_issummary,
    NULL::bpchar AS istaxexempt,
    NULL::character varying AS c_tax_name,
    NULL::numeric AS parent_tax_id,
    NULL::numeric AS rate,
    NULL::bpchar AS requirestaxcertificate,
    NULL::bpchar AS sopotype,
    NULL::numeric AS to_country_id,
    NULL::numeric AS to_region_id,
    NULL::timestamp without time zone AS validfrom,
    NULL::numeric AS m_product_ad_org_id,
    NULL::character varying AS classification,
    NULL::bpchar AS m_product_copyfrom,
    NULL::timestamp without time zone AS m_product_created,
    NULL::numeric AS m_product_createdby,
    NULL::numeric AS c_revenuerecognition_id,
    NULL::numeric AS c_subscriptiontype_id,
    NULL::numeric AS m_product_c_taxcategory_id,
    NULL::character varying AS descriptionurl,
    NULL::bpchar AS discontinued,
    NULL::timestamp without time zone AS discontinuedat,
    NULL::character varying AS group1,
    NULL::character varying AS group2,
    NULL::numeric AS guaranteedays,
    NULL::numeric AS guaranteedaysmin,
    NULL::character varying AS help,
    NULL::bpchar AS m_product_isactive,
    NULL::bpchar AS isbom,
    NULL::bpchar AS isdropship,
    NULL::bpchar AS isexcludeautodelivery,
    NULL::bpchar AS isinvoiceprintdetails,
    NULL::bpchar AS ispicklistprintdetails,
    NULL::bpchar AS ispurchased,
    NULL::bpchar AS m_product_isselfservice,
    NULL::bpchar AS issold,
    NULL::bpchar AS isstocked,
    NULL::bpchar AS m_product_issummary,
    NULL::bpchar AS isverified,
    NULL::bpchar AS iswebstorefeatured,
    NULL::numeric AS lowlevel,
    NULL::numeric AS m_product_m_attributeset_id,
    NULL::numeric AS m_product_m_asi_id,
    NULL::numeric AS m_freightcategory_id,
    NULL::numeric AS m_locator_id,
    NULL::numeric AS m_product_m_prod_category_id,
    NULL::bpchar AS m_product_processing,
    NULL::bpchar AS producttype,
    NULL::numeric AS r_mailtext_id,
    NULL::numeric AS m_product_salesrep_id,
    NULL::numeric AS s_expensetype_id,
    NULL::numeric AS shelfdepth,
    NULL::numeric AS shelfheight,
    NULL::numeric AS shelfwidth,
    NULL::numeric AS m_product_s_resource_id,
    NULL::numeric AS unitsperpack,
    NULL::numeric AS unitsperpallet,
    NULL::timestamp without time zone AS m_product_updated,
    NULL::numeric AS m_product_updatedby,
    NULL::character varying AS versionno,
    NULL::numeric AS volume,
    NULL::numeric AS weight,
    NULL::numeric AS c_charge_ad_org_id,
    NULL::numeric AS c_charge_c_bpartner_id,
    NULL::numeric AS c_chargetype_id,
    NULL::numeric AS c_charge_chargeamt,
    NULL::numeric AS c_charge_c_taxcategory_id,
    NULL::character varying AS c_charge_description,
    NULL::bpchar AS c_charge_isactive,
    NULL::bpchar AS issamecurrency,
    NULL::bpchar AS issametax,
    NULL::bpchar AS c_charge_istaxincluded,
    NULL::numeric AS c_bp_product_ad_org_id,
    NULL::numeric AS c_bp_product_c_bpartner_id,
    NULL::timestamp without time zone AS c_bp_product_created,
    NULL::numeric AS c_bp_product_createdby,
    NULL::character varying AS c_bp_product_description,
    NULL::bpchar AS c_bp_product_isactive,
    NULL::bpchar AS ismanufacturer,
    NULL::character varying AS manufacturer,
    NULL::numeric AS qualityrating,
    NULL::numeric AS shelflifemindays,
    NULL::numeric AS shelflifeminpct,
    NULL::timestamp without time zone AS c_bp_product_updated,
    NULL::numeric AS c_bp_product_updatedby,
    NULL::character varying AS vendorcategory,
    NULL::numeric AS s_rassignment_ad_org_id,
    NULL::timestamp without time zone AS assigndatefrom,
    NULL::timestamp without time zone AS assigndateto,
    NULL::timestamp without time zone AS s_rassignment_created,
    NULL::numeric AS s_rassignment_createby,
    NULL::bpchar AS s_rassignment_isactive,
    NULL::bpchar AS isconfirmed,
    NULL::character varying AS s_rassignment_name,
    NULL::numeric AS s_rassignment_qty,
    NULL::numeric AS s_rassignment_s_resource_id,
    NULL::timestamp without time zone AS s_rassignment_updated,
    NULL::numeric AS s_rassignment_updatedby,
    NULL::numeric AS m_asi_ad_org_id,
    NULL::timestamp without time zone AS m_asi_created,
    NULL::numeric AS m_asi_createdby,
    NULL::character varying AS m_asi_description,
    NULL::bpchar AS m_asi_isactive,
    NULL::timestamp without time zone AS m_asi_updated,
    NULL::numeric AS m_asi_updatedby
   FROM c_invoiceline il,
    ad_language l
  WHERE ((il.c_uom_id IS NULL) AND (l.isbaselanguage = 'N'::bpchar) AND (l.issystemlanguage = 'Y'::bpchar))
UNION
 SELECT i.ad_client_id,
    i.ad_org_id,
    i.isactive,
    i.created,
    i.createdby,
    i.updated,
    i.updatedby,
    l.ad_language,
    i.c_invoice_id,
    NULL::numeric AS c_invoiceline_id,
    NULL::numeric AS c_tax_id,
    NULL::numeric AS taxamt,
    NULL::numeric AS linetotalamt,
    NULL::character varying AS taxindicator,
    999998 AS line,
    NULL::numeric AS m_product_id,
    NULL::numeric AS qtyinvoiced,
    NULL::numeric AS qtyentered,
    NULL::character varying AS uomsymbol,
    NULL::integer AS qtyprecision,
    NULL::character varying AS name,
    NULL::character varying AS description,
    NULL::character varying AS documentnote,
    NULL::character varying AS upc,
    NULL::character varying AS sku,
    NULL::character varying AS productvalue,
    NULL::character varying AS resourcedescription,
    NULL::numeric AS pricelist,
    NULL::numeric AS priceenteredlist,
    NULL::numeric AS discount,
    NULL::numeric AS priceactual,
    NULL::numeric AS priceentered,
    NULL::numeric AS linenetamt,
    NULL::numeric AS m_attributesetinstance_id,
    NULL::numeric AS m_attributeset_id,
    NULL::character varying AS serno,
    NULL::character varying AS lot,
    NULL::numeric AS m_lot_id,
    NULL::timestamp without time zone AS guaranteedate,
    NULL::character varying AS productdescription,
    NULL::character varying AS imageurl,
    NULL::numeric AS c_campaign_id,
    NULL::numeric AS c_project_id,
    NULL::numeric AS c_activity_id,
    NULL::numeric AS c_projectphase_id,
    NULL::numeric AS c_projecttask_id,
    NULL::numeric AS c_invoiceline_ad_orgtrx_id,
    NULL::bpchar AS a_processed,
    NULL::numeric AS c_charge_id,
    NULL::numeric AS c_orderline_id,
    NULL::numeric AS c_uom_id,
    NULL::bpchar AS isdescription,
    NULL::bpchar AS c_invoiceline_isprinted,
    NULL::numeric AS m_inoutline_id,
    NULL::numeric AS m_rmaline_id,
    NULL::numeric AS pricelimit,
    NULL::bpchar AS c_invoiceline_processed,
    NULL::numeric AS ref_invoiceline_id,
    NULL::numeric AS rramt,
    NULL::timestamp without time zone AS rrstartdate,
    NULL::numeric AS s_resourceassignment_id,
    NULL::numeric AS c_invoiceline_user1_id,
    NULL::numeric AS c_invoiceline_user2_id,
    NULL::numeric AS c_uom_ad_org_id,
    NULL::numeric AS costingprecision,
    NULL::character varying AS c_uom_description,
    NULL::bpchar AS c_uom_isactive,
    NULL::bpchar AS c_uom_isdefault,
    NULL::character varying AS c_uom_name,
    NULL::numeric AS stdprecision,
    NULL::character varying AS uomtype,
    NULL::character varying AS x12de355,
    NULL::numeric AS c_invoice_ad_org_id,
    NULL::numeric AS c_invoice_ad_orgtrx_id,
    NULL::numeric AS c_invoice_ad_user_id,
    NULL::numeric AS c_invoice_c_activity_id,
    NULL::numeric AS c_invoice_c_bpartner_id,
    NULL::numeric AS c_bpartner_location_id,
    NULL::numeric AS c_invoice_c_campaign_id,
    NULL::numeric AS c_invoice_c_charge_id,
    NULL::numeric AS c_conversiontype_id,
    NULL::numeric AS c_currency_id,
    NULL::character varying AS cursymbol,
    NULL::numeric AS c_doctype_id,
    NULL::numeric AS c_doctypetarget_id,
    NULL::numeric AS c_dunninglevel_id,
    NULL::numeric AS c_invoice_chargeamt,
    NULL::numeric AS c_order_id,
    NULL::numeric AS c_payment_id,
    NULL::numeric AS c_paymentterm_id,
    NULL::numeric AS c_invoice_c_project_id,
    NULL::timestamp without time zone AS c_invoice_created,
    NULL::numeric AS c_invoice_createdby,
    NULL::timestamp without time zone AS dateacct,
    NULL::timestamp without time zone AS dateinvoiced,
    NULL::timestamp without time zone AS dateordered,
    NULL::timestamp without time zone AS dateprinted,
    NULL::character varying AS c_invoice_description,
    NULL::bpchar AS docaction,
    NULL::bpchar AS docstatus,
    NULL::character varying AS documentno,
    NULL::date AS dunninggrace,
    NULL::bpchar AS generateto,
    NULL::numeric AS grandtotal,
    NULL::bpchar AS invoicecollectiontype,
    NULL::bpchar AS c_invoice_isactive,
    NULL::bpchar AS isapproved,
    NULL::bpchar AS isdiscountprinted,
    NULL::bpchar AS isindispute,
    NULL::bpchar AS ispaid,
    NULL::bpchar AS ispayschedulevalid,
    NULL::bpchar AS c_invoice_isprinted,
    NULL::bpchar AS c_invoice_isselfservice,
    NULL::bpchar AS issotrx,
    NULL::bpchar AS c_invoice_istaxincluded,
    NULL::bpchar AS istransferred,
    NULL::numeric AS m_pricelist_id,
    NULL::numeric AS m_rma_id,
    NULL::bpchar AS paymentrule,
    NULL::character varying AS poreference,
    NULL::bpchar AS posted,
    NULL::numeric AS processedon,
    NULL::bpchar AS processing,
    NULL::numeric AS ref_invoice_id,
    NULL::numeric AS reversal_id,
    NULL::numeric AS salesrep_id,
    NULL::bpchar AS sendemail,
    NULL::numeric AS totallines,
    NULL::timestamp without time zone AS c_invoice_updated,
    NULL::numeric AS c_invoice_updatedby,
    NULL::numeric AS c_invoice_user1_id,
    NULL::numeric AS c_invoice_user2_id,
    NULL::numeric AS c_tax_ad_org_id,
    NULL::numeric AS ad_rule_id,
    NULL::numeric AS c_country_id,
    NULL::numeric AS c_region_id,
    NULL::numeric AS c_tax_c_taxcategory_id,
    NULL::character varying AS c_tax_description,
    NULL::bpchar AS c_tax_isactive,
    NULL::bpchar AS c_tax_isdefault,
    NULL::bpchar AS isdocumentlevel,
    NULL::bpchar AS issalestax,
    NULL::bpchar AS c_tax_issummary,
    NULL::bpchar AS istaxexempt,
    NULL::character varying AS c_tax_name,
    NULL::numeric AS parent_tax_id,
    NULL::numeric AS rate,
    NULL::bpchar AS requirestaxcertificate,
    NULL::bpchar AS sopotype,
    NULL::numeric AS to_country_id,
    NULL::numeric AS to_region_id,
    NULL::timestamp without time zone AS validfrom,
    NULL::numeric AS m_product_ad_org_id,
    NULL::character varying AS classification,
    NULL::bpchar AS m_product_copyfrom,
    NULL::timestamp without time zone AS m_product_created,
    NULL::numeric AS m_product_createdby,
    NULL::numeric AS c_revenuerecognition_id,
    NULL::numeric AS c_subscriptiontype_id,
    NULL::numeric AS m_product_c_taxcategory_id,
    NULL::character varying AS descriptionurl,
    NULL::bpchar AS discontinued,
    NULL::timestamp without time zone AS discontinuedat,
    NULL::character varying AS group1,
    NULL::character varying AS group2,
    NULL::numeric AS guaranteedays,
    NULL::numeric AS guaranteedaysmin,
    NULL::character varying AS help,
    NULL::bpchar AS m_product_isactive,
    NULL::bpchar AS isbom,
    NULL::bpchar AS isdropship,
    NULL::bpchar AS isexcludeautodelivery,
    NULL::bpchar AS isinvoiceprintdetails,
    NULL::bpchar AS ispicklistprintdetails,
    NULL::bpchar AS ispurchased,
    NULL::bpchar AS m_product_isselfservice,
    NULL::bpchar AS issold,
    NULL::bpchar AS isstocked,
    NULL::bpchar AS m_product_issummary,
    NULL::bpchar AS isverified,
    NULL::bpchar AS iswebstorefeatured,
    NULL::numeric AS lowlevel,
    NULL::numeric AS m_product_m_attributeset_id,
    NULL::numeric AS m_product_m_asi_id,
    NULL::numeric AS m_freightcategory_id,
    NULL::numeric AS m_locator_id,
    NULL::numeric AS m_product_m_prod_category_id,
    NULL::bpchar AS m_product_processing,
    NULL::bpchar AS producttype,
    NULL::numeric AS r_mailtext_id,
    NULL::numeric AS m_product_salesrep_id,
    NULL::numeric AS s_expensetype_id,
    NULL::numeric AS shelfdepth,
    NULL::numeric AS shelfheight,
    NULL::numeric AS shelfwidth,
    NULL::numeric AS m_product_s_resource_id,
    NULL::numeric AS unitsperpack,
    NULL::numeric AS unitsperpallet,
    NULL::timestamp without time zone AS m_product_updated,
    NULL::numeric AS m_product_updatedby,
    NULL::character varying AS versionno,
    NULL::numeric AS volume,
    NULL::numeric AS weight,
    NULL::numeric AS c_charge_ad_org_id,
    NULL::numeric AS c_charge_c_bpartner_id,
    NULL::numeric AS c_chargetype_id,
    NULL::numeric AS c_charge_chargeamt,
    NULL::numeric AS c_charge_c_taxcategory_id,
    NULL::character varying AS c_charge_description,
    NULL::bpchar AS c_charge_isactive,
    NULL::bpchar AS issamecurrency,
    NULL::bpchar AS issametax,
    NULL::bpchar AS c_charge_istaxincluded,
    NULL::numeric AS c_bp_product_ad_org_id,
    NULL::numeric AS c_bp_product_c_bpartner_id,
    NULL::timestamp without time zone AS c_bp_product_created,
    NULL::numeric AS c_bp_product_createdby,
    NULL::character varying AS c_bp_product_description,
    NULL::bpchar AS c_bp_product_isactive,
    NULL::bpchar AS ismanufacturer,
    NULL::character varying AS manufacturer,
    NULL::numeric AS qualityrating,
    NULL::numeric AS shelflifemindays,
    NULL::numeric AS shelflifeminpct,
    NULL::timestamp without time zone AS c_bp_product_updated,
    NULL::numeric AS c_bp_product_updatedby,
    NULL::character varying AS vendorcategory,
    NULL::numeric AS s_rassignment_ad_org_id,
    NULL::timestamp without time zone AS assigndatefrom,
    NULL::timestamp without time zone AS assigndateto,
    NULL::timestamp without time zone AS s_rassignment_created,
    NULL::numeric AS s_rassignment_createby,
    NULL::bpchar AS s_rassignment_isactive,
    NULL::bpchar AS isconfirmed,
    NULL::character varying AS s_rassignment_name,
    NULL::numeric AS s_rassignment_qty,
    NULL::numeric AS s_rassignment_s_resource_id,
    NULL::timestamp without time zone AS s_rassignment_updated,
    NULL::numeric AS s_rassignment_updatedby,
    NULL::numeric AS m_asi_ad_org_id,
    NULL::timestamp without time zone AS m_asi_created,
    NULL::numeric AS m_asi_createdby,
    NULL::character varying AS m_asi_description,
    NULL::bpchar AS m_asi_isactive,
    NULL::timestamp without time zone AS m_asi_updated,
    NULL::numeric AS m_asi_updatedby
   FROM c_invoice i,
    ad_language l
  WHERE ((l.isbaselanguage = 'N'::bpchar) AND (l.issystemlanguage = 'Y'::bpchar))
UNION
 SELECT it.ad_client_id,
    it.ad_org_id,
    it.isactive,
    it.created,
    it.createdby,
    it.updated,
    it.updatedby,
    tt.ad_language,
    it.c_invoice_id,
    NULL::numeric AS c_invoiceline_id,
    it.c_tax_id,
    NULL::numeric AS taxamt,
    NULL::numeric AS linetotalamt,
    tt.taxindicator,
    999999 AS line,
    NULL::numeric AS m_product_id,
    NULL::numeric AS qtyinvoiced,
    NULL::numeric AS qtyentered,
    NULL::character varying AS uomsymbol,
    NULL::integer AS qtyprecision,
    tt.name,
    NULL::character varying AS description,
    NULL::character varying AS documentnote,
    NULL::character varying AS upc,
    NULL::character varying AS sku,
    NULL::character varying AS productvalue,
    NULL::character varying AS resourcedescription,
    NULL::numeric AS pricelist,
    NULL::numeric AS priceenteredlist,
    NULL::numeric AS discount,
        CASE
            WHEN (it.istaxincluded = 'Y'::bpchar) THEN it.taxamt
            ELSE it.taxbaseamt
        END AS priceactual,
        CASE
            WHEN (it.istaxincluded = 'Y'::bpchar) THEN it.taxamt
            ELSE it.taxbaseamt
        END AS priceentered,
        CASE
            WHEN (it.istaxincluded = 'Y'::bpchar) THEN NULL::numeric
            ELSE it.taxamt
        END AS linenetamt,
    NULL::numeric AS m_attributesetinstance_id,
    NULL::numeric AS m_attributeset_id,
    NULL::character varying AS serno,
    NULL::character varying AS lot,
    NULL::numeric AS m_lot_id,
    NULL::timestamp without time zone AS guaranteedate,
    NULL::character varying AS productdescription,
    NULL::character varying AS imageurl,
    NULL::numeric AS c_campaign_id,
    NULL::numeric AS c_project_id,
    NULL::numeric AS c_activity_id,
    NULL::numeric AS c_projectphase_id,
    NULL::numeric AS c_projecttask_id,
    NULL::numeric AS c_invoiceline_ad_orgtrx_id,
    NULL::bpchar AS a_processed,
    NULL::numeric AS c_charge_id,
    NULL::numeric AS c_orderline_id,
    NULL::numeric AS c_uom_id,
    NULL::bpchar AS isdescription,
    NULL::bpchar AS c_invoiceline_isprinted,
    NULL::numeric AS m_inoutline_id,
    NULL::numeric AS m_rmaline_id,
    NULL::numeric AS pricelimit,
    NULL::bpchar AS c_invoiceline_processed,
    NULL::numeric AS ref_invoiceline_id,
    NULL::numeric AS rramt,
    NULL::timestamp without time zone AS rrstartdate,
    NULL::numeric AS s_resourceassignment_id,
    NULL::numeric AS c_invoiceline_user1_id,
    NULL::numeric AS c_invoiceline_user2_id,
    NULL::numeric AS c_uom_ad_org_id,
    NULL::numeric AS costingprecision,
    NULL::character varying AS c_uom_description,
    NULL::bpchar AS c_uom_isactive,
    NULL::bpchar AS c_uom_isdefault,
    NULL::character varying AS c_uom_name,
    NULL::numeric AS stdprecision,
    NULL::character varying AS uomtype,
    NULL::character varying AS x12de355,
    NULL::numeric AS c_invoice_ad_org_id,
    NULL::numeric AS c_invoice_ad_orgtrx_id,
    NULL::numeric AS c_invoice_ad_user_id,
    NULL::numeric AS c_invoice_c_activity_id,
    NULL::numeric AS c_invoice_c_bpartner_id,
    NULL::numeric AS c_bpartner_location_id,
    NULL::numeric AS c_invoice_c_campaign_id,
    NULL::numeric AS c_invoice_c_charge_id,
    NULL::numeric AS c_conversiontype_id,
    NULL::numeric AS c_currency_id,
    NULL::character varying AS cursymbol,
    NULL::numeric AS c_doctype_id,
    NULL::numeric AS c_doctypetarget_id,
    NULL::numeric AS c_dunninglevel_id,
    NULL::numeric AS c_invoice_chargeamt,
    NULL::numeric AS c_order_id,
    NULL::numeric AS c_payment_id,
    NULL::numeric AS c_paymentterm_id,
    NULL::numeric AS c_invoice_c_project_id,
    NULL::timestamp without time zone AS c_invoice_created,
    NULL::numeric AS c_invoice_createdby,
    NULL::timestamp without time zone AS dateacct,
    NULL::timestamp without time zone AS dateinvoiced,
    NULL::timestamp without time zone AS dateordered,
    NULL::timestamp without time zone AS dateprinted,
    NULL::character varying AS c_invoice_description,
    NULL::bpchar AS docaction,
    NULL::bpchar AS docstatus,
    NULL::character varying AS documentno,
    NULL::date AS dunninggrace,
    NULL::bpchar AS generateto,
    NULL::numeric AS grandtotal,
    NULL::bpchar AS invoicecollectiontype,
    NULL::bpchar AS c_invoice_isactive,
    NULL::bpchar AS isapproved,
    NULL::bpchar AS isdiscountprinted,
    NULL::bpchar AS isindispute,
    NULL::bpchar AS ispaid,
    NULL::bpchar AS ispayschedulevalid,
    NULL::bpchar AS c_invoice_isprinted,
    NULL::bpchar AS c_invoice_isselfservice,
    NULL::bpchar AS issotrx,
    NULL::bpchar AS c_invoice_istaxincluded,
    NULL::bpchar AS istransferred,
    NULL::numeric AS m_pricelist_id,
    NULL::numeric AS m_rma_id,
    NULL::bpchar AS paymentrule,
    NULL::character varying AS poreference,
    NULL::bpchar AS posted,
    NULL::numeric AS processedon,
    NULL::bpchar AS processing,
    NULL::numeric AS ref_invoice_id,
    NULL::numeric AS reversal_id,
    NULL::numeric AS salesrep_id,
    NULL::bpchar AS sendemail,
    NULL::numeric AS totallines,
    NULL::timestamp without time zone AS c_invoice_updated,
    NULL::numeric AS c_invoice_updatedby,
    NULL::numeric AS c_invoice_user1_id,
    NULL::numeric AS c_invoice_user2_id,
    tt.ad_org_id AS c_tax_ad_org_id,
    t.ad_rule_id,
    t.c_country_id,
    t.c_region_id,
    t.c_taxcategory_id AS c_tax_c_taxcategory_id,
    tt.description AS c_tax_description,
    tt.isactive AS c_tax_isactive,
    t.isdefault AS c_tax_isdefault,
    t.isdocumentlevel,
    t.issalestax,
    t.issummary AS c_tax_issummary,
    t.istaxexempt,
    tt.name AS c_tax_name,
    t.parent_tax_id,
    t.rate,
    t.requirestaxcertificate,
    t.sopotype,
    t.to_country_id,
    t.to_region_id,
    t.validfrom,
    NULL::numeric AS m_product_ad_org_id,
    NULL::character varying AS classification,
    NULL::bpchar AS m_product_copyfrom,
    NULL::timestamp without time zone AS m_product_created,
    NULL::numeric AS m_product_createdby,
    NULL::numeric AS c_revenuerecognition_id,
    NULL::numeric AS c_subscriptiontype_id,
    NULL::numeric AS m_product_c_taxcategory_id,
    NULL::character varying AS descriptionurl,
    NULL::bpchar AS discontinued,
    NULL::timestamp without time zone AS discontinuedat,
    NULL::character varying AS group1,
    NULL::character varying AS group2,
    NULL::numeric AS guaranteedays,
    NULL::numeric AS guaranteedaysmin,
    NULL::character varying AS help,
    NULL::bpchar AS m_product_isactive,
    NULL::bpchar AS isbom,
    NULL::bpchar AS isdropship,
    NULL::bpchar AS isexcludeautodelivery,
    NULL::bpchar AS isinvoiceprintdetails,
    NULL::bpchar AS ispicklistprintdetails,
    NULL::bpchar AS ispurchased,
    NULL::bpchar AS m_product_isselfservice,
    NULL::bpchar AS issold,
    NULL::bpchar AS isstocked,
    NULL::bpchar AS m_product_issummary,
    NULL::bpchar AS isverified,
    NULL::bpchar AS iswebstorefeatured,
    NULL::numeric AS lowlevel,
    NULL::numeric AS m_product_m_attributeset_id,
    NULL::numeric AS m_product_m_asi_id,
    NULL::numeric AS m_freightcategory_id,
    NULL::numeric AS m_locator_id,
    NULL::numeric AS m_product_m_prod_category_id,
    NULL::bpchar AS m_product_processing,
    NULL::bpchar AS producttype,
    NULL::numeric AS r_mailtext_id,
    NULL::numeric AS m_product_salesrep_id,
    NULL::numeric AS s_expensetype_id,
    NULL::numeric AS shelfdepth,
    NULL::numeric AS shelfheight,
    NULL::numeric AS shelfwidth,
    NULL::numeric AS m_product_s_resource_id,
    NULL::numeric AS unitsperpack,
    NULL::numeric AS unitsperpallet,
    NULL::timestamp without time zone AS m_product_updated,
    NULL::numeric AS m_product_updatedby,
    NULL::character varying AS versionno,
    NULL::numeric AS volume,
    NULL::numeric AS weight,
    NULL::numeric AS c_charge_ad_org_id,
    NULL::numeric AS c_charge_c_bpartner_id,
    NULL::numeric AS c_chargetype_id,
    NULL::numeric AS c_charge_chargeamt,
    NULL::numeric AS c_charge_c_taxcategory_id,
    NULL::character varying AS c_charge_description,
    NULL::bpchar AS c_charge_isactive,
    NULL::bpchar AS issamecurrency,
    NULL::bpchar AS issametax,
    NULL::bpchar AS c_charge_istaxincluded,
    NULL::numeric AS c_bp_product_ad_org_id,
    NULL::numeric AS c_bp_product_c_bpartner_id,
    NULL::timestamp without time zone AS c_bp_product_created,
    NULL::numeric AS c_bp_product_createdby,
    NULL::character varying AS c_bp_product_description,
    NULL::bpchar AS c_bp_product_isactive,
    NULL::bpchar AS ismanufacturer,
    NULL::character varying AS manufacturer,
    NULL::numeric AS qualityrating,
    NULL::numeric AS shelflifemindays,
    NULL::numeric AS shelflifeminpct,
    NULL::timestamp without time zone AS c_bp_product_updated,
    NULL::numeric AS c_bp_product_updatedby,
    NULL::character varying AS vendorcategory,
    NULL::numeric AS s_rassignment_ad_org_id,
    NULL::timestamp without time zone AS assigndatefrom,
    NULL::timestamp without time zone AS assigndateto,
    NULL::timestamp without time zone AS s_rassignment_created,
    NULL::numeric AS s_rassignment_createby,
    NULL::bpchar AS s_rassignment_isactive,
    NULL::bpchar AS isconfirmed,
    NULL::character varying AS s_rassignment_name,
    NULL::numeric AS s_rassignment_qty,
    NULL::numeric AS s_rassignment_s_resource_id,
    NULL::timestamp without time zone AS s_rassignment_updated,
    NULL::numeric AS s_rassignment_updatedby,
    NULL::numeric AS m_asi_ad_org_id,
    NULL::timestamp without time zone AS m_asi_created,
    NULL::numeric AS m_asi_createdby,
    NULL::character varying AS m_asi_description,
    NULL::bpchar AS m_asi_isactive,
    NULL::timestamp without time zone AS m_asi_updated,
    NULL::numeric AS m_asi_updatedby
   FROM ((c_invoicetax it
     JOIN c_tax t ON ((it.c_tax_id = t.c_tax_id)))
     JOIN c_tax_trl tt ON ((it.c_tax_id = tt.c_tax_id)));
--
-- create function wmv_inout_line
--
CREATE OR REPLACE FUNCTION adempiere.wmv_inout_line(language character varying, inoutid integer)
 RETURNS SETOF wmv_inout_line_v
 LANGUAGE plpgsql
AS $function$
BEGIN
    language := COALESCE((SELECT l.ad_language FROM ad_language l WHERE l.ad_language = language AND l.isactive = 'Y' AND l.issystemlanguage = 'Y'), 'en_US');
    CASE language
    WHEN 'en_US' THEN
        RETURN query (SELECT * from wmv_inout_line_v where m_inout_id = inoutId);
    ELSE
        RETURN query (SELECT * FROM wmv_inout_line_vt WHERE ad_language = language and  m_inout_id = inoutId);
    END CASE;
END $function$
;
--
-- create function wmv_getghgaudit
--
CREATE OR REPLACE FUNCTION adempiere.wmv_getghgaudit(ghgcertid numeric, thedate date DEFAULT (now())::date)
 RETURNS character varying
 LANGUAGE plpgsql
AS $function$
    declare
        aRow wmv_ghgAudit%ROWTYPE;
    begin
        if ghgCertID = null then
            return null;
        else
            SELECT into aRow *
                FROM 
                wmv_ghgaudit a
                where
                a.wmv_ghgcertificate_id = ghgCertID
                AND a.ValidFrom::Date <= theDate 
                ORDER BY ValidFrom DESC LIMIT 1;
            if  theDate <= aRow.ValidTo then
                return aRow.name;
            else
                return null;
            end if; 
        end if;
    end; 
$function$
;
--
-- create function wmv_invoice_header
--
CREATE OR REPLACE FUNCTION adempiere.wmv_invoice_header(language character varying, invoiceid integer)
 RETURNS SETOF wmv_invoice_header_v
 LANGUAGE plpgsql
AS $function$
BEGIN
    language := COALESCE((SELECT l.ad_language FROM ad_language l WHERE l.ad_language = language AND l.isactive = 'Y' AND l.issystemlanguage = 'Y'), 'en_US');
    CASE language
    WHEN 'en_US' THEN
        RETURN query (SELECT * from wmv_invoice_header_v where c_invoice_id = invoiceId);
    ELSE
        RETURN query (SELECT * FROM wmv_invoice_header_vt WHERE ad_language = language and  c_invoice_id = invoiceId);
    END CASE;
END $function$
;
--
-- create function wmv_order_linetax
--
CREATE OR REPLACE FUNCTION adempiere.wmv_order_linetax(language character varying, orderid integer)
 RETURNS SETOF wmv_order_linetax_v
 LANGUAGE plpgsql
AS $function$
BEGIN
    language := COALESCE((SELECT l.ad_language FROM ad_language l WHERE l.ad_language = language AND l.isactive = 'Y' AND l.issystemlanguage = 'Y'), 'en_US');
    CASE language
    WHEN 'en_US' THEN
        RETURN query (SELECT * from wmv_order_linetax_v where c_order_id = orderId);
    ELSE
        RETURN query (SELECT * FROM wmv_order_linetax_vt WHERE ad_language = language and  c_order_id = orderId);
    END CASE;
END $function$
;
--
-- create function wmv_invoice_linetax
--
CREATE OR REPLACE FUNCTION adempiere.wmv_invoice_linetax(language character varying, invoiceid integer)
 RETURNS SETOF wmv_invoice_linetax_v
 LANGUAGE plpgsql
AS $function$
BEGIN
    language := COALESCE((SELECT l.ad_language FROM ad_language l WHERE l.ad_language = language AND l.isactive = 'Y' AND l.issystemlanguage = 'Y'), 'en_US');
    CASE language
    WHEN 'en_US' THEN
        RETURN query (SELECT * from wmv_invoice_linetax_v where c_invoice_id = invoiceId);
    ELSE
        RETURN query (SELECT * FROM wmv_invoice_linetax_vt WHERE ad_language = language and  c_invoice_id = invoiceId);
    END CASE;
END $function$
;
--
-- create function wmv_inout_header
--
CREATE OR REPLACE FUNCTION adempiere.wmv_inout_header(language character varying, inoutid integer)
 RETURNS SETOF wmv_inout_header_v
 LANGUAGE plpgsql
AS $function$
BEGIN
    language := COALESCE((SELECT l.ad_language FROM ad_language l WHERE l.ad_language = language AND l.isactive = 'Y' AND l.issystemlanguage = 'Y'), 'en_US');
    CASE language
    WHEN 'en_US' THEN
        RETURN query (SELECT * from wmv_inout_header_v where m_inout_id = inoutId);
    ELSE
        RETURN query (SELECT * FROM wmv_inout_header_vt WHERE ad_language = language and  m_inout_id = inoutId);
    END CASE;
END $function$
;
--
-- create function wmv_getghgauditid_2
--
CREATE OR REPLACE FUNCTION adempiere.wmv_getghgauditid_2(ghgcertid numeric, thedate date DEFAULT (now())::date)
 RETURNS numeric
 LANGUAGE plpgsql
AS $function$
    begin
        return wmv_ghgaudit_id from wmv_getghgauditrow(ghgcertid, thedate);
    end; 
$function$
;
--
-- create function wmv_categoryisghgcertified
--
CREATE OR REPLACE FUNCTION adempiere.wmv_categoryisghgcertified(productid numeric)
 RETURNS character
 LANGUAGE plpgsql
AS $function$
    declare 
        cName character varying;
    BEGIN
        select c.name into cName 
            from M_Product p 
            join M_Product_Category c on c.m_product_category_id = p.m_product_category_id
            WHERE p.M_Product_ID = productID;
        if cName = 'GHG Certified'then 
            return 'Y';
        else
            return 'N';
        end if;
    END;
$function$
;
--
-- create function wmv_uomconvert
--
CREATE OR REPLACE FUNCTION adempiere.wmv_uomconvert(symbol character varying, symbol_to character varying, productid numeric)
 RETURNS numeric
 LANGUAGE plpgsql
AS $function$
    begin
        if symbol = symbol_to then
            return 1;
        else
            return  (select a.multiplyrate
                FROM 
                (select uoc.multiplyrate, uoc.m_product_id 
                from c_uom_conversion uoc
                join c_uom f on f.c_uom_id = uoc.c_uom_id 
                join c_uom t on t.c_uom_id = uoc.c_uom_to_id 
                where
                f.uomsymbol = symbol 
                and t.uomsymbol = symbol_to
                and (uoc.m_product_id = null or uoc.m_product_id  = productid) 
                ORDER BY uoc.m_product_id LIMIT 1) a);
        end if;
    end; 
$function$
;
--
-- create function wmv_getghgauditrow
--
CREATE OR REPLACE FUNCTION adempiere.wmv_getghgauditrow(ghgcertid numeric, thedate date DEFAULT (now())::date)
 RETURNS SETOF wmv_auditresult
 LANGUAGE plpgsql
AS $function$
    declare
        aRow wmv_auditresult;
    begin
        if ghgCertID = null then
            return query select null::numeric(10,0), 
                null::numeric(10), 
                null::varchar(60), 
                null::timestamp, 
                null::timestamp, 
                null::varchar(60);
        else
            SELECT into aRow a.wmv_ghgaudit_id, a.wmv_ghgcertificate_id, a.wmv_ghgauditnumber, a.validfrom, a.validto, a."name"
                FROM 
                wmv_ghgaudit a
                where
                a.wmv_ghgcertificate_id = ghgCertID
                and a.isactive = 'Y'
                AND a.ValidFrom::Date <= theDate 
                ORDER BY ValidFrom DESC LIMIT 1;
            if  theDate <= aRow.ValidTo then
                return query select
                    aRow.wmv_ghgaudit_id,
                    aRow.wmv_ghgcertificate_id,
                    aRow.wmv_ghgauditnumber,
                    aRow.validfrom,
                    aRow.validto,
                    aRow."name";
            else
                return query select null::numeric(10,0), 
                null::numeric(10), 
                null::varchar(60), 
                null::timestamp, 
                null::timestamp, 
                null::varchar(60);
            end if; 
        end if;
    end; 
$function$
;
--
-- create function wmv_order_header
--
CREATE OR REPLACE FUNCTION adempiere.wmv_order_header(language character varying, orderid integer)
 RETURNS SETOF wmv_order_header_v
 LANGUAGE plpgsql
AS $function$
BEGIN
    language := COALESCE((SELECT l.ad_language FROM ad_language l WHERE l.ad_language = language AND l.isactive = 'Y' AND l.issystemlanguage = 'Y'), 'en_US');
    CASE language
    WHEN 'en_US' THEN
        RETURN query (SELECT * from wmv_order_header_v where c_order_id = orderid);
    ELSE
        RETURN query (SELECT * FROM wmv_order_header_vt WHERE ad_language = language and  c_order_id = orderId);
    END CASE;
END $function$
;
--
-- create function wmv_getghgauditid
--
CREATE OR REPLACE FUNCTION adempiere.wmv_getghgauditid(ghgcertid numeric, thedate date DEFAULT (now())::date)
 RETURNS numeric
 LANGUAGE plpgsql
AS $function$
    declare
        aRow wmv_ghgAudit%ROWTYPE;
    begin
        if ghgCertID = null then
            return null;
        else
            SELECT into aRow *
                FROM 
                wmv_ghgaudit a
                where
                a.wmv_ghgcertificate_id = ghgCertID
                AND a.ValidFrom::Date <= theDate 
                ORDER BY ValidFrom DESC LIMIT 1;
            if  theDate <= aRow.ValidTo then
                return aRow.wmv_ghgAudit_id;
            else
                return null;
            end if; 
        end if;
    end; 
$function$
;